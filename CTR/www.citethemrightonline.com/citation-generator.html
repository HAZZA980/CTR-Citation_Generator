<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harvard Citation Generator</title>

    <style>
        /* Sleek CTR-style Citation Generator (namespace ctrGen-) */

        .ctrGen-container {
            max-width: 800px;
            margin: 40px auto;
            padding: 30px;
            border: 1px solid #e0e0e0;
            border-top: 5px solid #20366F;
            background: #fff;
            border-radius: 12px;
            font-family: 'avenir-regular-class', Arial, sans-serif;
            box-shadow: 0 4px 12px rgba(0,0,0,0.06);
            transition: box-shadow 0.2s ease;
        }

        .ctrGen-container:hover {
            box-shadow: 0 6px 18px rgba(0,0,0,0.08);
        }

        .ctrGen-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 25px;
            color: #20366F;
            text-align: center;
        }

        .ctrGen-container label {
            display: block;
            margin: 15px 0 6px;
            font-size: 15px;
            font-weight: 600;
            color: #333333;
        }

        .ctrGen-input,
        .ctrGen-search {
            width: 100%;
            height: 44px;
            padding: 0 20px;
            border-radius: 25px;
            border: 1px solid #ccc;
            font-size: 15px;
            color: #333333;
            margin-bottom: 18px;
            background: #fafafa;
            transition: all 0.2s ease;
        }

        .ctrGen-input:focus,
        .ctrGen-search:focus {
            outline: none;
            border-color: #20366F;
            background: #fff;
            box-shadow: 0 0 0 3px rgba(32,54,111,0.15);
        }

        .ctrGen-btn {
            display: inline-block;
            padding: 10px 30px;
            margin: 12px 10px 0 0;
            border-radius: 25px;
            font-size: 15px;
            font-weight: bold;
            cursor: pointer;
            background: #20366F;
            border: 1px solid #20366F;
            color: #fff !important;
            transition: all 0.2s ease;
        }

        .ctrGen-btn:hover {
            background: #182853;
            border-color: #182853;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        }

        .ctrGen-btn-copy {
            background: #2d7a2d;
            border-color: #2d7a2d;
        }

        .ctrGen-btn-copy:hover {
            background: #226022;
            border-color: #226022;
        }

        .ctrGen-result {
            margin-top: 25px;
            padding: 18px 20px;
            background: #f9fafc;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            font-size: 15px;
            line-height: 1.6;
            color: #333333;
            font-style: italic;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.03);
        }

        .ctrGen-dropdown {
            list-style: none;
            margin: -10px 0 18px;
            padding: 0;
            border: 1px solid #ddd;
            border-radius: 12px;
            background: #fff;
            position: absolute;
            width: 100%;
            max-height: 220px;
            overflow-y: auto;
            z-index: 9999;
            display: none;
            box-shadow: 0px 6px 12px rgba(0,0,0,0.1);
        }

        .ctrGen-dropdown li {
            padding: 12px 20px;
            font-size: 14px;
            cursor: pointer;
            transition: background 0.2s ease, padding-left 0.2s ease;
        }

        .ctrGen-dropdown li:hover {
            background: #f0f4fa;
            padding-left: 25px;
            color: #20366F;
        }

    </style>

    <link href="bloomsbury_assets/bloomsbury/css/support.css" rel="stylesheet" type="text/css">
    <link href="bloomsbury_assets/bloomsbury/css/bootstrap-select.css" rel="stylesheet" type="text/css">
    <link href="bloomsbury_assets/bloomsbury/css/owl-carousel-new.css" rel="stylesheet" type="text/css">
    <link href="bloomsbury_assets/bloomsbury/css/checkbox.css" rel="stylesheet" type="text/css">
    <link href="bloomsbury_assets/bloomsbury/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="bloomsbury_assets/ctrcol/css/plyr.css" rel="stylesheet" type="text/css">
    <link href="bloomsbury_assets/bloomsbury/css/bootstrap-slider.css" rel="stylesheet" type="text/css">
    <link href="bloomsbury_assets/bloomsbury/css/support-ui.css" rel="stylesheet" type="text/css">


    <link href="bloomsbury_assets/ctrcol/css/ctrcol.css" rel="stylesheet" type="text/css">
    <link href="bloomsbury_assets/ctrcol/css/product.css" rel="stylesheet" type="text/css">


    <!--<link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
   integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
   crossorigin=""/>-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" crossorigin="">


    <!-- JS -->
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/jquery.min.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/custom.min.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/owl-carousel-new.min.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/custom-select.min.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/plyr.js"></script>


    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/bootstrap-slider.min.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/mousescroll.min.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/jquery-show-first.min.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/clipboard.min.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/jquery.mark.min.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/jquery.cloudinary.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/bloomsbury.min0f12.js?v=80013"></script>
    <script src='https://www.recaptcha.net/recaptcha/api.js'></script>
    <!--<script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"
   integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log=="
   crossorigin=""></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js" crossorigin=""></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/leaflet.ChineseTmsProviders.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/jquery.cookie.min.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/jquery.truncation.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/openseadragon.min.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/openseadragon-svg-overlay.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/snap.svg-min.js"></script>

    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/jquery.numeric.min.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/raphael.min.js"></script>
    <script type="text/javascript" src="bloomsbury_assets/bloomsbury/js/URI.min.js"></script>
    <!-- <script src="https://ssl.geoplugin.net/json.gp?k=a79c8a904f5edab4&jsoncallback=getGeolocationData"></script> -->
    <script>
        $.ajax({
            type: "GET",
            url: '/app/getmylocat',
            success: function (response) {
                getGeolocationData(response);
            },
            error: function (error) {
                console.log(error);
            }
        });
    </script>


    <!-- OneTrust Cookies Consent Notice start for citethemrightonline.com -->
    <script src="https://cdn-ukwest.onetrust.com/scripttemplates/otSDKStub.js" type="text/javascript" charset="UTF-8"
            data-domain-script="6fcffa6f-7d16-46be-ac3d-c9c48b600699"></script>
    <script type="text/javascript">
        function OptanonWrapper() {
        }
    </script>
</head>
<body>


<div class="main-container">
    <header class="bs-docs-nav navbar header-layout header-temp1">
        <div class="temporary-banner">
            <div><b>As of July 31st: All referencing styles have been updated to reflect the latest guidance from the
                13th edition of the book.</b></div>
        </div>
        <div class="top-header">
            <div class="container">
                <div class="hidden-xs">
                    <div class="pull-left mt10">
                        <div class="social-icons">
                            <ul role="menu"></ul>
                        </div>
                    </div>
                </div>            <!-- social Icons for mobile devices starts-->
                <div class="visible-xs">
                    <div class="pull-left">
                        <div class="social-icons">
                            <ul role="menu"></ul>
                        </div>
                    </div>
                </div>            <!-- social Icons for mobile devices ends-->
                <div class="pull-right user-details">

                    <div class="header-dropdown dropdown inline-disp " id="checkForLogout">
                        <a href="https://www.citethemrightonline.com/login?recentUrl=/" title="Login">
                            <img src="bloomsbury_assets/bloomsbury/images/signin_icon.png" alt="" title="">
                            <span tabindex="0" aria-label="Log In">Log In</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="btm-header">
            <div class="container">
                <div class="navbar-header">
                    <button aria-controls="bs-navbar" aria-expanded="false" class="collapsed navbar-toggle"
                            data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span>
                    </button>
                    <span class="navbar-brand zero-leftpad single-logo">						<a href="home.html"><img
                            src="https://res.cloudinary.com/bloomsbury-publishing-public/image/upload/f_auto%2Cq_auto/CTRCOL/citethemrightlogo.png"
                            class="img-responsive" alt="Cite Them Right Logo" title="Cite Them Right Logo"></a>					</span>
                    <span class="navbar-brand single-logo">											</span>
                    <div class="hidden-md hidden-lg mob-search-icon"><a href="javascript:;"><img
                            src="bloomsbury_assets/bloomsbury/images/search-icon-gray.png"
                            class="img-responsive mob-search" aria-label="Search Button" tabindex="0"/></a></div>
                </div>
                <nav class="collapse navbar-collapse" id="bs-navbar"><span
                        class="bpm-menu-close hidden-lg hidden-md">X</span>
                    <ul role="navigation" aria-label="Main" class="nav navbar-nav">
                        <li class="active" role="listitem"><a tabindex="0" aria-label="Home" href="home.html">Home</a>
                        </li>
                        <li class="dropdown " role="listitem"><a tabindex="0" href="#" data-toggle="dropdown"
                                                                 class="dropdown-toggle"
                                                                 aria-label="Choose Referencing Style"
                                                                 aria-expanded="false">Choose Referencing Style</a>
                            <ul class="dropdown-menu" role="list" aria-label="Choose Referencing Style">
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-list7f5c.html?docid=CTRHarvard"
                                                           title="Harvard" aria-label="Harvard">Harvard</a></li>
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-list185c.html?docid=CTRAPA7th" title="APA 7th"
                                                           aria-label="APA 7th">APA 7th</a></li>
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-list2f86.html?docid=ctrchicago18"
                                                           title="Chicago 18th" aria-label="Chicago 18th">Chicago
                                    18th</a></li>
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-listde1e.html?docid=CTRChicago"
                                                           title="Chicago 17th" aria-label="Chicago 17th">Chicago
                                    17th</a></li>
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-list5651.html?docid=CTRIEEE" title="IEEE"
                                                           aria-label="IEEE">IEEE</a></li>
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-listf23c.html?docid=CTRMHRA4th"
                                                           title="MHRA 4th" aria-label="MHRA 4th">MHRA 4th</a></li>
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-list812a.html?docid=CTRMHRA" title="MHRA 3rd"
                                                           aria-label="MHRA 3rd">MHRA 3rd</a></li>
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-liste56d.html?docid=CTRMLA9th" title="MLA 9th"
                                                           aria-label="MLA 9th">MLA 9th</a></li>
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-list0d72.html?docid=CTROSCOLA" title="OSCOLA"
                                                           aria-label="OSCOLA">OSCOLA</a></li>
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-list48aa.html?docid=CTRVancouver"
                                                           title="Vancouver" aria-label="Vancouver">Vancouver</a></li>
                            </ul>
                        </li>
                        <li class="dropdown " role="listitem"><a tabindex="0" href="#" data-toggle="dropdown"
                                                                 class="dropdown-toggle" aria-label="Browse Categories"
                                                                 aria-expanded="false">Browse Categories</a>
                            <ul class="dropdown-menu" role="list" aria-label="Browse Categories">
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-listdc16.html?docid=CTRBooks" title="Books"
                                                           aria-label="Books">Books</a></li>
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-list70fb.html?docid=CTRJournals"
                                                           title="Journals" aria-label="Journals">Journals</a></li>
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-listade9.html?docid=CTRDigitalInternet"
                                                           title="Digital & Internet" aria-label="Digital & Internet">Digital
                                    & Internet</a></li>
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-list5041.html?docid=CTRMediaArt"
                                                           title="Media & Art" aria-label="Media & Art">Media & Art</a>
                                </li>
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-listbc36.html?docid=CTRResearch"
                                                           title="Research" aria-label="Research">Research</a></li>
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-listba6a.html?docid=CTRLegal" title="Legal"
                                                           aria-label="Legal">Legal</a></li>
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-list9f68.html?docid=CTRGovernmental"
                                                           title="Governmental"
                                                           aria-label="Governmental">Governmental</a></li>
                                <li role="presentation"><a role="listitem" tabindex="0"
                                                           href="category-listff06.html?docid=CTRCommunications"
                                                           title="Communications" aria-label="Communications">Communications</a>
                                </li>
                            </ul>
                        </li>
                        <li class="" role="listitem"><a tabindex="0" aria-label="Basics of Referencing"
                                                        href="basics-of-referencing.html">Basics of Referencing</a></li>
                        <li class="" role="listitem"><a tabindex="0" aria-label="Tutorial"
                                                        href="tutorial.html">Tutorial</a></li>
                        <li class="" role="listitem"><a tabindex="0" aria-label="Videos" href="videos.html">Videos</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="clearfix"></div>
    </header>
</div>


<div class="ctrGen-container">
    <h1 class="ctrGen-title">Harvard Citation Generator</h1>

    <label for="ctrGen-sourceSearch">Source Type</label>
    <input type="text" id="ctrGen-sourceSearch" placeholder="Start typing e.g. book, film, podcast...">
    <ul id="ctrGen-suggestions" class="ctrGen-dropdown"></ul>

    <div id="ctrGen-fields"></div>

    <button class="ctrGen-btn" onclick="generateCitation()">Generate Citation</button>
    <button id="ctrGen-copyBtn" class="ctrGen-btn ctrGen-btn-copy" onclick="copyCitation()">Copy to Clipboard</button>

    <div class="ctrGen-result" id="ctrGen-citationOutput"></div>
</div>


<script>
    const fieldsContainer = document.getElementById("ctrGen-fields");
    const citationOutput = document.getElementById("ctrGen-citationOutput");
    const copyBtn = document.getElementById("ctrGen-copyBtn");

    const sourceSearch = document.getElementById("ctrGen-sourceSearch");
    const suggestions = document.getElementById("ctrGen-suggestions");


    const fieldConfigs = {
        book: [
            { name: "author", label: "Author(s)" },
            { name: "year", label: "Year" },
            { name: "title", label: "Book Title" },
            { name: "place", label: "Place of publication" },
            { name: "publisher", label: "Publisher" }
        ],
        ebook: [
            { name: "author", label: "Author(s)" },
            { name: "year", label: "Year" },
            { name: "title", label: "E-Book Title" },
            { name: "platform", label: "Platform / Database" },
            { name: "url", label: "URL" }
        ],
        journal: [
            { name: "author", label: "Author(s)" },
            { name: "year", label: "Year" },
            { name: "title", label: "Article Title" },
            { name: "journal", label: "Journal Title" },
            { name: "volume", label: "Volume" },
            { name: "issue", label: "Issue" },
            { name: "pages", label: "Page range" }
        ],
        website: [
            { name: "author", label: "Author/Organisation" },
            { name: "year", label: "Year" },
            { name: "title", label: "Webpage Title" },
            { name: "site", label: "Website Name" },
            { name: "url", label: "URL" },
            { name: "date", label: "Date accessed" }
        ],
        podcast: [
            { name: "host", label: "Host(s)" },
            { name: "year", label: "Year" },
            { name: "title", label: "Podcast Title" },
            { name: "episode", label: "Episode Title" },
            { name: "platform", label: "Platform" }
        ],
        film: [
            { name: "title", label: "Film Title" },
            { name: "year", label: "Year" },
            { name: "director", label: "Director" },
            { name: "country", label: "Country" },
            { name: "studio", label: "Production Company" }
        ],
        thesis: [
            { name: "author", label: "Author" },
            { name: "year", label: "Year" },
            { name: "title", label: "Thesis Title" },
            { name: "degree", label: "Degree" },
            { name: "institution", label: "Institution" }
        ],
        socialmedia: [
            { name: "author", label: "Author/Username" },
            { name: "year", label: "Year" },
            { name: "handle", label: "Handle (@username)" },
            { name: "content", label: "Post Content" },
            { name: "platform", label: "Platform" },
            { name: "url", label: "URL" },
            { name: "date", label: "Date accessed" }
        ],
        legislation: [
            { name: "title", label: "Title of Act/Legislation" },
            { name: "year", label: "Year" },
            { name: "chapter", label: "Chapter" },
            { name: "country", label: "Country" }
        ],
        report: [
            { name: "author", label: "Author/Organisation" },
            { name: "year", label: "Year" },
            { name: "title", label: "Report Title" },
            { name: "publisher", label: "Publisher" },
            { name: "url", label: "URL (if online)" }
        ],
        artwork: [
            { name: "artist", label: "Artist" },
            { name: "year", label: "Year" },
            { name: "title", label: "Artwork Title" },
            { name: "medium", label: "Medium" },
            { name: "location", label: "Location / Museum" }
        ],
        chapter: [
            { name: "author", label: "Chapter Author(s)" },
            { name: "year", label: "Year" },
            { name: "chapter", label: "Chapter Title" },
            { name: "editor", label: "Editor(s)" },
            { name: "booktitle", label: "Book Title" },
            { name: "place", label: "Place of publication" },
            { name: "publisher", label: "Publisher" },
            { name: "pages", label: "Page range" }
        ],
        conference: [
            { name: "author", label: "Author(s)" },
            { name: "year", label: "Year" },
            { name: "title", label: "Paper Title" },
            { name: "conference", label: "Conference Name" },
            { name: "place", label: "Place" },
            { name: "pages", label: "Page range" }
        ],
        newspaper: [
            { name: "author", label: "Author(s)" },
            { name: "year", label: "Year" },
            { name: "title", label: "Article Title" },
            { name: "paper", label: "Newspaper Title" },
            { name: "date", label: "Date" },
            { name: "pages", label: "Page number(s)" }
        ],
        youtube: [
            { name: "author", label: "Author/Channel" },
            { name: "year", label: "Year" },
            { name: "title", label: "Video Title" },
            { name: "url", label: "URL" },
            { name: "date", label: "Date accessed" }
        ],
        govdoc: [
            { name: "author", label: "Government Department/Organisation" },
            { name: "year", label: "Year" },
            { name: "title", label: "Document Title" },
            { name: "place", label: "Place" },
            { name: "publisher", label: "Publisher" }
        ],
        tv: [
            { name: "title", label: "Programme Title" },
            { name: "year", label: "Year" },
            { name: "channel", label: "Channel/Station" },
            { name: "date", label: "Date of broadcast" }
        ],
        radio: [
            { name: "title", label: "Programme Title" },
            { name: "year", label: "Year" },
            { name: "station", label: "Radio Station" },
            { name: "date", label: "Date of broadcast" }
        ],
        music: [
            { name: "composer", label: "Composer" },
            { name: "year", label: "Year" },
            { name: "title", label: "Score/Performance Title" },
            { name: "performer", label: "Performer(s)" },
            { name: "publisher", label: "Publisher/Label" }
        ],
        map: [
            { name: "author", label: "Cartographer/Organisation" },
            { name: "year", label: "Year" },
            { name: "title", label: "Map Title" },
            { name: "scale", label: "Scale" },
            { name: "place", label: "Place of publication" },
            { name: "publisher", label: "Publisher" }
        ],
        archive: [
            { name: "author", label: "Author/Organisation" },
            { name: "year", label: "Year" },
            { name: "title", label: "Document Title" },
            { name: "collection", label: "Collection" },
            { name: "archive", label: "Archive/Repository" }
        ],
        email: [
            { name: "author", label: "Sender" },
            { name: "year", label: "Year" },
            { name: "subject", label: "Email Subject" },
            { name: "recipient", label: "Recipient" },
            { name: "date", label: "Date" }
        ],
        lecture: [
            { name: "author", label: "Lecturer" },
            { name: "year", label: "Year" },
            { name: "title", label: "Lecture Title" },
            { name: "module", label: "Module/Course" },
            { name: "institution", label: "Institution" },
            { name: "date", label: "Date" }
        ],
        dataset: [
            { name: "author", label: "Author/Organisation" },
            { name: "year", label: "Year" },
            { name: "title", label: "Dataset Title" },
            { name: "publisher", label: "Publisher/Repository" },
            { name: "doi", label: "DOI or URL" }
        ],
        patent: [
            { name: "inventor", label: "Inventor(s)" },
            { name: "year", label: "Year" },
            { name: "title", label: "Patent Title" },
            { name: "country", label: "Country" },
            { name: "number", label: "Patent Number" }
        ],
        caselaw: [
            { name: "case", label: "Case Name" },
            { name: "year", label: "Year" },
            { name: "report", label: "Law Report Abbreviation" },
            { name: "volume", label: "Volume" },
            { name: "page", label: "Page" }
        ],
        treaty: [
            { name: "title", label: "Treaty Title" },
            { name: "year", label: "Year" },
            { name: "parties", label: "Parties/Countries" },
            { name: "source", label: "Official Source/Publication" }
        ],
        standard: [
            { name: "organisation", label: "Organisation (e.g. ISO, BSI)" },
            { name: "year", label: "Year" },
            { name: "number", label: "Standard Number" },
            { name: "title", label: "Standard Title" }
        ],
        blog: [
            { name: "author", label: "Author" },
            { name: "year", label: "Year" },
            { name: "title", label: "Blog Post Title" },
            { name: "blog", label: "Blog Name" },
            { name: "url", label: "URL" },
            { name: "date", label: "Date accessed" }
        ],
        podcastguest: [
            { name: "host", label: "Host(s)" },
            { name: "guest", label: "Guest(s)" },
            { name: "year", label: "Year" },
            { name: "title", label: "Podcast Title" },
            { name: "episode", label: "Episode Title" },
            { name: "platform", label: "Platform" }
        ],
        dissertation: [
            { name: "author", label: "Author" },
            { name: "year", label: "Year" },
            { name: "title", label: "Dissertation Title" },
            { name: "institution", label: "Institution" },
            { name: "level", label: "Level (e.g. Undergraduate, Masters)" }
        ],
        encyclopaedia: [
            { name: "author", label: "Author (if available)" },
            { name: "year", label: "Year" },
            { name: "entry", label: "Entry Title" },
            { name: "encyclopaedia", label: "Encyclopaedia Title" },
            { name: "edition", label: "Edition" },
            { name: "publisher", label: "Publisher" },
            { name: "url", label: "URL (if online)" },
            { name: "date", label: "Accessed Date (if online)" }
        ],
        twitter: [
            { name: "author", label: "Author/Handle" },
            { name: "year", label: "Year" },
            { name: "content", label: "Tweet Content" },
            { name: "url", label: "Tweet URL" },
            { name: "date", label: "Date accessed" }
        ],
        tiktok: [
            { name: "author", label: "Author/Handle" },
            { name: "year", label: "Year" },
            { name: "title", label: "Video Title/Description" },
            { name: "url", label: "Video URL" },
            { name: "date", label: "Date accessed" }
        ],
        instagram: [
            { name: "author", label: "Author/Handle" },
            { name: "year", label: "Year" },
            { name: "content", label: "Post Caption" },
            { name: "url", label: "Post URL" },
            { name: "date", label: "Date accessed" }
        ],
        secondary: [
            { name: "originalAuthor", label: "Original Author" },
            { name: "yearOriginal", label: "Original Year" },
            { name: "citingAuthor", label: "Citing Author" },
            { name: "yearCiting", label: "Citing Year" },
            { name: "title", label: "Citing Source Title" },
            { name: "publisher", label: "Publisher/Source Details" }
        ],

        labmanual: [
            { name: "institution", label: "Institution/Department" },
            { name: "year", label: "Year" },
            { name: "title", label: "Lab Manual Title" },
            { name: "course", label: "Course/Module" }
        ],
        datasetdoi: [
            { name: "author", label: "Author/Organisation" },
            { name: "year", label: "Year" },
            { name: "title", label: "Dataset Title" },
            { name: "doi", label: "DOI" }
        ],
        software: [
            { name: "author", label: "Author/Company" },
            { name: "year", label: "Year" },
            { name: "title", label: "Software Title" },
            { name: "version", label: "Version" },
            { name: "publisher", label: "Publisher/Distributor" }
        ],
        techreport: [
            { name: "author", label: "Author/Organisation" },
            { name: "year", label: "Year" },
            { name: "title", label: "Report Title" },
            { name: "number", label: "Report Number" },
            { name: "publisher", label: "Publisher" }
        ],
        performance: [
            { name: "title", label: "Performance Title" },
            { name: "year", label: "Year" },
            { name: "playwright", label: "Playwright/Composer" },
            { name: "director", label: "Director" },
            { name: "venue", label: "Venue" },
            { name: "date", label: "Date of performance" }
        ],
        speech: [
            { name: "speaker", label: "Speaker" },
            { name: "year", label: "Year" },
            { name: "title", label: "Speech Title/Description" },
            { name: "event", label: "Event" },
            { name: "location", label: "Location" },
            { name: "date", label: "Date" }
        ],
        interview: [
            { name: "interviewee", label: "Interviewee" },
            { name: "year", label: "Year" },
            { name: "interviewer", label: "Interviewer" },
            { name: "title", label: "Interview Title/Description" },
            { name: "source", label: "Publication/Source" },
            { name: "date", label: "Date" }
        ],
        newsletter: [
            { name: "author", label: "Organisation/Author" },
            { name: "year", label: "Year" },
            { name: "title", label: "Newsletter Title" },
            { name: "issue", label: "Issue/Volume" },
            { name: "date", label: "Date" },
            { name: "url", label: "URL (if online)" }
        ],
        greylit: [
            { name: "author", label: "Author/Organisation" },
            { name: "year", label: "Year" },
            { name: "title", label: "Report Title" },
            { name: "institution", label: "Institution" },
            { name: "notes", label: "Notes (e.g. unpublished, working paper)" }
        ],
        dictionary: [
            { name: "author", label: "Author/Organisation (if any)" },
            { name: "year", label: "Year" },
            { name: "entry", label: "Entry Title" },
            { name: "dictionary", label: "Dictionary Title" },
            { name: "edition", label: "Edition" },
            { name: "publisher", label: "Publisher" },
            { name: "url", label: "URL (if online)" },
            { name: "date", label: "Date accessed (if online)" }
        ],
        magazine: [
            { name: "author", label: "Author" },
            { name: "year", label: "Year" },
            { name: "title", label: "Article Title" },
            { name: "magazine", label: "Magazine Title" },
            { name: "date", label: "Date" },
            { name: "pages", label: "Page number(s)" }
        ],
        streaming: [
            { name: "title", label: "Programme/Film Title" },
            { name: "year", label: "Year" },
            { name: "platform", label: "Platform (e.g. Netflix)" },
            { name: "director", label: "Director (if applicable)" },
            { name: "url", label: "URL" },
            { name: "date", label: "Date accessed" }
        ],
        album: [
            { name: "artist", label: "Artist" },
            { name: "year", label: "Year" },
            { name: "title", label: "Album Title" },
            { name: "label", label: "Publisher/Record Label" }
        ],
        shortvideo: [
            { name: "author", label: "Author/Channel" },
            { name: "year", label: "Year" },
            { name: "title", label: "Video Title" },
            { name: "platform", label: "Platform (e.g. YouTube Shorts, TikTok)" },
            { name: "url", label: "URL" },
            { name: "date", label: "Date accessed" }
        ],
        translated: [
            { name: "author", label: "Author" },
            { name: "year", label: "Year (of translation)" },
            { name: "title", label: "Book Title" },
            { name: "translator", label: "Translator" },
            { name: "place", label: "Place of publication" },
            { name: "publisher", label: "Publisher" }
        ],
        foreignbook: [
            { name: "author", label: "Author" },
            { name: "year", label: "Year" },
            { name: "title", label: "Original Title" },
            { name: "language", label: "Language" },
            { name: "place", label: "Place of publication" },
            { name: "publisher", label: "Publisher" }
        ],
        proceedings: [
            { name: "author", label: "Author(s)" },
            { name: "year", label: "Year" },
            { name: "title", label: "Paper Title" },
            { name: "conference", label: "Conference Title" },
            { name: "pages", label: "Page range" },
            { name: "publisher", label: "Publisher" }
        ],
        intlcase: [
            { name: "case", label: "Case Name" },
            { name: "year", label: "Year" },
            { name: "court", label: "Court" },
            { name: "report", label: "Report/Series" },
            { name: "page", label: "Page number(s)" }
        ],
        bilingual: [
            { name: "author", label: "Author" },
            { name: "year", label: "Year" },
            { name: "title", label: "Title" },
            { name: "edition", label: "Bilingual Edition Details" },
            { name: "place", label: "Place of publication" },
            { name: "publisher", label: "Publisher" }
        ],
        subtitledfilm: [
            { name: "title", label: "Film Title" },
            { name: "year", label: "Year" },
            { name: "director", label: "Director" },
            { name: "country", label: "Country" },
            { name: "studio", label: "Production Company" },
            { name: "subtitles", label: "Subtitle Language" }
        ],
        exhibition: [
            { name: "title", label: "Exhibition Title" },
            { name: "year", label: "Year" },
            { name: "venue", label: "Venue" },
            { name: "location", label: "Location" },
            { name: "date", label: "Dates of exhibition" }
        ],
        catalogueartwork: [
            { name: "artist", label: "Artist" },
            { name: "year", label: "Year" },
            { name: "title", label: "Artwork Title" },
            { name: "catalogue", label: "Exhibition Catalogue Title" },
            { name: "curator", label: "Curator/Editor" },
            { name: "publisher", label: "Publisher" },
            { name: "pages", label: "Page number(s)" }
        ],
        manuscript: [
            { name: "author", label: "Author" },
            { name: "year", label: "Year" },
            { name: "title", label: "Manuscript Title" },
            { name: "repository", label: "Archive/Repository" },
            { name: "ref", label: "Reference number" }
        ],
        onlinethesis: [
            { name: "author", label: "Author" },
            { name: "year", label: "Year" },
            { name: "title", label: "Thesis Title" },
            { name: "degree", label: "Degree" },
            { name: "institution", label: "Institution" },
            { name: "url", label: "URL" },
            { name: "date", label: "Date accessed" }
        ],
        poster: [
            { name: "author", label: "Author(s)" },
            { name: "year", label: "Year" },
            { name: "title", label: "Poster Title" },
            { name: "conference", label: "Conference/Event" },
            { name: "location", label: "Location" },
            { name: "date", label: "Date" }
        ],
        workingpaper: [
            { name: "author", label: "Author(s)" },
            { name: "year", label: "Year" },
            { name: "title", label: "Working Paper Title" },
            { name: "series", label: "Series Name/Number" },
            { name: "institution", label: "Institution/Organisation" }
        ],
        onlineencyclopaedia: [
            { name: "author", label: "Author (if available)" },
            { name: "year", label: "Year" },
            { name: "entry", label: "Entry Title" },
            { name: "encyclopaedia", label: "Encyclopaedia Title" },
            { name: "url", label: "URL" },
            { name: "date", label: "Date accessed" }
        ],
        repositorydataset: [
            { name: "author", label: "Author/Organisation" },
            { name: "year", label: "Year" },
            { name: "title", label: "Dataset Title" },
            { name: "repository", label: "Repository" },
            { name: "doi", label: "DOI" }
        ],
        correspondence: [
            { name: "author", label: "Author" },
            { name: "year", label: "Year" },
            { name: "recipient", label: "Recipient" },
            { name: "date", label: "Date" },
            { name: "location", label: "Location/Archive (if applicable)" }
        ]








    };


    function showSuggestions(query) {
        suggestions.innerHTML = "";
        if (!query) {
            suggestions.style.display = "none";
            return;
        }

        const matches = Object.keys(fieldConfigs).filter(type =>
            type.toLowerCase().includes(query.toLowerCase())
        );

        if (matches.length === 0) {
            suggestions.style.display = "none";
            return;
        }

        matches.forEach(type => {
            const li = document.createElement("li");
            li.textContent = type.charAt(0).toUpperCase() + type.slice(1);
            li.onclick = () => {
                sourceSearch.value = type;
                suggestions.style.display = "none";
                renderFields(type);
            };
            suggestions.appendChild(li);
        });

        suggestions.style.display = "block";
    }

    sourceSearch.addEventListener("input", e => {
        showSuggestions(e.target.value);
    });

    function renderFields(type) {
        fieldsContainer.innerHTML = "";
        if (!fieldConfigs[type]) return; // safeguard if type doesn't exist
        fieldConfigs[type].forEach(field => {
            const label = document.createElement("label");
            label.textContent = field.label;
            const input = document.createElement("input");
            input.type = "text";
            input.id = field.name;
            input.placeholder = field.label;
            fieldsContainer.appendChild(label);
            fieldsContainer.appendChild(input);
        });
    }

    function formatAuthors(authorsInput) {
        const authors = authorsInput.split(",").map(a => a.trim()).filter(a => a);
        const formatted = authors.map(name => {
            const parts = name.split(" ").filter(p => p);
            if (parts.length === 1) return name;
            const surname = parts.pop();
            const initials = parts.map(p => p.charAt(0).toUpperCase() + ".").join(" ");
            return `${surname}, ${initials}`;
        });
        if (formatted.length === 1) return formatted[0];
        if (formatted.length === 2) return formatted.join(" and ");
        return formatted.slice(0, -1).join(", ") + " and " + formatted.slice(-1);
    }

    function generateCitation() {
        const type = sourceSearch.value.toLowerCase();
        let citation = "";

        if (!fieldConfigs[type]) {
            citationOutput.innerText = "⚠️ Please choose a valid source type.";
            copyBtn.style.display = "none";
            return;
        }

        if (type === "book") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Title]";
            const place = document.getElementById("place").value || "[Place]";
            const publisher = document.getElementById("publisher").value || "[Publisher]";
            citation = `${author} (${year}) ${title}. ${place}: ${publisher}.`;
        }

        if (type === "ebook") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Title]";
            const platform = document.getElementById("platform").value || "[Platform]";
            const url = document.getElementById("url").value || "[URL]";
            citation = `${author} (${year}) ${title}. [E-book] ${platform}. Available at: ${url}`;
        }

        if (type === "journal") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Title]";
            const journal = document.getElementById("journal").value || "[Journal]";
            const volume = document.getElementById("volume").value || "[Volume]";
            const issue = document.getElementById("issue").value || "[Issue]";
            const pages = document.getElementById("pages").value || "[Pages]";
            citation = `${author} (${year}) '${title}', ${journal}, ${volume}(${issue}), pp. ${pages}.`;
        }

        if (type === "website") {
            let author = document.getElementById("author").value || "[Author/Organisation]";
            if (author !== "[Author/Organisation]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Title]";
            const site = document.getElementById("site").value || "[Website]";
            const url = document.getElementById("url").value || "[URL]";
            const date = document.getElementById("date").value || "[Accessed Date]";
            citation = `${author} (${year}) ${title}. ${site}. Available at: ${url} (Accessed: ${date}).`;
        }

        if (type === "podcast") {
            let host = document.getElementById("host").value || "[Host]";
            if (host !== "[Host]") host = formatAuthors(host);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Podcast Title]";
            const episode = document.getElementById("episode").value || "[Episode]";
            const platform = document.getElementById("platform").value || "[Platform]";
            citation = `${host} (${year}) '${episode}', ${title}. Available at: ${platform}`;
        }

        if (type === "film") {
            const title = document.getElementById("title").value || "[Film Title]";
            const year = document.getElementById("year").value || "[Year]";
            const director = document.getElementById("director").value || "[Director]";
            const country = document.getElementById("country").value || "[Country]";
            const studio = document.getElementById("studio").value || "[Production Company]";
            citation = `${title} (${year}) Directed by ${director}. ${country}: ${studio}.`;
        }

        if (type === "thesis") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Thesis Title]";
            const degree = document.getElementById("degree").value || "[Degree]";
            const institution = document.getElementById("institution").value || "[Institution]";
            citation = `${author} (${year}) ${title}. ${degree}. ${institution}.`;
        }

        if (type === "socialmedia") {
            let author = document.getElementById("author").value || "[Author]";
            const handle = document.getElementById("handle").value || "[@handle]";
            const year = document.getElementById("year").value || "[Year]";
            const content = document.getElementById("content").value || "[Post Content]";
            const platform = document.getElementById("platform").value || "[Platform]";
            const url = document.getElementById("url").value || "[URL]";
            const date = document.getElementById("date").value || "[Accessed Date]";
            citation = `${author} ${handle} (${year}) ${content}. ${platform}. Available at: ${url} (Accessed: ${date}).`;
        }

        if (type === "legislation") {
            const title = document.getElementById("title").value || "[Legislation Title]";
            const year = document.getElementById("year").value || "[Year]";
            const chapter = document.getElementById("chapter").value || "[Chapter]";
            const country = document.getElementById("country").value || "[Country]";
            citation = `${title} ${year}, c.${chapter} (${country}).`;
        }

        if (type === "report") {
            let author = document.getElementById("author").value || "[Author/Organisation]";
            if (author !== "[Author/Organisation]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Report Title]";
            const publisher = document.getElementById("publisher").value || "[Publisher]";
            const url = document.getElementById("url").value || "[URL]";
            citation = `${author} (${year}) ${title}. ${publisher}. Available at: ${url}`;
        }

        if (type === "artwork") {
            const artist = document.getElementById("artist").value || "[Artist]";
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Artwork Title]";
            const medium = document.getElementById("medium").value || "[Medium]";
            const location = document.getElementById("location").value || "[Location]";
            citation = `${artist} (${year}) ${title} [${medium}]. ${location}.`;
        }

        if (type === "chapter") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const chapter = document.getElementById("chapter").value || "[Chapter]";
            const editor = document.getElementById("editor").value || "[Editor]";
            const booktitle = document.getElementById("booktitle").value || "[Book Title]";
            const place = document.getElementById("place").value || "[Place]";
            const publisher = document.getElementById("publisher").value || "[Publisher]";
            const pages = document.getElementById("pages").value || "[Pages]";
            citation = `${author} (${year}) '${chapter}', in ${editor} (ed.) ${booktitle}. ${place}: ${publisher}, pp. ${pages}.`;
        }

        if (type === "conference") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Paper Title]";
            const conference = document.getElementById("conference").value || "[Conference]";
            const place = document.getElementById("place").value || "[Place]";
            const pages = document.getElementById("pages").value || "[Pages]";
            citation = `${author} (${year}) '${title}', presented at ${conference}, ${place}, pp. ${pages}.`;
        }

        if (type === "newspaper") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Title]";
            const paper = document.getElementById("paper").value || "[Newspaper]";
            const date = document.getElementById("date").value || "[Date]";
            const pages = document.getElementById("pages").value || "[Pages]";
            citation = `${author} (${year}) '${title}', ${paper}, ${date}, p. ${pages}.`;
        }

        if (type === "youtube") {
            let author = document.getElementById("author").value || "[Author/Channel]";
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Video Title]";
            const url = document.getElementById("url").value || "[URL]";
            const date = document.getElementById("date").value || "[Accessed Date]";
            citation = `${author} (${year}) ${title}. YouTube. Available at: ${url} (Accessed: ${date}).`;
        }

        if (type === "govdoc") {
            let author = document.getElementById("author").value || "[Organisation]";
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Title]";
            const place = document.getElementById("place").value || "[Place]";
            const publisher = document.getElementById("publisher").value || "[Publisher]";
            citation = `${author} (${year}) ${title}. ${place}: ${publisher}.`;
        }

        if (type === "tv") {
            const title = document.getElementById("title").value || "[Programme]";
            const year = document.getElementById("year").value || "[Year]";
            const channel = document.getElementById("channel").value || "[Channel]";
            const date = document.getElementById("date").value || "[Date]";
            citation = `${title} (${year}) Television broadcast, ${channel}, ${date}.`;
        }

        if (type === "radio") {
            const title = document.getElementById("title").value || "[Programme]";
            const year = document.getElementById("year").value || "[Year]";
            const station = document.getElementById("station").value || "[Station]";
            const date = document.getElementById("date").value || "[Date]";
            citation = `${title} (${year}) Radio broadcast, ${station}, ${date}.`;
        }

        if (type === "music") {
            const composer = document.getElementById("composer").value || "[Composer]";
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Title]";
            const performer = document.getElementById("performer").value || "[Performer]";
            const publisher = document.getElementById("publisher").value || "[Publisher/Label]";
            citation = `${composer} (${year}) ${title}, performed by ${performer}. ${publisher}.`;
        }

        if (type === "map") {
            let author = document.getElementById("author").value || "[Cartographer]";
            if (author !== "[Cartographer]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Map]";
            const scale = document.getElementById("scale").value || "[Scale]";
            const place = document.getElementById("place").value || "[Place]";
            const publisher = document.getElementById("publisher").value || "[Publisher]";
            citation = `${author} (${year}) ${title} [Map]. Scale ${scale}. ${place}: ${publisher}.`;
        }

        if (type === "archive") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Document]";
            const collection = document.getElementById("collection").value || "[Collection]";
            const archive = document.getElementById("archive").value || "[Archive]";
            citation = `${author} (${year}) ${title}. ${collection}. ${archive}.`;
        }

        if (type === "email") {
            let author = document.getElementById("author").value || "[Sender]";
            if (author !== "[Sender]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const subject = document.getElementById("subject").value || "[Subject]";
            const recipient = document.getElementById("recipient").value || "[Recipient]";
            const date = document.getElementById("date").value || "[Date]";
            citation = `${author} (${year}) Email to ${recipient}, ${date}. Subject: ${subject}.`;
        }

        if (type === "lecture") {
            let author = document.getElementById("author").value || "[Lecturer]";
            if (author !== "[Lecturer]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Lecture Title]";
            const module = document.getElementById("module").value || "[Module]";
            const institution = document.getElementById("institution").value || "[Institution]";
            const date = document.getElementById("date").value || "[Date]";
            citation = `${author} (${year}) ${title}. ${module}, ${institution}, ${date}.`;
        }

        if (type === "dataset") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Dataset Title]";
            const publisher = document.getElementById("publisher").value || "[Publisher]";
            const doi = document.getElementById("doi").value || "[DOI/URL]";
            citation = `${author} (${year}) ${title}. ${publisher}. Available at: ${doi}`;
        }

        if (type === "patent") {
            let inventor = document.getElementById("inventor").value || "[Inventor]";
            if (inventor !== "[Inventor]") inventor = formatAuthors(inventor);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Patent Title]";
            const country = document.getElementById("country").value || "[Country]";
            const number = document.getElementById("number").value || "[Patent Number]";
            citation = `${inventor} (${year}) ${title}. ${country} Patent ${number}.`;
        }

        if (type === "caselaw") {
            const caseName = document.getElementById("case").value || "[Case]";
            const year = document.getElementById("year").value || "[Year]";
            const report = document.getElementById("report").value || "[Report]";
            const volume = document.getElementById("volume").value || "[Vol]";
            const page = document.getElementById("page").value || "[Page]";
            citation = `${caseName} (${year}) ${volume} ${report} ${page}.`;
        }

        if (type === "treaty") {
            const title = document.getElementById("title").value || "[Treaty]";
            const year = document.getElementById("year").value || "[Year]";
            const parties = document.getElementById("parties").value || "[Parties]";
            const source = document.getElementById("source").value || "[Source]";
            citation = `${title} (${year}) between ${parties}. Published in: ${source}.`;
        }

        if (type === "standard") {
            const organisation = document.getElementById("organisation").value || "[Org]";
            const year = document.getElementById("year").value || "[Year]";
            const number = document.getElementById("number").value || "[Standard]";
            const title = document.getElementById("title").value || "[Title]";
            citation = `${organisation} (${year}) ${title}. ${organisation} Standard ${number}.`;
        }

        if (type === "blog") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Post Title]";
            const blog = document.getElementById("blog").value || "[Blog]";
            const url = document.getElementById("url").value || "[URL]";
            const date = document.getElementById("date").value || "[Accessed Date]";
            citation = `${author} (${year}) '${title}', ${blog}. Available at: ${url} (Accessed: ${date}).`;
        }

        if (type === "podcastguest") {
            let host = document.getElementById("host").value || "[Host]";
            if (host !== "[Host]") host = formatAuthors(host);
            let guest = document.getElementById("guest").value || "[Guest]";
            if (guest !== "[Guest]") guest = formatAuthors(guest);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Podcast]";
            const episode = document.getElementById("episode").value || "[Episode]";
            const platform = document.getElementById("platform").value || "[Platform]";
            citation = `${host} with ${guest} (${year}) '${episode}', ${title}. Available at: ${platform}`;
        }

        if (type === "dissertation") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Dissertation Title]";
            const institution = document.getElementById("institution").value || "[Institution]";
            const level = document.getElementById("level").value || "[Level]";
            citation = `${author} (${year}) ${title}. Unpublished ${level} dissertation. ${institution}.`;
        }

        if (type === "encyclopaedia") {
            let author = document.getElementById("author").value || "";
            if (author && author !== "[Author]") author = formatAuthors(author) + " ";
            const year = document.getElementById("year").value || "[Year]";
            const entry = document.getElementById("entry").value || "[Entry]";
            const encyclopaedia = document.getElementById("encyclopaedia").value || "[Encyclopaedia]";
            const edition = document.getElementById("edition").value || "[Edition]";
            const publisher = document.getElementById("publisher").value || "[Publisher]";
            const url = document.getElementById("url").value || "";
            const date = document.getElementById("date").value || "";
            citation = `${author}(${year}) '${entry}', in ${encyclopaedia}. ${edition}. ${publisher}.${url ? ` Available at: ${url} (Accessed: ${date}).` : ""}`;
        }

        if (type === "twitter") {
            const author = document.getElementById("author").value || "[Author]";
            const year = document.getElementById("year").value || "[Year]";
            const content = document.getElementById("content").value || "[Tweet]";
            const url = document.getElementById("url").value || "[URL]";
            const date = document.getElementById("date").value || "[Date]";
            citation = `${author} (${year}) ${content}. Twitter. Available at: ${url} (Accessed: ${date}).`;
        }

        if (type === "tiktok") {
            const author = document.getElementById("author").value || "[Author]";
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Video]";
            const url = document.getElementById("url").value || "[URL]";
            const date = document.getElementById("date").value || "[Date]";
            citation = `${author} (${year}) ${title}. TikTok. Available at: ${url} (Accessed: ${date}).`;
        }

        if (type === "instagram") {
            const author = document.getElementById("author").value || "[Author]";
            const year = document.getElementById("year").value || "[Year]";
            const content = document.getElementById("content").value || "[Post]";
            const url = document.getElementById("url").value || "[URL]";
            const date = document.getElementById("date").value || "[Date]";
            citation = `${author} (${year}) ${content}. Instagram. Available at: ${url} (Accessed: ${date}).`;
        }

        if (type === "secondary") {
            const originalAuthor = document.getElementById("originalAuthor").value || "[Original Author]";
            const yearOriginal = document.getElementById("yearOriginal").value || "[Year]";
            let citingAuthor = document.getElementById("citingAuthor").value || "[Citing Author]";
            if (citingAuthor !== "[Citing Author]") citingAuthor = formatAuthors(citingAuthor);
            const yearCiting = document.getElementById("yearCiting").value || "[Year]";
            const title = document.getElementById("title").value || "[Citing Source]";
            const publisher = document.getElementById("publisher").value || "[Publisher]";
            citation = `${originalAuthor} (${yearOriginal}) cited in ${citingAuthor} (${yearCiting}) ${title}. ${publisher}.`;
        }

        if (type === "labmanual") {
            const institution = document.getElementById("institution").value || "[Institution]";
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Lab Manual]";
            const course = document.getElementById("course").value || "[Course]";
            citation = `${institution} (${year}) ${title}. ${course} laboratory manual.`;
        }

        if (type === "datasetdoi") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Dataset]";
            const doi = document.getElementById("doi").value || "[DOI]";
            citation = `${author} (${year}) ${title}. doi: ${doi}`;
        }

        if (type === "software") {
            let author = document.getElementById("author").value || "[Author/Company]";
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Software]";
            const version = document.getElementById("version").value || "[Version]";
            const publisher = document.getElementById("publisher").value || "[Publisher]";
            citation = `${author} (${year}) ${title}. Version ${version}. ${publisher}.`;
        }

        if (type === "techreport") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Report]";
            const number = document.getElementById("number").value || "[Report Number]";
            const publisher = document.getElementById("publisher").value || "[Publisher]";
            citation = `${author} (${year}) ${title}. Technical Report ${number}. ${publisher}.`;
        }

        if (type === "performance") {
            const title = document.getElementById("title").value || "[Performance]";
            const year = document.getElementById("year").value || "[Year]";
            const playwright = document.getElementById("playwright").value || "[Playwright]";
            const director = document.getElementById("director").value || "[Director]";
            const venue = document.getElementById("venue").value || "[Venue]";
            const date = document.getElementById("date").value || "[Date]";
            citation = `${playwright} (${year}) ${title}, directed by ${director}. Performed at ${venue}, ${date}.`;
        }

        if (type === "speech") {
            const speaker = document.getElementById("speaker").value || "[Speaker]";
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Speech]";
            const event = document.getElementById("event").value || "[Event]";
            const location = document.getElementById("location").value || "[Location]";
            const date = document.getElementById("date").value || "[Date]";
            citation = `${speaker} (${year}) '${title}', speech at ${event}, ${location}, ${date}.`;
        }

        if (type === "interview") {
            const interviewee = document.getElementById("interviewee").value || "[Interviewee]";
            const year = document.getElementById("year").value || "[Year]";
            const interviewer = document.getElementById("interviewer").value || "[Interviewer]";
            const title = document.getElementById("title").value || "[Interview]";
            const source = document.getElementById("source").value || "[Source]";
            const date = document.getElementById("date").value || "[Date]";
            citation = `${interviewee} (${year}) Interview with ${interviewer}. '${title}', ${source}, ${date}.`;
        }

        if (type === "newsletter") {
            const author = document.getElementById("author").value || "[Author/Org]";
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Newsletter]";
            const issue = document.getElementById("issue").value || "[Issue]";
            const date = document.getElementById("date").value || "[Date]";
            const url = document.getElementById("url").value || "";
            citation = `${author} (${year}) ${title}, ${issue}, ${date}.${url ? ` Available at: ${url}` : ""}`;
        }

        if (type === "greylit") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Report]";
            const institution = document.getElementById("institution").value || "[Institution]";
            const notes = document.getElementById("notes").value || "[Notes]";
            citation = `${author} (${year}) ${title}. ${institution}. ${notes}.`;
        }
        if (type === "dictionary") {
            let author = document.getElementById("author").value || "";
            if (author && author !== "[Author]") author = formatAuthors(author) + " ";
            const year = document.getElementById("year").value || "[Year]";
            const entry = document.getElementById("entry").value || "[Entry]";
            const dictionary = document.getElementById("dictionary").value || "[Dictionary]";
            const edition = document.getElementById("edition").value || "[Edition]";
            const publisher = document.getElementById("publisher").value || "[Publisher]";
            const url = document.getElementById("url").value || "";
            const date = document.getElementById("date").value || "";
            citation = `${author}(${year}) '${entry}', in ${dictionary}. ${edition}. ${publisher}.${url ? ` Available at: ${url} (Accessed: ${date}).` : ""}`;
        }

        if (type === "magazine") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Article]";
            const magazine = document.getElementById("magazine").value || "[Magazine]";
            const date = document.getElementById("date").value || "[Date]";
            const pages = document.getElementById("pages").value || "[Pages]";
            citation = `${author} (${year}) '${title}', ${magazine}, ${date}, pp. ${pages}.`;
        }

        if (type === "streaming") {
            const title = document.getElementById("title").value || "[Programme/Film]";
            const year = document.getElementById("year").value || "[Year]";
            const platform = document.getElementById("platform").value || "[Platform]";
            const director = document.getElementById("director").value || "[Director]";
            const url = document.getElementById("url").value || "[URL]";
            const date = document.getElementById("date").value || "[Date]";
            citation = `${title} (${year}) Directed by ${director}. ${platform}. Available at: ${url} (Accessed: ${date}).`;
        }

        if (type === "album") {
            const artist = document.getElementById("artist").value || "[Artist]";
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Album]";
            const label = document.getElementById("label").value || "[Label]";
            citation = `${artist} (${year}) ${title} [Album]. ${label}.`;
        }

        if (type === "shortvideo") {
            const author = document.getElementById("author").value || "[Author]";
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Video]";
            const platform = document.getElementById("platform").value || "[Platform]";
            const url = document.getElementById("url").value || "[URL]";
            const date = document.getElementById("date").value || "[Date]";
            citation = `${author} (${year}) ${title}. ${platform}. Available at: ${url} (Accessed: ${date}).`;
        }
        if (type === "translated") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Book]";
            const translator = document.getElementById("translator").value || "[Translator]";
            const place = document.getElementById("place").value || "[Place]";
            const publisher = document.getElementById("publisher").value || "[Publisher]";
            citation = `${author} (${year}) ${title}. Translated by ${translator}. ${place}: ${publisher}.`;
        }

        if (type === "foreignbook") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Title]";
            const language = document.getElementById("language").value || "[Language]";
            const place = document.getElementById("place").value || "[Place]";
            const publisher = document.getElementById("publisher").value || "[Publisher]";
            citation = `${author} (${year}) ${title}. (${language} edition). ${place}: ${publisher}.`;
        }

        if (type === "proceedings") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Paper]";
            const conference = document.getElementById("conference").value || "[Conference]";
            const pages = document.getElementById("pages").value || "[Pages]";
            const publisher = document.getElementById("publisher").value || "[Publisher]";
            citation = `${author} (${year}) '${title}', in ${conference}, pp. ${pages}. ${publisher}.`;
        }

        if (type === "intlcase") {
            const caseName = document.getElementById("case").value || "[Case]";
            const year = document.getElementById("year").value || "[Year]";
            const court = document.getElementById("court").value || "[Court]";
            const report = document.getElementById("report").value || "[Report]";
            const page = document.getElementById("page").value || "[Page]";
            citation = `${caseName} (${year}), ${court}, ${report}, p. ${page}.`;
        }

        if (type === "bilingual") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Title]";
            const edition = document.getElementById("edition").value || "[Edition]";
            const place = document.getElementById("place").value || "[Place]";
            const publisher = document.getElementById("publisher").value || "[Publisher]";
            citation = `${author} (${year}) ${title}. ${edition}. ${place}: ${publisher}.`;
        }

        if (type === "subtitledfilm") {
            const title = document.getElementById("title").value || "[Film]";
            const year = document.getElementById("year").value || "[Year]";
            const director = document.getElementById("director").value || "[Director]";
            const country = document.getElementById("country").value || "[Country]";
            const studio = document.getElementById("studio").value || "[Studio]";
            const subtitles = document.getElementById("subtitles").value || "[Language]";
            citation = `${title} (${year}) Directed by ${director}. ${country}: ${studio}. Subtitled in ${subtitles}.`;
        }

        if (type === "exhibition") {
            const title = document.getElementById("title").value || "[Exhibition]";
            const year = document.getElementById("year").value || "[Year]";
            const venue = document.getElementById("venue").value || "[Venue]";
            const location = document.getElementById("location").value || "[Location]";
            const date = document.getElementById("date").value || "[Dates]";
            citation = `${title} (${year}) Exhibition at ${venue}, ${location}, ${date}.`;
        }

        if (type === "catalogueartwork") {
            const artist = document.getElementById("artist").value || "[Artist]";
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Artwork]";
            const catalogue = document.getElementById("catalogue").value || "[Catalogue]";
            const curator = document.getElementById("curator").value || "[Curator]";
            const publisher = document.getElementById("publisher").value || "[Publisher]";
            const pages = document.getElementById("pages").value || "[Pages]";
            citation = `${artist} (${year}) ${title}, in ${curator} (ed.) ${catalogue}. ${publisher}, p. ${pages}.`;
        }

        if (type === "manuscript") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Manuscript]";
            const repository = document.getElementById("repository").value || "[Repository]";
            const ref = document.getElementById("ref").value || "[Ref]";
            citation = `${author} (${year}) ${title}. ${repository}, Ref. ${ref}.`;
        }

        if (type === "onlinethesis") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Thesis]";
            const degree = document.getElementById("degree").value || "[Degree]";
            const institution = document.getElementById("institution").value || "[Institution]";
            const url = document.getElementById("url").value || "[URL]";
            const date = document.getElementById("date").value || "[Date]";
            citation = `${author} (${year}) ${title}. ${degree}. ${institution}. Available at: ${url} (Accessed: ${date}).`;
        }

        if (type === "poster") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Poster]";
            const conference = document.getElementById("conference").value || "[Conference]";
            const location = document.getElementById("location").value || "[Location]";
            const date = document.getElementById("date").value || "[Date]";
            citation = `${author} (${year}) '${title}', poster presented at ${conference}, ${location}, ${date}.`;
        }

        if (type === "workingpaper") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Working Paper]";
            const series = document.getElementById("series").value || "[Series]";
            const institution = document.getElementById("institution").value || "[Institution]";
            citation = `${author} (${year}) ${title}. ${series}. ${institution}.`;
        }

        if (type === "onlineencyclopaedia") {
            let author = document.getElementById("author").value || "";
            if (author && author !== "[Author]") author = formatAuthors(author) + " ";
            const year = document.getElementById("year").value || "[Year]";
            const entry = document.getElementById("entry").value || "[Entry]";
            const encyclopaedia = document.getElementById("encyclopaedia").value || "[Encyclopaedia]";
            const url = document.getElementById("url").value || "[URL]";
            const date = document.getElementById("date").value || "[Date]";
            citation = `${author}(${year}) '${entry}', in ${encyclopaedia}. Available at: ${url} (Accessed: ${date}).`;
        }

        if (type === "repositorydataset") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const title = document.getElementById("title").value || "[Dataset]";
            const repository = document.getElementById("repository").value || "[Repository]";
            const doi = document.getElementById("doi").value || "[DOI]";
            citation = `${author} (${year}) ${title}. ${repository}. doi: ${doi}`;
        }

        if (type === "correspondence") {
            let author = document.getElementById("author").value || "[Author]";
            if (author !== "[Author]") author = formatAuthors(author);
            const year = document.getElementById("year").value || "[Year]";
            const recipient = document.getElementById("recipient").value || "[Recipient]";
            const date = document.getElementById("date").value || "[Date]";
            const location = document.getElementById("location").value || "[Location]";
            citation = `${author} (${year}) Letter to ${recipient}, ${date}. ${location}.`;
        }


        citationOutput.innerText = citation;
        copyBtn.style.display = citation ? "block" : "none";
    }


    function copyCitation() {
        const citation = citationOutput.innerText;
        if (citation) {
            navigator.clipboard.writeText(citation).then(() => {
                copyBtn.textContent = "Copied!";
                setTimeout(() => { copyBtn.textContent = "Copy to Clipboard"; }, 2000);
            });
        }
    }

    // ✅ On load, default to Book
    window.onload = () => {
        sourceSearch.value = "book";
        renderFields("book");
    };

</script>

</body>
</html>
