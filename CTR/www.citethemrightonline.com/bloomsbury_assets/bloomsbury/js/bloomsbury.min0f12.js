$.urlParam=function(name){var results=new RegExp('[\?&]'+name+'=([^&#]*)').exec(window.location.href.toLowerCase());if(results==null){return''}else{return results[1]||0}}
$.urlNewParam=function(name){var results=new RegExp('[\?&]'+name+'=([^&#]*)').exec(window.location.href);if(results==null){return''}else{return results[1]||0}}
$.linkParam=function(name,url){var results=new RegExp('[\?&]'+name+'=([^&#]*)').exec(url.toLowerCase());if(results==null){return''}else{return results[1]||''}}
$.linkNewParam=function(name,url){var results=new RegExp('[\?&]'+name+'=([^&#]*)').exec(url);if(results==null){return''}else{return results[1]||''}}
String.prototype.replaceAll=function(search,replacement){var target=this;return target.replace(new RegExp(search,'g'),replacement)};var vis=(function(){var stateKey,eventKey,keys={hidden:"visibilitychange",webkitHidden:"webkitvisibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange"};for(stateKey in keys){if(stateKey in document){eventKey=keys[stateKey];break}}
return function(c){if(c)document.addEventListener(eventKey,c);return!document[stateKey]}})();function triggerChange(element){$(element).trigger('change')}
function navigatePageGA(){var imageControlObj={};imageControlObj.event="image_interaction";imageControlObj.interaction_type="Navigate to another page";dataLayer.push(imageControlObj)}
var sessionTimer;var sessionTimeoutConfigValue=parseInt($('#session-timeout-Value').val());var counterTime=10;var timeoutMin=sessionTimeoutConfigValue-counterTime;var timeoutValue=timeoutMin*60*1000;var ajaxTimeout=3540000;var sessionTimeoutMin=timeoutMin+counterTime;var ajaxTimer;var nowTime;var currTime;var videoPlaying=!1;var videoPage=~window.location.href.indexOf("video?docid")||~window.location.href.indexOf("audio?docid");var sessionTimeout=function(event){if(!videoPlaying&&!videoPage){nowTime=new Date();clearTimeout(sessionTimer);sessionTimer=setTimeout(sessionModal,timeoutValue)}}
var pingFunction=function(){$.ajax({url:'/app/keepalive',data:{email:''},success:function(response){clearTimeout(ajaxTimer);ajaxTimer=setTimeout(pingFunction,ajaxTimeout)},method:'POST'})};function sendCounterBackendLog(databaseData){var metaTag=$(document).find('meta[name="ST.customerId"]');var customerId="missing";if(metaTag.length>0){customerId=metaTag.attr("content")?metaTag.attr("content"):"missing"}
for(var x=0;x<databaseData.length;x++){databaseData[x].customerId=customerId}
var logdata={"log":databaseData};$.ajax({type:"POST",url:'/app/counterlog',data:{logdata:JSON.stringify(logdata)},success:function(e){console.log("Counter Data logged successfully")},error:function(error){}})}
function squidCall(event,location,link){var mdid=link||"";var options=window.squidObj||{};options.mact=event;options.mut="Event";options.mdid=mdid;options.mcz=location;var userId;var formData;if(window.formObj){formData=window.formObj;window.formObj=''}
triggerSquidEvent(options,event,siteId,userId,formData)}
function triggerSquidEvent(options,eventName,product,userId,formData){sqtrkq.push(['wid',product]);if(userId){sqtrkq.push(['uid',userId])}
var eventData;if(formData){formData.event=eventName;eventData=formData}else{eventData={"event":eventName}}
for(member in options){eventData[member]=options[member]}
eventData=JSON.stringify(eventData);var u=new URI(document.location.href);sqtrkq.push(['dom','.'+u.domain()]);sqtrkq.push(['post',!0]);sqtrkq.push(['event',encodeURIComponent(eventData)]);if(window.refLink){setTimeout(function(){var refLink=window.refLink;window.refLink='';window.location.href=refLink},300)}}
function callSquidTracker(options){var squidObj=window.squidObj||{};for(member in options){squidObj[member]=options[member]}
sqtrkq.push(['wid',window.siteId]);var u=new URI(document.location.href);sqtrkq.push(['dom','.'+u.domain()]);if(window.uid){sqtrkq.push(['uid',uid])}
sqtrkq.push(['ext',encodeURIComponent(JSON.stringify(squidObj))]);sqtrkq.push(['post',!0]);sqtrkq.push(['track'])}
function relatedContent(docId,lang,siteName,contentType,territory,content){var relatedContentLength=$("#related_content").find(".category_cont").length;var catalogueContentLength=$("#catalogue-content").find(".category_cont").length;var relatedVideosTitle="RELATED VIDEOS";var relatedAudiosTitle="RELATED AUDIOS";var relatedMediaTitle="RELATED MEDIA";var relatedImagesTitle="RELATED IMAGES";var author="";if(relatedContentLength==0&&content.type!="sourcetype"){showProgress();if(content.type=="monograph"){if($(".article_cont #article_author .popper"))
$(".article_cont #article_author .popper").each(function(){if(author=="")
author+=$(this).text();else author+=","+$(this).text()})}
if(author=="")
author="null";console.log(" author -> "+author);$.ajax({url:'api/searchresult/relatedContents/'+siteName+'/'+docId+'/'+lang+'/'+contentType+'/'+territory+'/'+author,success:function(response){$("#related_content").append(response);if($("#related_content").find(".category_cont").length>0){$("#related_content").find('.category_cont').each(function(index){if(index>4){$(this).addClass('hide')}});if($("#related_content").find(".category_cont").length>5){$("#related_content").append('<a href="javascript:void(0)" class="more-results pull-right highlight-txt mt10" data-more="View More" data-less="View Less" id="contenttype_more">View More</a>')}}else{$("#related_content").addClass("hide")}
if(content&&content.squidFlag){content.registerRelatedSquidEvents()}
$.cloudinary.responsive();$(".cld-related-images").off().on("keyup",function(e){if(e.keyCode==13){$(this).click()}});hideProgress()},error:function(error){$("#related_content").addClass("hide");hideProgress()}})}else if(relatedContentLength==0){$("#related_content").addClass("hide")}else{$("#related_content").find('.category_cont').each(function(index){if(index>4){$(this).addClass('hide')}});if($("#related_content").find(".category_cont").length>5){$("#related_content").append('<a href="javascript:void(0)" class="more-results pull-right highlight-txt mt10" data-more="View More" data-less="View Less" id="contenttype_more">View More</a>')}
if(content.squidFlag){content.registerRelatedSquidEvents()}}
if(catalogueContentLength>0){$("#catalogue-content").find('.category_cont').each(function(index){if(index>4){$(this).addClass('hide')}});if($("#catalogue-content").find(".category_cont").length>5){$("#catalogue-content").append('<a href="javascript:void(0)" class="more-results pull-right highlight-txt mt10" data-more="View More" data-less="View Less" id="contenttype_more">View More</a>')}}
if($("#related_media").length>0&&$("#related_media").find(".multimedia-thumb,.multimedia-rel").length==0){$.ajax({url:'api/searchresult/relatedMedia/'+siteName+'/'+docId+'/'+lang+'/'+contentType+'/'+territory,success:function(response){$("#related_media").append(response);if($("#related_media").find(".multimedia-thumb").length>0){$("#related_media").find('.multimedia-thumb').each(function(index){if(index>4){$(this).addClass('hide')}});if($("#related_media").find(".multimedia-thumb").length>5){$("#related_media").append('<div class="clearfix"></div><a href="javascript:void(0)" class="more-results pull-right highlight-txt mt10" data-type="media" data-more="View More" data-less="View Less" id="contenttype_more">View More</a><div class="clearfix"></div>')}else{$("#related_media").append('<div class="clearfix"></div>')}
var relatedMedia=$('.related-media-type').val();if(relatedMedia=="audio"){$("#related_media h2").text(relatedAudiosTitle)}else if(relatedMedia=="video"){$("#related_media h2").text(relatedVideosTitle)}else if(relatedMedia=="image"){$("#related_media h2").text(relatedImagesTitle)}else{$("#related_media h2").text(relatedMediaTitle)}
$("#related_media").removeClass("hide")}else{$("#related_media").addClass("hide")}
$.cloudinary.responsive();$(".cld-related-images").off().on("keyup",function(e){if(e.keyCode==13){$(this).click()}});hideProgress()},error:function(error){$("#related_media").addClass("hide");hideProgress()}})}else if($("#related_media").length>0){var audioLength=$("#related_media").find('.multimedia-thumb[type="audio"],.multimedia-rel[type="audio"]').length;var videoLength=$("#related_media").find('.multimedia-thumb[type="video"],.multimedia-rel[type="video"]').length;var imageLength=$("#related_media").find('.multimedia-thumb[type="image"],.multimedia-rel[type="image"]').length;var mediaText=relatedMediaTitle;if(audioLength==0&&videoLength==0&&imageLength>0){mediaText=relatedImagesTitle}else if(videoLength==0&&imageLength==0&&audioLength>0){mediaText=relatedAudiosTitle}else if(audioLength==0&&imageLength==0&&videoLength>0){mediaText=relatedVideosTitle}
if($("#related_media").find(".multimedia-thumb").length>5){$("#related_media").append('<div class="clearfix"></div><a href="javascript:void(0)" class="more-results pull-right highlight-txt mt10" data-type="media" data-more="View More" data-less="View Less" id="contenttype_more">View More</a><div class="clearfix"></div>')}else{$("#related_media").append('<div class="clearfix"></div>')}
$("#related_media h2").text(mediaText);$("#related_media").removeClass("hide")}}
function truncateAltAuth(){$('.text-trunc-auth').each(function(){var $ellipsisText=$(this);textContainerHeight=$ellipsisText.parents('.text-trunc-auth-outer').height();if($ellipsisText.outerHeight(!0)<=textContainerHeight){$ellipsisText.parent().parent().find('.author-view-more').addClass('hide')}else{$ellipsisText.parent().parent().find('.author-view-more').removeClass('hide')}})}
$(document).on('click','#session-login',function(event){$('.modal-backdrop').remove();$("#session-modal").modal('hide');clearTimeout(sessionTimer);clearInterval(interval);showProgress();var dataObject={'event':'timeout_keep_me_logged_in'};pushDataLayerForGoogleTag(dataObject);location.reload()});$(document).on('click','#session-logout',function(event){$('.modal-backdrop').remove();$("#session-modal").modal('hide');clearTimeout(sessionTimer);clearInterval(interval);showProgress();var dataObject={'event':'timeout_manual_logout'};pushDataLayerForGoogleTag(dataObject);callLogout()});vis(function(event){if(vis()){var userLoggedIn=$.cookie('LoggedInFlag');var userSignedIn=$.cookie('SignedInFlag');if(nowTime&&((userLoggedIn=='true'&&$(".logout-btn")[0])||userSignedIn)&&!videoPlaying&&!videoPage){var currTime=new Date();var diff=parseInt((currTime.getTime()-nowTime.getTime())/1000);var diffMinutes=parseInt(diff/60);var diffSeconds=parseInt(diff%60);var timerVal;var newDiff=sessionTimeoutMin*60-diff;if(newDiff<=0){var dataObject={'event':'timeout_auto_logout'};pushDataLayerForGoogleTag(dataObject);callLogout()}else if(newDiff<=60*counterTime){timerVal=newDiff}else if(newDiff>60*counterTime){clearTimeout(sessionTimer);sessionTimer=setTimeout(sessionModal,(60*timeoutMin-diff)*1000)}else{timerVal=60*counterTime}
if(timerVal){nowTime=currTime;display=$('#time');$(document).off('click',sessionTimeout);startTimer(timerVal,display);$('.modal').each(function(){if($(this).attr('id')!="session-modal"){$(this).modal('hide')}});hideProgress();if($('#session-modal').is(':hidden')){$('.modal-backdrop').remove();$('#session-modal').modal('show');var dataObject={'event':'timeout'};pushDataLayerForGoogleTag(dataObject)}}}
if(videoPlaying){clearTimeout(sessionTimer);$('#session-modal').modal("hide")}}});function pushDataLayerForGoogleTag(dataObject){dataLayer.push(dataObject)}
function callLogout(){if($(".logout-btn")[0]){var href=$(".logout-btn").attr('href');if(href!=undefined&&href!='undefined'){window.location.href=href}else{location.reload()}}else{var href=$(".signout-btn").attr('href');if(href!=undefined&&href!='undefined'){window.location.href=href}else{location.reload()}}}
var sessionModal=function(){if(!videoPlaying&&!videoPage){var currTime=new Date();var diff=(currTime.getMinutes()*60+currTime.getSeconds())-(nowTime.getMinutes()*60+nowTime.getSeconds());var diffMinutes=parseInt(diff/60);var diffSeconds=parseInt(diff%60);var timerVal;var newDiff=sessionTimeoutMin*60-diff;if(newDiff<=0){var dataObject={'event':'timeout_auto_logout'};pushDataLayerForGoogleTag(dataObject);callLogout()}else if(newDiff<60*counterTime){timerVal=newDiff}else{timerVal=60*counterTime}
if(timerVal){nowTime=currTime;display=$('#time');$(document).off('click',sessionTimeout);startTimer(timerVal,display);$('.modal').each(function(){if($(this).attr('id')!="session-modal"){$(this).modal('hide')}});hideProgress();if($('#session-modal').is(':hidden')){$('.modal-backdrop').remove();$('#session-modal').modal('show');var dataObject={'event':'timeout'};pushDataLayerForGoogleTag(dataObject)}}}}
function changeQueryVariable(key,replaceString,query){var vars=query.split("&");for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0].toLowerCase()==key.toLowerCase()){vars[i]=pair[0]+"="+replaceString}}
return vars.join("&")}
var interval;function startTimer(duration,display){if(!videoPlaying&&!videoPage){var timer=duration,minutes,seconds;var now,before;before=new Date();var minutesB;var minutesN;clearInterval(interval);interval=setInterval(function(){minutesB=before.getMinutes()*60+before.getSeconds();now=new Date();minutesN=now.getMinutes()*60+now.getSeconds();var diff=minutesN-minutesB;if(diff!=1){timer=timer-(diff-1)}
before=now;if(timer>0&&timer<=duration){minutes=parseInt(timer/60,10)
seconds=parseInt(timer%60,10);minutes=minutes<10?"0"+minutes:minutes;seconds=seconds<10?"0"+seconds:seconds;display.text(minutes+":"+seconds)}
if(timer>duration){timer=duration}
if(--timer<0){timer=duration;clearInterval(interval);$('#session-modal').modal('hide');$('.modal-backdrop').remove();clearTimeout(sessionTimer);var dataObject={'event':'timeout_auto_logout'};pushDataLayerForGoogleTag(dataObject);callLogout()}},1000)}}
function ValidateEmail(email){var expr=/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]*|[0-9]{1,3})(\]?)$/;return expr.test(email)}
function ValidatePassword(password){var expr=/^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])([a-zA-Z0-9!@#_!()$]+){8,20}$/;if(password.length>=8&&password.length<=20&&expr.test(password)){return password}}
$(document).ready(function(){$("#signup-password, #signup-confirm-password").on("keypress",function(e){return e.which!==32});if($('.toc-new-volume').length>1){$('.archive-toc-start').find('a.archive-toc-link,a.hide').each(function(){var newPageNumber=getNewPageNumber(this);var newHref=$(this).attr("data-href").split('pgno='+$(this).attr('id')).join('pgno='+newPageNumber);var oldId=$(this).attr("id");$(this).attr('data-href',newHref).attr("newid",newPageNumber);if($(this).hasClass('archive-toc-link')){$(this).parent().next().attr("id","sp-"+newPageNumber).text(newPageNumber)}})}
if($('li.special-features').length>1&&$('li.special-features:last').attr('data-vol')!=1){var totalVolumes=$('li.special-features:last').attr('data-vol');var volumeCount=[];if(!isNaN(parseInt(totalVolumes))){totalVolumes=parseInt(totalVolumes);for(var x=0;x<totalVolumes;x++){var currentVolumeCount=parseInt($('li.special-features[data-vol="'+(x+1)+'"]:last').attr('data-img'));volumeCount.push(currentVolumeCount)}
if(volumeCount.length>1){$('li.special-features.link-active:not([data-vol="1"])').each(function(){var volNum=parseInt($(this).attr('data-vol'));var imgNum=parseInt($(this).attr('data-img'));var totalPrevious=0;for(var i=0;i<volNum-1;i++){if(volumeCount.length>i&&volumeCount[i]){totalPrevious+=volumeCount[i]}}
var viewparam=$.urlParam('viewtype');if(viewparam){param='&viewtype='+viewparam}else{var viewtype=$('#archive-image-viewtype').val();if(viewtype){param='&viewtype='+$('#archive-image-viewtype').val()}else{param='&viewtype=double'}}
var imgParam="&pgno="+imgNum;var hrefLink=$(this).find('a').attr('href');hrefLink=hrefLink.split(imgParam).join("&pgno="+(imgNum+totalPrevious))+param;$(this).find('a').attr('href',hrefLink)})}}}
$(".modal-content .signin_close img,.modal-content .close_icon img").off("keydown keypress keyup").on("keypress",function(e){e.stopPropagation();e.stopImmediatePropagation();$(this).focus();if(e.keyCode==13){$(this).click()}});$(".modal-content .signin_close a, .modal-content .close_icon a").attr("tabindex",-1).attr("role","application")});function editprofileValidate($editprofileMandatory){var updatedMand=$editprofileMandatory.not(jQuery(".hide"));var errorList=[];updatedMand.each(function(i,v){var inputType=jQuery(v).prop("tagName");if(inputType=="INPUT"){inputType=jQuery(v).attr("type")}else if(inputType=="SELECT"){inputType="text"}
switch(inputType){case "checkbox":if(!jQuery(v).is(":checked"))
errorList.push(!0);break;case "text":if(!jQuery(v).val().trim().length)
errorList.push(!0);break;case "password":if(!jQuery(v).val().length)
errorList.push(!0);break;case "email":if(!jQuery(v).val().length)
errorList.push(!0);}});if(!errorList.length){$("#editProfileButton").removeClass("disabled-btn")}else{$("#editProfileButton").addClass("disabled-btn")}}
function signupValidate($signupMandatory){var updatedMand=$signupMandatory.not(jQuery(".hide"));var errorList=[];updatedMand.each(function(i,v){var inputType=jQuery(v).prop("tagName");if(inputType=="INPUT"){inputType=jQuery(v).attr("type")}else if(inputType=="SELECT"){inputType="text"}
switch(inputType){case "checkbox":if(!jQuery(v).is(":checked"))
errorList.push(!0);break;case "text":if(!jQuery(v).val().trim().length)
errorList.push(!0);break;case "password":if(!jQuery(v).val().length)
errorList.push(!0);break;case "email":if(!jQuery(v).val().length)
errorList.push(!0);}});if(!errorList.length&&grecaptcha.getResponse().length>0)
$("#signup-send-btn").removeClass("disabled-btn");else $("#signup-send-btn").addClass("disabled-btn")}
function CaptchaSuccess(){var $signupMandatory=$("#signup-first-name, #signup-email-addr, #signup-verify-email, #signup-password, #signup-confirm-password, #signup-checkbox2, #signup-other-txt-box, #signup-occupation-text-box");signupValidate($signupMandatory)}
function CaptchaExpire(){var $signupMandatory=$("#signup-first-name, #signup-email-addr, #signup-verify-email, #signup-password, #signup-confirm-password, #signup-checkbox2, #signup-other-txt-box, #signup-occupation-text-box");signupValidate($signupMandatory)}
function SignupSubmission(){var $email_addr=$('#signup-email-addr');var $verify_email_addr=$('#signup-verify-email');var $password=$('#signup-password');var $confirm_password=$('#signup-confirm-password');var entrdEmailAddrsNotMatch=$('#emailaddrsnotmatch').val();var invalidPasswordVal=$('#invalidpassword').val();var emailAddrsAlrdyExist=$('#emailaddrsalrdyexist').val();var entrdPassDosntMatch=$('#entrdpassdsntmatch').val();var f_email=$email_addr.val();var s_email=$verify_email_addr.val();var f_pwd=$password.val();var s_pwd=$confirm_password.val();$email_addr.css("border","solid #ccc 1px").siblings("span").addClass("hide");$verify_email_addr.css("border","solid #ccc 1px").siblings("span").addClass("hide");$password.css("border","solid #ccc 1px").siblings("span").addClass("hide");$confirm_password.css("border","solid #ccc 1px").siblings("span").addClass("hide");var isValid=!0;if(!ValidateEmail(f_email)){isValid=!1;$email_addr.css("border","solid red 1px").siblings("span").removeClass("hide").html("Invalid Email Address")}else{if(f_email!=s_email){isValid=!1;$verify_email_addr.css("border","solid red 1px").siblings("span").removeClass("hide").html(entrdEmailAddrsNotMatch)}}
if(!ValidatePassword(f_pwd)){isValid=!1;$password.css("border","solid red 1px").siblings("span").removeClass("hide").html(invalidPasswordVal)}else{if(f_pwd!=s_pwd){isValid=!1;$confirm_password.css("border","solid red 1px").siblings("span").removeClass("hide").html(entrdPassDosntMatch)}}
if(isValid){showProgress();$.ajax({type:"POST",url:'/app/sams',dataType:'text',data:{username:f_email},success:function(e){if(e=="-1"){$("#signup-form").submit()}else{hideProgress();$('#signup-email-addr').css("border","solid red 1px").siblings("span").removeClass("hide").html("Email address is already in use")}},error:function(error){}})}}
$(document).on('click',"#signup-send-btn",function(){if(!$(this).hasClass('disabled-btn')){$.cookie('signupbtnflag','true');SignupSubmission()}});function socialSignupValidate($socialSignupMandatory){var updatedMand=$socialSignupMandatory.not(jQuery(".hide"));var errorList=[];updatedMand.each(function(i,v){if(($(v).attr('id')=='sn-signup-verify-email'&&$(v).is(':visible'))||$(v).attr('id')!='sn-signup-verify-email'){var inputType=jQuery(v).prop("tagName");if(inputType=="INPUT"){inputType=jQuery(v).attr("type")}else if(inputType=="SELECT"){inputType="text"}
switch(inputType){case "checkbox":if(!jQuery(v).is(":checked"))
errorList.push(!0);break;case "text":if(!jQuery(v).val().trim().length)
errorList.push(!0);break;case "email":if(!jQuery(v).val().length)
errorList.push(!0);}}});if(!errorList.length)
$("#sn-signup-send-btn").removeClass("disabled-btn");else $("#sn-signup-send-btn").addClass("disabled-btn")}
$(document).on('click',"#sn-signup-send-btn",function(){if(!$(this).hasClass('disabled-btn')){$.cookie('signupbtnflag','true');SocialSignUpSubmission()}});function validate($mandatory){var updatedMand=$mandatory.not(jQuery(".hide"));var errorList=[];updatedMand.each(function(i,v){var inputType=jQuery(v).prop("tagName");if(inputType=="INPUT"){inputType=jQuery(v).attr("type")}else if(inputType=="SELECT"){inputType="text"}
switch(inputType){case "checkbox":if(!jQuery(v).is(":checked"))
errorList.push(!0);break;case "text":if(!jQuery(v).val().trim().length)
errorList.push(!0);break;case "email":if(!jQuery(v).val().trim().length)
errorList.push(!0);}});if(!errorList.length)
$("#send-btn").removeClass("disabled-btn").addClass("success-btn").removeAttr("aria-disabled");else $("#send-btn").addClass("disabled-btn").removeClass("success-btn").attr("aria-disabled","true")}
function shareValidate($shareMandatory){var updatedMand=$shareMandatory;var errorList=[];updatedMand.each(function(i,v){var inputType=jQuery(v).prop("tagName");inputType=jQuery(v).attr("type");if(!jQuery(v).val().length)
errorList.push(!0);});try{if(!errorList.length&&(grecaptcha.getResponse().length>0))
$("#share-btn").removeClass("disabled-btn").addClass("share-success");else $("#share-btn").addClass("disabled-btn").removeClass("share-success")}catch(e){$("#share-btn").removeClass("disabled-btn").addClass("share-success")}}
function googleTranslateElementInit(){new google.translate.TranslateElement({layout:google.translate.TranslateElement.InlineLayout.HORIZONTAL},'google_translate_element')}(function($){$.fn.characterCounter=function(opts){var defaults={exceeded:!1,counterSelector:!1,limit:500,renderTotal:!1,counterFormat:'%1',counterExceededCssClass:'exceeded',increaseCounting:!1,onExceed:function(count){},onDeceed:function(count){},customFields:{}};var options=$.extend(defaults,opts);return this.each(function(){var html5len=$(this).attr('maxlength');if(typeof html5len!==typeof undefined&&html5len!==!1){$.extend(defaults,{limit:parseInt($(this).attr('maxlength'))})}
if(!options.counterSelector){$(this).after(generateCounter())}
bindEvents(this);checkCount(this)});function customFields(params){var i,html='';for(i in params){html+=' '+i+'="'+params[i]+'"'}
return html}
function renderText(count){var rendered_count=options.counterFormat.replace(/%1/,count);if(options.renderTotal){rendered_count+='/'+options.limit}
return rendered_count}
function checkCount(element){var characterCount=$(element).val().replace(/(\r\n|\n|\r)/g,"  ").length;var counter=options.counterSelector?$(options.counterSelector):$(element).nextAll("."+options.counterCssClass).first();var remaining=options.limit-characterCount;var condition=remaining<0;if(options.increaseCounting){remaining=characterCount;condition=remaining>options.limit}
if(condition){counter.addClass(options.counterExceededCssClass);options.exceeded=!0;options.onExceed(characterCount)}else{if(options.exceeded){counter.removeClass(options.counterExceededCssClass);options.onDeceed(characterCount);options.exceeded=!1}}
counter.html(renderText(remaining))}
function bindEvents(element){$(element).on("input change",function(){checkCount(element)})}}})(jQuery);function updatedTwitterUrlTitle(){if($('.twitter-share').length>0){var title=$("#title").length>0?$.trim($("#title").find('h2').text()):'';if(title.length==0){title=$('#title').length>0?$.trim($("#title").text()):''}
if(title.length==0){title=$('#detail-title').length>0?$.trim($("#detail-title").text()):''}
var twitterurl=$('.share_icons .twitter-share').attr('href');var url=twitterurl.split('?')[0]+'?'+changeQueryVariable('text',title,twitterurl.split('?')[1]);$('.share_icons .twitter-share').attr('href',url)}}
function getGeolocationData(response){var responseObj=typeof response==="string"?$.parseJSON(response):response;if($.cookie('ipCheck')!='true'){$.cookie('ipCheck','true');$.cookie('ClientIp',responseObj.geoplugin_request);$.cookie('ClientLocation',responseObj.geoplugin_countryName);$.cookie('ClientLocationCode',responseObj.geoplugin_countryCode)}
$.ajax({type:"GET",url:'/set-location?location='+responseObj.geoplugin_countryCode+'&ip='+responseObj.geoplugin_request,success:function(response){if(~navigator.userAgent.indexOf("Firefox")){setTimeout(function(){location.reload()},2000)}else{location.reload()}},error:function(error){console.log(error);location.reload()}})}
function truncateText(){var textContainerHeight=$('.text-truncation-outer').height();$('.text-truncation').each(function(){var $ellipsisText=$(this);$ellipsisText.parents('a').attr('title',$(this).text().trim());textContainerHeight=$ellipsisText.parents('.text-truncation-outer').height();while($ellipsisText.outerHeight(!0)>textContainerHeight){$ellipsisText.html(function(index,text){return text.replace(/\s*\s(\S)*$/,'...')})}})}
function viewmoreLink(){$('.toc_box li, .toc_box b').each(function(index){if(index>5){$(this).hide();$(this).find('div, span').hide()}})}
function accordianaction(accordion){var collapsetext=$('#collapseallsec').val();var expandtext=$('#expandallsec').val();var isexpanded=!1;$(accordion).each(function(){if($(this).hasClass('in')){isexpanded=!0}});if(isexpanded){$('#accordion-panel').children('span').text(collapsetext)}else{$('#accordion-panel').children('span').text(expandtext)}}
if(document.cookie.split("AccountId=").length>1&&document.cookie.split("AccountId=")[1]){var customerId=document.cookie.split("AccountId=")[1].split(";")[0];customerId=~customerId.indexOf(",")?customerId.split(",").join(""):customerId;customerId=customerId?customerId:"UNKNOWN_CUSTOMER";if(customerId!=0&&!$(document).find('meta[name="ST.customerId"]')[0]){$('head').append('<meta name="ST.customerId" content="'+customerId+'">')}else if(!$(document).find('meta[name="ST.customerId"]')[0]){$('head').append('<meta name="ST.customerId" content="UNKNOWN_CUSTOMER">')}}else{$('head').append('<meta name="ST.customerId" content="UNKNOWN_CUSTOMER">')}
$(document).ready(function(){$('.nav li a').addClass('no-focus');var currUrl=window.location.href;if(!~currUrl.indexOf('/search-results')){filterViewmore()}
updatedTwitterUrlTitle();$(".date_input input[type=number]").on('change',function(){var tisVal=$(this).val();$(this).attr('aria-label',tisVal).focus()});$(".positive-integer").numeric({decimal:!1,negative:!1});$(".all-integer").numeric({decimal:!1,negative:!0});$("#verify-email-addr-err").on('blur',function(){if($("#verify-email-addr").hasClass('error-address')){$("#send-btn").focus()}});var userLoggedIn=$.cookie('LoggedInFlag');var userSignedIn=$.cookie('SignedInFlag');if((userLoggedIn=='true'&&$(".logout-btn")[0])||userSignedIn=='true'){if(!videoPage&&!videoPlaying){nowTime=new Date();$(document).on('click',sessionTimeout);sessionTimer=setTimeout(sessionModal,timeoutValue)}}
if(window.location.hash){var hashValue=window.location.hash;window.location.hash="";window.location.hash=hashValue}
var reloadFlag=$.cookie('ReloadedFlag');if(userLoggedIn=='true'&&$('#checkForLogout').is(':visible')&&reloadFlag!='true'){$.cookie('ReloadedFlag','true');location.reload(!0)}else if(userLoggedIn=='false'&&$('#checkForLogin').is(':visible')&&reloadFlag!='true'){$.cookie('ReloadedFlag','true');location.reload(!0)}else{if($('#userLoggedInFlag').length>0){$.cookie('LoggedInFlag','true')}else{$.cookie('LoggedInFlag','false')}
$.cookie('ReloadedFlag','false')}
ajaxTimer=setTimeout(pingFunction,ajaxTimeout);$(document).ajaxStart(function(e){clearTimeout(ajaxTimer);ajaxTimer=setTimeout(pingFunction,ajaxTimeout)});if($.cookie('AccountId')){var customerId=$.cookie('AccountId');customerId=~customerId.indexOf(",")?customerId.split(",").join(""):customerId;$.cookie('AccountId',customerId);customerId=customerId?customerId:"UNKNOWN_CUSTOMER";if(customerId!=0&&!$(document).find('meta[name="ST.customerId"]')[0]){$('head').append('<meta name="ST.customerId" content="'+customerId+'">')}else if(!$(document).find('meta[name="ST.customerId"]')[0]){$('head').append('<meta name="ST.customerId" content="UNKNOWN_CUSTOMER">')}}else{$('head').append('<meta name="ST.customerId" content="UNKNOWN_CUSTOMER">')}
$(".close-menu").click(function(){$("#navbar-collapse-1").removeClass("in").attr("aria-expanded","false")});$(document).on("contextmenu",".disable-right",function(e){return!1});$('.image_right').find('img').on('load',function(e){$(this).parent().find('.image_caption').css('width',$(this).width())});$('#back-to-top').click(function(){$('#back-to-top').addClass('colorChanged');setTimeout(function(){$('#back-to-top').removeClass('colorChanged')},1000)});$("#editfoldername").keyup(function(event){if($(this).val()==""){$("#editfolder").addClass("disabled-btn")}else{$("#editfolder").removeClass("disabled-btn")}});$("html").click(function(e){if(!$(e.target).hasClass("signin-form")){$(".signin_dropdown form input").val("")}});function starIconUpdate(flag){$('.icon-click').each(function(){var dataClass=$(this).find('#img-icon').attr('data-classname');if(flag=='hide'){$(this).find('#img-icon').removeClass(dataClass)}else{$(this).find('#img-icon').addClass(dataClass)}})}
if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){$('.vir_keyboard').hide()}
function checkUserAgentForAccordion(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){var showDetails=$('#search-showdetails').val();if($(window).width()>=991){$(".search").removeClass("hide")}else{$('#searchres-hidedet').text(showDetails);$('.cusAccordMob .panel-collapse').removeClass('in');$('.cusAccordMob .accordion-toggle').addClass('collapsed');$('.cusAccordMob .accordion-toggle').attr('aria-expanded','false');$('.cusAccordMob .accordion-toggle > .glyphicon').removeClass("glyphicon-minus").addClass("glyphicon-plus");starIconUpdate('hide')}}}
checkUserAgentForAccordion();$(".mob-search").click(function(){if($(".search").is(":visible"))
$(".search").css('display','');else $(".search").show()});$(".caption_overlay_title").each(function(){if($(this).text().length>20){var truncatedTxt=$(this).text().substring(0,20)+"...";$(this).text(truncatedTxt)}});$(".caption_overlay_content").each(function(){if($(this).text().length>100){var truncatedTxt=$(this).text().substring(0,100)+"...";$(this).text(truncatedTxt)}});$(".desc-section h1").each(function(){if($(this).text().length>50){var truncatedTxt=$(this).text().substring(0,50)+"...";$(this).text(truncatedTxt)}});$(".desc-section p").each(function(){var count=220;if($(this).parent().attr('count')){count=$(this).parent().attr('count')}
if($(this).text().length>220){var truncatedTxt=$(this).text().substring(0,count)+"...";$(this).text(truncatedTxt)}});if($('.filtered_list').length>0){var filtercount=$('.filtered_list ul').children().length;if(filtercount==0){$('#clear_all').addClass('hide')}else if(filtercount==1){const firstChildText=$('.filtered_list ul').children().first().text().split(':')[0].trim();firstChildText=="Search term"?$('#clear_all').addClass('hide'):$('#clear_all').removeClass('hide')}else{$('.filtered_list ul').children().each(function(index){const text=$(this).text().split(':')[0].trim();if(text!="Search term"){$('#clear_all').removeClass('hide')}})}}
if($('.building_galley').length>0){InitBuildingImageViewerDetails()}else{InitArchiveImageViewerDetails()}
$("#title-option").on('change',function(){if($(this).val().toLowerCase()=='other'){$("#other-txt-box").removeClass("hide");$("#contact-other-title").removeClass("hide")}else{$("#other-txt-box").addClass("hide").val("");$("#contact-other-title").addClass("hide")}});var maxchars=500;$('#share-text-area, #addfolder-txt-area, #editfolder-txt-area').on('keyup change',function(e){var textLength=$(this).val().length;$(this).val($(this).val().substring(0,maxchars));var textLength=$(this).val().length;remain=maxchars-parseInt(textLength);if($('#share-char-count').length>=0){$('#share-char-count').text(remain)}
if($('#mylib-addfolder-char').length>=0){$('#mylib-addfolder-char').text(remain)}
if($('#mylib-editfolder-char').length>=0){$('#mylib-editfolder-char').text(remain)}
var maxlength=500;$("#messageBoxFull").empty();if($(this).val().length>=maxlength){$("#messageBoxFull").append("<span class='err-msg'>You have exceeded the character limit of "+maxlength+" characters</span>")}});$('#share-text-area, #addfolder-txt-area, #editfolder-txt-area').on('keydown',function(e){if($(this).val().length>=500){var key=e.keyCode;var isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if(!isSafari){if(((key>=65&&key<=90)||(key>=48&&key<=57)||(key>=96&&key<=111)||(key>=186&&key<=191))&&(!e.ctrlKey)){e.preventDefault()}}else{if(((key>=65&&key<=90)||(key>=48&&key<=57)||(key>=96&&key<=111)||(key>=186&&key<=191))&&(!e.metaKey)){e.preventDefault()}}}});var maxchars=1000;$('#msg-text-area').on('keyup change',function(e){var textLength=$(this).val().length;$(this).val($(this).val().substring(0,maxchars));var textLength=$(this).val().length;remain=maxchars-parseInt(textLength);if($('#contact-char-count').length>=0){$('#contact-char-count').text(remain+" characters remaining")}
var maxlength=1000;$("#messageBoxFull").empty();if($(this).val().length>=maxlength){$("#messageBoxFull").append("<span class='err-msg'>You have exceeded the character limit of "+maxlength+" characters</span>")}});$('#msg-text-area').on('keydown',function(e){if($(this).val().length>=1000){var key=e.keyCode;var isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if(!isSafari){if(((key>=65&&key<=90)||(key>=48&&key<=57)||(key>=96&&key<=111)||(key>=186&&key<=191))&&(!e.ctrlKey)){e.preventDefault()}}else{if(((key>=65&&key<=90)||(key>=48&&key<=57)||(key>=96&&key<=111)||(key>=186&&key<=191))&&(!e.metaKey)){e.preventDefault()}}}});$(".view-more").click(function(){$(this).hide();$(".article-block").removeClass("hide")});$(".widget-layer").parentsUntil(".container").removeAttr("class","");var width=$(window).width();if($("#back-to-top").length){var scrollTrigger=400,backToTop=function(){var scrollTop=$(window).scrollTop();if(scrollTop>scrollTrigger){$("#back-to-top").css("display","block")}else{$("#back-to-top").css("display","none")}};backToTop();$(window).on("scroll",function(){backToTop()});$("#back-to-top").on("click",function(e){e.preventDefault();$("html,body").animate({scrollTop:0},700)})}
bindCollapseEvents();function bindCollapseEvents(){$('.search_right').find(".collapse").on("shown.bs.collapse",function(){var currentTitle=$(this).parent().find(".glyphicon-plus").attr("title");$(this).parent().find(".glyphicon-plus").removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title',currentTitle.replace("Collapse","Expand"));$(this).parent().find(".icon-folder").addClass("icon-active");var dataClass=$(this).parent().find('#img-icon').attr('data-classname');$(this).parent().find('#img-icon').addClass(dataClass);searchaccordianaction()}).on("hidden.bs.collapse",function(){var currentTitle=$(this).parent().find(".glyphicon-minus").attr("title");$(this).parent().find(".glyphicon-minus").removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title',currentTitle.replace("Expand","Collapse"));$(this).parent().find(".icon-folder").removeClass("icon-active");var dataClass=$(this).parent().find('#img-icon').attr('data-classname');$(this).parent().find('#img-icon').removeClass(dataClass);searchaccordianaction()})}
taxCollapseEvents();function taxCollapseEvents(){if($('.taxonomy').length>0){$('.taxonomy').find(".parent-toggle-icon").on("click",function(e){if($(this).hasClass('glyphicon-minus')){e.stopPropagation();$(this).removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title','Collapse');$(this).parents(".panel-heading").next().removeClass('in').attr('aria-expanded','false');$(this).parents(".panel-heading").find('.accordion-toggle').attr('title','Collapse');accordianaction($('.panel-collapse'))}else{e.stopPropagation();$(this).removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title','Expand');$(this).parents(".panel-heading").next().addClass('in').removeAttr('aria-expanded').css('height','auto');$(this).parents(".panel-heading").find('.accordion-toggle').attr('title','Expand');accordianaction($('.panel-collapse'))}});$('.taxonomy').find(".child-toggle-icon").on("click",function(e){if($(this).hasClass('glyphicon-minus')){e.stopPropagation();$(this).removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title','Collapse');$(this).parents(".panel-heading").next().removeClass('in').attr('aria-expanded','false');$(this).parents(".panel-heading").find('.accordion-toggle').attr('title','Collapse')}else{e.stopPropagation();$(this).removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title','Expand');$(this).parents(".panel-heading").next().addClass('in').removeAttr('aria-expanded').css('height','auto');$(this).parents(".panel-heading").find('.accordion-toggle').attr('title','Expand')}})}}
$('.static_template').find('img').addClass('img-responsive');artCollapseEvents();function artCollapseEvents(){$('.article_right').find(".collapse").on("shown.bs.collapse",function(e){if($('.panel-collapse').hasClass('parent-accordion')){e.stopPropagation();$(this).prev().find(".glyphicon-plus").removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title','Expand');accordianaction($('.parent-accordion'))}else{$(this).parent().find(".glyphicon-plus").removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title','Expand');accordianaction($('.panel-collapse'))}
truncateAltAuth()}).on("hidden.bs.collapse",function(e){if($('.panel-collapse').hasClass('parent-accordion')){e.stopPropagation();$(this).prev().find(".glyphicon-minus").removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title','Collapse');accordianaction($('.parent-accordion'))}else{$(this).parent().find(".glyphicon-minus").removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title','Collapse');accordianaction($('.panel-collapse'))}})}
mylibCollapseEvents();function mylibCollapseEvents(){$('.my-library').find(".collapse").on("shown.bs.collapse",function(e){e.stopPropagation();$(this).parent().children().eq(0).find(".glyphicon-plus").removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title','Expand')}).on("hidden.bs.collapse",function(e){e.stopPropagation();$(this).parent().children().eq(0).find(".glyphicon-minus").removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title','Collapse')})}
$('#accordion-panel').off().on('keypress click',function(e){if(e.type==="click"||e.keyCode===13){var title=$(this).children('span').text();var collapsetext=$('#collapseallsec').val();var expandtext=$('#expandallsec').val();if($('.taxonomy_alphabets').length>0){$(".taxonomy_alphabets li a").parent().children().removeClass("active")}
if(title==collapsetext){$('.accordion-toggle').addClass('collapsed').attr('aria-expanded','false');$('.panel-collapse:not(.child-panel)').removeClass('in').attr('aria-expanded','false');$(this).children('span').text(expandtext);$('.glyphicon:not(.child-toggle-icon)').removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title','Collapse')}else{$('.accordion-toggle').removeClass('collapsed').removeAttr('aria-expanded');$('.panel-collapse:not(.child-panel)').addClass('in').removeAttr('aria-expanded').css('height','auto');if($('#accordion0').hasClass('hide')){$('#collapseZero').removeClass('in').attr('aria-expanded','false')}
$(this).children('span').text(collapsetext);$('.glyphicon:not(.child-toggle-icon').removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title','Expand')}}});var $cusAccordMob=$('.cusAccordMob');$('#expand-search-panel').on('keypress click',function(e){if(e.type==="click"||e.keyCode===13){var title=$(this).find('span').text();var hideDetails=$('#search-hidedetails').val();var showDetails=$('#search-showdetails').val();if(title==hideDetails){$cusAccordMob.find('.accordion-toggle').addClass('collapsed').attr('aria-expanded','false');$cusAccordMob.find('.panel-collapse').removeClass('in').attr('aria-expanded','false');$(this).find('span').text(showDetails).attr("aria-label","Show Details");$cusAccordMob.find('.glyphicon').removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title','Collapse');starIconUpdate('hide')}else{$cusAccordMob.find('.accordion-toggle').removeClass('collapsed').removeAttr('aria-expanded');$cusAccordMob.find('.panel-collapse').addClass('in').removeAttr('aria-expanded').css('height','auto');$(this).find('span').text(hideDetails).attr("aria-label","Hide Details");$cusAccordMob.find('.glyphicon').removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title','Expand');starIconUpdate('show')}}});$cusAccordMob.find(".collapse").on("shown.bs.collapse",function(){$(this).parent().find(".glyphicon-plus").removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title','Expand');$(this).parent().find(".icon-folder").addClass("icon-active");searchaccordianaction()}).on("hidden.bs.collapse",function(){$(this).parent().find(".glyphicon-minus").removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title','Collapse');$(this).parent().find(".icon-folder").removeClass("icon-active");searchaccordianaction()});var $refine_section=$('.refine-section');$('#filter-hide-all-btn').off('click').on('click',function(){var title=$(this).text();var hideAll=$('#filter-hideall').val();var showAll=$('#filter-showall').val();if(title==hideAll){$refine_section.find('.accordion-toggle').addClass('collapsed').attr('aria-expanded','false');$refine_section.find('.panel-collapse').removeClass('in').attr('aria-expanded','false');$(this).text(showAll).attr("aria-label","Show All");$refine_section.find('.glyphicon').each(function(){var currentTitle=$(this).attr("title");$(this).removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title',currentTitle.replace("Expand","Collapse"))})}else{$refine_section.find('.accordion-toggle').removeClass('collapsed').removeAttr('aria-expanded');$refine_section.find('.panel-collapse').addClass('in').removeAttr('aria-expanded').css('height','auto');$(this).text(hideAll).attr("aria-label","Hide All");$refine_section.find('.glyphicon').each(function(){var currentTitle=$(this).attr("title");$(this).removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title',currentTitle.replace("Collapse","Expand"))})}});$refine_section.find(".panel-title span").click(function(e){if($(this).hasClass('glyphicon-minus')){e.stopPropagation();$(this).removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title',$(this).attr('title').replace("Expand","Collapse"));$(this).parents(".panel-heading").next().removeClass('in').attr('aria-expanded','false');$(this).parents(".panel-heading").find('.accordion-toggle').attr('title','Collapse');$(this).parents(".panel-heading").next().find('.panel-collapse').removeClass('in').attr('aria-expanded','false');$(this).parents(".panel-heading").next().find('.glyphicon').each(function(){var nextTitle=$(this).attr("title");$(this).removeClass("glyphicon-minus").addClass("glyphicon-plus").attr('title',nextTitle.replace("Collapse","Expand"))});searchfilteraccordianaction()}else{e.stopPropagation();$(this).removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title',$(this).attr('title').replace("Collapse","Expand"));$(this).parents(".panel-heading").next().addClass('in').removeAttr('aria-expanded').css('height','auto');$(this).parents(".panel-heading").find('.accordion-toggle').attr('title','Expand');$(this).parents(".panel-heading").next().find('.panel-collapse').addClass('in').removeAttr('aria-expanded').css('height','auto');$(this).parents(".panel-heading").next().find('.glyphicon').each(function(){var nextTitle=$(this).attr("title");$(this).removeClass("glyphicon-plus").addClass("glyphicon-minus").attr('title',nextTitle.replace("Expand","Collapse"))});searchfilteraccordianaction()}});function searchaccordianaction(){var isexpanded=!1;var hideDetails=$('#search-hidedetails').val();var showDetails=$('#search-showdetails').val();$cusAccordMob.find('.panel-collapse').each(function(){if($(this).hasClass('in')){isexpanded=!0}});if(isexpanded){$('#expand-search-panel').find('span').text(hideDetails)}else{$('#expand-search-panel').find('span').text(showDetails)}}
function searchfilteraccordianaction(){var isexpanded=!1;var hideAll=$('#filter-hideall').val();var showAll=$('#filter-showall').val();$refine_section.find('.panel-collapse').each(function(){if($(this).hasClass('in')){isexpanded=!0}});if(isexpanded){$('#filter-hide-all-btn').text(hideAll)}else{$('#filter-hide-all-btn').text(showAll)}}
var currUrl=window.location.href;if(!~currUrl.indexOf('/search-results')){$('.refine-section .search_left_accordian').find('#flt_viewmore').click(function(){var moreText=$('#more-text').val();var lessText=$('#less-text').val();var element=$(this).parent().parent().find('ul .panel-heading, li');if($(this).text()==moreText){element.show();if(element.hasClass('panel-heading')){element.next().css('display','')}
$(this).text(lessText)}else{$(this).text(moreText);element.each(function(index){if(index>4){$(this).hide();if($(this).hasClass('panel-heading')){$(this).next().hide()}}});$("body").scrollTop(element.offset().top)}})}
function filterViewmore(){$('.refine-section .search_left_accordian, .character-filter-group .character-filter').each(function(){if(!$(this).hasClass('character-filter-group')){var moreText=$('#more-text').val();if($(this).find('ul .panel-heading, li').length>5){if($(this).hasClass('character-filter')){$(this).find('ul').append('<div><a href="javascript:;" id="flt_viewmore">'+moreText+'</a></div>')}else{$(this).find('.panel-default').find('.panel-collapse').first().append('<div><a href="javascript:;" id="flt_viewmore">'+moreText+'</a></div>')}
$(this).find('ul .panel-heading, li').each(function(index){if(index>4){$(this).hide();if($(this).hasClass('panel-heading')){$(this).next().hide()}}})}}})}
$('.advanced_keyboard').find('#vkbd').on("keyup",function(e){if(event.keyCode==13){$(this).trigger('click')}});$(".help_img").popover({html:!0,placement:'bottom',trigger:'manual',content:function(){return $(this).next().html()}}).on("keyup click",function(e){if(e.keyCode==13){$('this').trigger('click')}else if(e.type=="click"){e.stopPropagation();$(this).popover('toggle')}});$('html').click(function(e){$('.help_img').popover('hide');if(!$(e.target).hasClass('popover-content')){$('.popper').popover('hide')}});$('html').click(function(e){$('.help_img').popover('hide');if(!$(e.target).hasClass('popover-content')){$('.article-popper').popover('hide')}});$(document).on('click','.popover-content ul',function(e){$('.help_img').trigger('click')})
$(document).on('keyup click','#close-popover-signup',function(e){if(e.keyCode==13||e.type=="click"){$('.help_img').popover('hide')}});$('.signin_dropdown').find('#signin_close').on("keyup",function(e){if(event.keyCode==13){$(this).trigger('click')}});$('html').click(function(e){$('.help_img').popover('hide')});$(document).on('click','.popover-content ul',function(e){$('.help_img').trigger('click')})
$(document).on('keyup click','#close-popover-signup',function(e){if(e.keyCode==13||e.type=="click"){$('.help_img').popover('hide')}});$('.signin_dropdown').find('#signin_close').on("keyup",function(e){if(event.keyCode==13){$(this).trigger('click')}});$('.modal').on('show.bs.modal',function(e){document.querySelector('meta[name="viewport"]').content='width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1.0'});$("#signup-title-option").on('change',function(){if($(this).val().toLowerCase()=='other'){$("#signup-other-txt-box").removeClass("hide");$("#signup-other-title").removeClass("hide")}else{$("#signup-other-txt-box").addClass("hide").val("");$("#signup-other-title").addClass("hide")}});$("#signup-occupation-select").on('change',function(){if($(this).val().toLowerCase()=='other'){$("#signup-occupation-text-box").removeClass("hide");$("#signup-other-occupation").removeClass("hide")}else{$("#signup-occupation-text-box").addClass("hide").val("");$("#signup-other-occupation").addClass("hide")}});$("#sn-signup-title-option").on('change',function(){if($(this).val().toLowerCase()=='other'){$("#sn-signup-other-txt-box").removeClass("hide")}else{$("#sn-signup-other-txt-box").addClass("hide").val("")}});$("#sn-signup-occupation-select").on('change',function(){if($(this).val().toLowerCase()=='other'){$("#sn-signup-occupation-text-box").removeClass("hide")}else{$("#sn-signup-occupation-text-box").addClass("hide").val("")}});var $mandatory=$("#first-name, #email-addr, #verify-email-addr, #enquiry, #checkbox2, #other-txt-box");$mandatory.on("change keyup",function(){validate($mandatory)});var $signupMandatory=$("#signup-first-name, #signup-email-addr, #signup-verify-email, #signup-password, #signup-confirm-password, #signup-checkbox2, #signup-other-txt-box, #signup-occupation-text-box");$signupMandatory.on("change keyup",function(){signupValidate($signupMandatory)});var $socialSignupMandatory=$("#sn-signup-first-name, #sn-signup-email-addr, #sn-signup-verify-email, #sn-signup-checkbox2, #sn-signup-other-txt-box, #sn-signup-occupation-text-box");$socialSignupMandatory.on("change keyup",function(){socialSignupValidate($socialSignupMandatory)});var $shareMandatory=$("#to-name, #to-email, #your-name, #your-email, #subject");$shareMandatory.on("change keyup",function(){shareValidate($shareMandatory)});var $editprofileMandatory=$("#edit-first-name,#edit-email-addr,#edit-verify-email");$editprofileMandatory.on('change keyup',function(){$("#edit-email-addr").css("border","solid #ccc 1px").siblings("span").addClass("hide");$("#edit-verify-email").css("border","solid #ccc 1px").siblings("span").addClass("hide");editprofileValidate($editprofileMandatory)});$(".refine-results").click(function(){$(this).hide();$(".refine-section").removeClass("hidden-sm").removeClass("hidden-xs")});$(".refine-close").click(function(){if($(this).hasClass('refine-museum-close')){$(".refine-museum-results").show();$(".museum-refine").addClass("hidden-sm").addClass("hidden-xs")}else{$(".refine-results").show();$(".refine-section").addClass("hidden-sm").addClass("hidden-xs")}});$(".filtered").on('click',function(){var element=$(this);if(!element.hasClass("filteredItem")){element.addClass("filteredItem");$("#content").append('<li><span>'+element.html()+'</span><a title="Close" aria-hidden="true" href="javascript:void(0);"><img onclick="close_action(this)" src="/bloomsbury_assets/bloomsbury/images/signin_close.png" tabindex="0" role="button" aria-label="close"  alt="Close" class="close-btn"/></a></li>')}});var pagenumber=0;var $datesection=$('.date-section');$datesection.find('.selectpicker').on('change',function(){if($(this).attr("id")!="selectpick"){$(".pagenumber-search").removeClass('error_msg');var sort='';var field='';sort=$(this).find('option:selected').attr('label')?'&sort='+$(this).find('option:selected').attr('label'):'';field=$(this).selectpicker('val')?'&field='+$(this).selectpicker('val'):'';var currentPage=$(this).attr('data-page');var sortType=$(this).attr('data-sort');var fieldType=$(this).attr('data-field');var url=window.location.href;if(fieldType){$.cookie("sendCounter","off");window.location.href=url.replace('&page='+currentPage,'&page=0').replace('&sort='+sortType,sort).replace('&field='+fieldType,field)}else{if(field){$.cookie("sendCounter","off");window.location.href=url.replace('&page='+currentPage,'&page=0')+sort+field}}}});$('.fa-angle-right').on('keypress click',function(e){if(e.type==="click"||e.keyCode===13){var fromData=$(this).parent().parent().attr('data-from');var pageNum=$(this).parent().parent().attr('data-page');var url=window.location.href;$.cookie("sendCounter","off");if(url.indexOf('&page=')>-1){window.location.href=url.replace('&page='+pageNum,'&page='+(parseInt(pageNum)+1))}else{window.location.href=url+'&page='+(parseInt(pageNum)+1)}}});$('.fa-angle-left').on('keypress click',function(e){if(e.type==="click"||e.keyCode===13){var fromData=$(this).parent().parent().attr('data-from');var pageNum=$(this).parent().parent().attr('data-page');var url=window.location.href;$.cookie("sendCounter","off");if(url.indexOf('&page=')>-1){window.location.href=url.replace('&page='+pageNum,'&page='+(parseInt(pageNum)-1))}else{window.location.href=url+'&page='+(parseInt(pageNum)-1)}}});$('.fa-angle-double-right').on('keypress click',function(e){if(e.type==="click"||e.keyCode===13){var pageNum=$(this).parent().parent().attr('data-page');var totalPage=$(this).parent().parent().attr('data-total');var url=window.location.href;$.cookie("sendCounter","off");if(url.indexOf('&page=')>-1){window.location.href=url.replace('&page='+pageNum,'&page='+totalPage)}else{window.location.href=url+'&page='+totalPage}}});$('.fa-angle-double-left').on('keypress click',function(e){if(e.type==="click"||e.keyCode===13){var pageNum=$(this).parent().parent().attr('data-page');var url=window.location.href;$.cookie("sendCounter","off");if(url.indexOf('&page=')>-1){window.location.href=url.replace('&page='+pageNum,'&page=0')}else{window.location.href=url+'&page=0'}}});$(".pagenumber-search").on('keyup',function(e){$(this).removeClass('error_msg');var keycode=(e.keyCode?e.keyCode:e.which);if(keycode=='13'){var totalPages=$(this).parent().parent().attr('data-total');var goToPage=$(this).val();var pageNum=$(this).parent().parent().attr('data-page');var url=window.location.href;if(!isNaN(parseInt(goToPage))&&goToPage!="0"&&parseInt(goToPage)<=parseInt(totalPages)+1&&parseInt(goToPage)-1!=parseInt(pageNum)){$.cookie("sendCounter","off");if(url.indexOf('&page=')>-1){window.location.href=url.replace('&page='+pageNum,'&page='+(parseInt(goToPage)-1))}else{window.location.href=url+'&page='+(parseInt(goToPage)-1)}}else if(parseInt(goToPage)-1==parseInt(pageNum)){}else{$(this).addClass('error_msg')}}});$(".load-more-images").on('click',function(e){var pagesize=$(this).attr('data-size');var url=window.location.href;$.cookie("sendCounter","off");if(url.indexOf('&size=')>-1){window.location.href=url.replace('&size='+pagesize,'&size='+(parseInt(pagesize)+30))}else{window.location.href=url+'&size='+(parseInt(pagesize)+30)}});$('.result-per-page').find('.selectpicker').on('change',function(){$(".pagenumber-search").removeClass('error_msg');var size=$(this).selectpicker('val');var pageSize=$(this).attr('data-size');var currentPage=$(this).attr('data-page');var url=window.location.href;$.cookie("sendCounter","off");if(url.indexOf('&size=')>-1){window.location.href=url.replace('&page='+currentPage,'&page=0').replace('&size='+pageSize,'&size='+size)}else{window.location.href=url.replace('&page='+currentPage,'&page=0')+'&size='+size}});$('body').on('click','.nav-tabs > li',function(e){$('#citation-modal').find('.primary_btn').val($("#copytocliptxt").val()).removeAttr('disabled');document.getSelection().removeAllRanges()});$("#citation-modal .responsive-tabs a").on('click',function(){$('.citation_modal').find('.tab-content').scrollTop(0)});$('.toolbar').find('#citation-btn').on('click',function(){if(!$(this).parent().hasClass('inactive')){var citation_modal=$('#citation-modal');citation_modal.find('li').removeClass('active');citation_modal.find('.citation').children('li:first').addClass('active');citation_modal.find('.responsive-tabs').children('li:first').addClass('active');citation_modal.find('.tab-content').children().removeClass('active');citation_modal.find('.tab-content').children('div:first').addClass('active');$(this).attr('data-target','#citation-modal');citation_modal.find('.primary_btn').val($("#copytocliptxt").val()).removeAttr('disabled');document.getSelection().removeAllRanges();$($(this).data("target")).show()}});var clipboard=new Clipboard('.primary_btn');clipboard.on('success',function(e){if(window.clipboardData!==undefined&&window.clipboardData!==null){if(typeof window.clipboardData.setData=='function'){var elementToCopy=$(e.trigger).data('clipboard-target');var contentToCopy=$(elementToCopy).text();window.clipboardData.setData('Text',contentToCopy)}}
$('#citation-modal').find('.primary_btn').val($("#copytocliptxt").val()).removeAttr('disabled');e.trigger.value=$("#copiedtocliptxt").val();e.trigger.disabled='disabled';$('.copy-error').css('display','none');dataLayer.push({'event':'content_cite'})});clipboard.on('error',function(e){$('#citation-modal').find('.primary_btn').val($("#copytocliptxt").val()).removeAttr('disabled');e.trigger.value=$("#copytocliptxt").val();$('.copy-error').css('display','block');e.clearSelection()});$('#subscription-close').on('click',function(){$(this).attr('data-dismiss','modal');$('.save-item').removeClass('save_item_act');if($("#commontool-Subscriptiondescr").find('a').attr('data-oldhref')){$("#commontool-Subscriptiondescr").find('a').attr('href',$("#commontool-Subscriptiondescr").find('a').attr('data-oldhref'));$("#commontool-Subscriptiondescr").find('a').removeAttr('data-oldhref')}});$(".condition-remove").on('keypress click',function(e){if(e.type==="click"||e.keyCode===13){var removedId=$(this).parent().attr('id')||$(this).parent().parent().parent().attr('id');var removedElement=$(this);$('.add-cond-layer:visible').each(function(index,element){if(removedId==$(this).attr('id')){updateElements(index,$(this),$('.add-cond-layer:visible').length)}});updateAddFieldButtonStatus()}});function updateElements(index,element,length){if(index==(length-1)){element.css('display','none');element.find("input[type=text]").val("");element.find(".selectpicker").selectpicker('val',1);element.find(".selectpicker").selectpicker('refresh');return!0}else{element.find('input[type=text]').val(element.next().find('input[type=text]').val());element.find('.selectpicker').each(function(index,value){$(this).selectpicker('val',element.next().find('.selectpicker')[index].value)});updateElements(index+1,element.next(),length)}}
$("#add-cond").click(function(){$(".add-cond-layer:hidden:first").css("display","block");updateAddFieldButtonStatus()});function updateAddFieldButtonStatus(){if($(".add-cond-layer:visible").length==5){$("#add-cond").addClass("disabled-btn");$("#add-cond").attr('disabled','disabled')}else{if(checkForEmptyField()){$("#add-cond").addClass("disabled-btn");$("#add-cond").attr('disabled','disabled')}else{$("#add-cond").removeClass("disabled-btn");$("#add-cond").removeAttr('disabled','disabled')}}}
$(document).on('click',$('.outerbox').find('input'),function(){if(checkForEmptyField()){$("#add-cond").addClass("disabled-btn");$("#add-cond").attr('disabled','disabled')}else if($(".add-cond-layer:visible").length<5){$("#add-cond").removeClass("disabled-btn");$("#add-cond").removeAttr('disabled','disabled')}});function checkForEmptyField(){var disabled=!1;$('.add-cond-layer:visible').each(function(){if($(this).find('input').val().trim()){}else{disabled=!0}});if($('.basic-play-search').length>0){if($('.basic-play-search').find('input').val().trim()){}else{disabled=!0}}
return disabled}
$('.add-cond-layer,.basic-play-search').find('input').on('input change',function(e){updateAddFieldButtonStatus()});$('#adv_search').find("#phr,.inner-search,#fromDate,#toDate").on('keyup',function(){advanceSearchValidation()});function advanceSearchValidation(){var isButtonDisable=!1;var contenttypeschecked=0;$('.content-types').find(':checkbox').each(function(){if($(this).prop('checked')){contenttypeschecked+=1}});var subtextfields=0;$('.inner-search').each(function(){if(!$(this).parents('search-field').hasClass('add-cond-layer')){if($(this).val().trim().length>0){subtextfields+=1}}});if($("#yearcheckbox").prop('checked')&&($('#fromDate').val().trim().length==0||$('#toDate').val().trim().length==0)){isButtonDisable=!0}
if(isButtonDisable){$("#search-btn").addClass("disabled-btn")}else{$("#search-btn").removeClass("disabled-btn")}}
$('.content-types,.year_checkbox').find(':checkbox').on('click',function(){advanceSearchValidation()});$("#fromDate, #toDate").on('keyup',function(e){$("#fromDate_error").html('');$("#toDate_error").html('');if(e.which!=8&&e.which!=0&&(e.which<48||e.which>57)){return!1}});function getKeyCode(word){if(word=='Title'){return'Ti'}else if(word=='Author/Editor/Creator'){return'Au'}else if(word=='Summary/Abstract'){return'Ab'}else if(word=='Category'){return'Cat'}else if(word=='Identifier'){return'Id'}else if(word=='Anywhere'){return'Any'}
return''}
$('#global_searchbtn').on('click',function(){$.cookie('searchbtnflag','true');if(!$(this).hasClass('disabled-btn')){$.cookie('type','');localStorage.setItem("selectedCheckBoxItem",null);localStorage.setItem("EnabledCheckBoxs",!1);getSearchResults();$.cookie('taxonomy','');$.cookie('contenttype','');$.cookie('df','');$.cookie('dt','')}});$('#global_searchbox').on('keyup',function(e){var keycode=(e.keyCode?e.keyCode:e.which);if(keycode=='13'){$.cookie('searchbtnflag','true');if(!$('#global_searchbtn').hasClass('disabled-btn')){$.cookie('taxonomy','');$.cookie('contenttype','');$.cookie('df','');$.cookie('dt','');$.cookie('type','');localStorage.setItem("selectedCheckBoxItem",null);localStorage.setItem("EnabledCheckBoxs",!1);getSearchResults()}}});$('#global_searchbox').on('input',function(e){if($(this).val().length>0){$('#global_searchbtn').removeClass('disabled-btn')}else{$('#global_searchbtn').addClass('disabled-btn')}});if($('#global_searchbox').length>0){if($('#global_searchbox').val().length>0){$('#global_searchbtn').removeClass('disabled-btn')}else{$('#global_searchbtn').addClass('disabled-btn')}}
$('.clearcookie').on('click',function(){$.cookie('taxonomy','');$.cookie('contenttype','');$.cookie('df','');$.cookie('dt','');$.cookie('type','')});$(window).resize(function(){var windowWidth=$(window).width();if(windowWidth>=975){$("#bs-navbar").addClass("arcadian-nav-menu")}else{$("#bs-navbar").removeClass("arcadian-nav-menu")}}).resize();$('body').on('click keydown',function(e){$('.no-focus').removeClass('no-focus');if(e.type==="click"){$('.nav li a').addClass('no-focus');$(e.target).addClass('no-focus')}else if(e.keyCode===9){$(e.target).removeClass('no-focus')}});$(".arc-menu-close").click(function(){$("#bs-navbar").removeClass("in").attr("aria-expanded","false")})});function getSearchResults(){var filter=$.cookie("Search-Filter");var globalsearchbox=$('#global_searchbox');var text=$.trim(globalsearchbox.val());if(text.length===0){text=''}
var ua=window.navigator.userAgent;var msie=ua.indexOf("MSIE");if(msie>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)){text=encodeURIComponent(text)}
showProgress();if(text.indexOf("|")>-1){text=encodeURIComponent(text)}
var url=window.location.protocol+'//'+window.location.host+'/search-results?any='+text;if(filter!=null&&filter!=''){url=window.location.protocol+'//'+window.location.host+'/search-results?any='+text+'&su='+filter}
window.location.href=url}
function removeItem(list,val){var i=list.indexOf(val);return i>-1?list.splice(i,1):[]}
$(document).on('click touch',function(e){if(!$("body").hasClass("modal-open")){if(!$(e.target).is(".close_ham")&&!$(e.target).is("a")){$("#bs-navbar").collapse("hide")}}});$(window).on('load',function(){if($("#mycontent").length==0){hideProgress()}
$(".taxonomy_alphabets li a").click(function(){$(".taxonomy_alphabets li a").parent().children().removeClass("active");$(this).addClass("active");var id=$(this).attr('data-itemid');$('.taxonomy_accordian').each(function(){if($(this).find('.accordion-toggle').attr('name')==id){$(this).find('.accordion-toggle').parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');$(this).find('.panel-collapse').addClass('in');var collapsetext=$('#collapseallsec').val();$('#accordion-panel').children('span').text(collapsetext)}})});$("#signin_modal").on("show.bs.modal",function(e){$("#download-modal").modal("hide")});$("#signin_modal").on("shown.bs.modal",function(e){$("#signin_modal #signin-username").focus()});$("#changepass").on("shown.bs.modal",function(e){$("#change-old-pwd").focus()});$("#signin-username").on('blur',function(){if($("#signin-username").hasClass('error-address')){$("#signin-btn").focus()}});$("#signup-email-addr, #signup-verify-email, #signup-password, #signup-confirm-password").keypress(function(event){$(this).css("border","solid #ccc 1px").siblings("span").addClass("hide");if(event.keyCode==13){if(!$('#signup-send-btn').hasClass('disabled-btn')){$.cookie('signupbtnflag','true');SignupSubmission()}}});$("#sn-signup-email-addr, #sn-signup-verify-email").keypress(function(event){$(this).css("border","solid #ccc 1px").siblings("span").addClass("hide");if(event.keyCode==13){if(!$('#sn-signup-send-btn').hasClass('disabled-btn')){$.cookie('signupbtnflag','true');SocialSignUpSubmission()}}});$("#edit-folder").on("show.bs.modal",function(e){$("#editfolder").addClass("disabled-btn")});$("#edit-folder").on("hide.bs.modal",function(e){$("#editfolder").addClass("disabled-btn")});$('#searchText').keyup(function(){if($(this).val().trim().length==0){$("#save-search").addClass('disabled-btn')}else{$("#save-search").removeClass('disabled-btn')}});$("#save_search").on("show.bs.modal",function(e){if($('#searchText').val().trim().length==0){$("#save-search").addClass("disabled-btn")}else{$("#save-search").removeClass("disabled-btn")}
setTimeout(function(){$("#searchText").focus().val($("#searchText").val())},500)});$("#save-search").focusout(function(){$('#savesearch-modal-close-btn').focus()});$("#signin-username,#signin-password").keyup(function(event){if($(this).val().trim().length==0){$("#signin-btn").addClass("disabled-btn").removeClass("signin-success-btn")}else{if($("#signin-username").val()!=""&&$("#signin-password").val()!=""){$("#signin-btn").removeClass("disabled-btn").addClass("signin-success-btn");$("#signin-username").css("border","1px solid #ccc").siblings("span").addClass("hide");$("#signin-password").css("border","1px solid #ccc").siblings("span").addClass("hide")}else{$("#signin-btn").addClass("disabled-btn").removeClass("signin-success-btn")}}});$("#signin_modal").on('hidden.bs.modal',function(e){$("#signin-form").find("input[type=text], input[type=email], input[type=password]").val("").css("border","solid #ccc 1px");$("#signin-form").find(".err-msg").addClass("hide");$("#signin-form").find("#signin-btn").addClass("disabled-btn").removeClass("signin-success-btn")});$('.image-slider-layout').on('click',".owl-item.center",function(){var url=$(this).find(".item").attr("data-redirecturl");if(url){if(url.trim().indexOf("http:")==0||url.trim().indexOf("https:")==0){window.open(url,'_blank')}else{window.open(url,'_self')}}});$(document).on("paste",'.number-class',function(e){var pastedData=e.originalEvent.clipboardData.getData('text');var isnum=/^\d+$/.test(pastedData);if(!isnum){e.preventDefault()}});$(window).resize(function(){var windowWidth=$(window).width();if(windowWidth>=975){$("#bs-navbar").addClass("arcadian-nav-menu")}else{$("#bs-navbar").removeClass("arcadian-nav-menu")}}).resize()});function setFocusTxt(){setTimeout(function(){$("#editfoldername").focus()},1000)}
$(document).on('click',".clear-btn",function(){$(".contact_form").find("input[type=text],input[type=email], textarea").val("");$(".contact_form").find("input:checkbox").removeAttr("checked");$(".contact_form").find(".selectpicker").selectpicker('deselectAll');$(".contact_form").find(".err-msg").addClass("hide");$(".contact_form").find("input").css("border","solid #ccc 1px");$(".contact_form").find("#contact-char-count").text("500")});$(document).on('click',".signup-clear-btn",function(){$(".signup-contact-form").find("input[type=text],input[type=email],input[type=password]").val("");$(".signup-contact-form").find("input:checkbox").removeAttr("checked");$(".signup-contact-form").find(".selectpicker").selectpicker('deselectAll');$(".signup-contact-form").find(".err-msg").addClass("hide");$(".signup-contact-form").find("input").css("border","solid #ccc 1px");$(".signup-contact-form").find("#share-char-count").text("500");grecaptcha.reset()});$(document).on('click',".sn-signup-clear-btn",function(){$("#signup-social-media").find("input[type=text],input[type=email],input[type=password]").val("");$("#signup-social-media").find("input:checkbox").removeAttr("checked");$("#signup-social-media").find(".selectpicker").selectpicker('deselectAll');$("#signup-social-media").find(".err-msg").addClass("hide");$("#signup-social-media").find("input").css("border","solid #ccc 1px");addModalClass()});$(document).on('click',".sn-signup-clear-cancel-btn",function(){addModalClass()});function addModalClass(){showProgress();setTimeout(function(){$('body').addClass('modal-open');hideProgress()},1000)}
$(document).on('click',".share-clear-btn",function(){$("#share-via-form").find("input[type=text],input[type=email], textarea").val("");$("#share-via-form").find("#share-char-count").text("500");$("#share-via-form").find(".err-msg").addClass("hide");$("#share-via-form").find("input").css("border","solid #ccc 1px");$("#share-btn").removeClass("share-success").addClass("disabled-btn");$("#to-name").focus();if($("#noCaptcha").length==0){grecaptcha.reset()}});$(document).on('click',".share-success-btn",function(){$("#share_success_modal").modal('hide');$('body').removeClass('modal-open')});$(document).on('hidden.bs.modal','#share-mail',function(){setTimeout(function(){$("#share-via-form").find("#to-name").val("");$("#share-via-form").find("#to-email").val("");$("#share-via-form").find("#your-name").val("");$("#share-via-form").find("#your-email").val("");$("#share-via-form").find("#subject").val("");$("#share-via-form").find("textarea").val("");$("#share-via-form").find("#share-char-count").text("500");$("#share-via-form").find(".err-msg").addClass("hide");$("#share-via-form").find("input").css("border","solid #ccc 1px");$("#share-btn").removeClass("share-success").addClass("disabled-btn")},400)});$(document).on('hidden.bs.modal','#share-mail-modal',function(){setTimeout(function(){$("#share-via-form").find("#to-name").val("");$("#share-via-form").find("#to-email").val("");$("#share-via-form").find("#your-name").val("");$("#share-via-form").find("#your-email").val("");$("#share-via-form").find("#subject").val("");$("#share-via-form").find("textarea").val("");$("#share-via-form").find("#share-char-count").text("500");$("#share-via-form").find(".err-msg").addClass("hide");$("#share-via-form").find("input").css("border","solid #ccc 1px");$("#share-btn").removeClass("share-success").addClass("disabled-btn")},400)});$(document).on('shown.bs.modal','#share-mail',function(){var nameVal=$("#your-name").attr("data-name-value");var mailVal=$("#your-email").attr("data-mail-value");if(nameVal&&nameVal.trim()){$("#your-name").val(nameVal)}
if(mailVal&&mailVal.trim()){$("#your-email").val(mailVal)}});$(document).on('shown.bs.modal','#share-mail-modal',function(){var nameVal=$("#your-name").attr("data-name-value");var mailVal=$("#your-email").attr("data-mail-value");if(nameVal&&nameVal.trim()){$("#your-name").val(nameVal)}
if(mailVal&&mailVal.trim()){$("#your-email").val(mailVal)}});$("#add-folder").on('hidden.bs.modal',function(e){$(this).find("input[type=text], textarea").val("").css("border","solid #ccc 1px");$(this).find("#mylib-addfolder-char").text("500")});$(document).on('click',".success-btn",function(){var emailAddress=$("#email-addr").val();var verifyEmail=$("#verify-email-addr").val();if(!verifyEmail){$("#email-addr").css("border","solid #ccc 1px").siblings("span").addClass("hide");$("#verify-email-addr").css("border","solid #ccc 1px").siblings("span").addClass("hide");showProgress();saveContactUs()}else if(!ValidateEmail(emailAddress)){$("#email-addr").addClass("error-address").css("border","solid red 1px").siblings("span").removeClass("hide").attr('tabindex','0');$("#verify-email-addr").css("border","solid #ccc 1px").siblings("span").addClass("hide");$("#email-addr").focus()}else if(!ValidateEmail(verifyEmail)){$("#email-addr").css("border","solid #ccc 1px").siblings("span").addClass("hide");$("#verify-email-addr").addClass("error-address").css("border","solid red 1px").siblings("span").removeClass("hide");$("#verify-email-addr").focus()}else{$("#email-addr").css("border","solid #ccc 1px").siblings("span").addClass("hide");if($("#email-addr").val()!=$("#verify-email-addr").val()){$("#verify-email-addr").css("border","solid red 1px").siblings("span").removeClass("hide")}else{$("#email-addr").css("border","solid #ccc 1px").siblings("span").addClass("hide");$("#verify-email-addr").css("border","solid #ccc 1px").siblings("span").addClass("hide");showProgress();saveContactUs()}}});$(document).on('click','.contactform-successbtn',function(){$("#success_modal").modal('hide');showProgress();location.reload(!0)});function saveContactUs(){if(!$('#send-btn').hasClass('disabled-btn')){var title=$("#title-option").length>0?$("#title-option").selectpicker('val'):"";if(title=="other"){title=$("#other-txt-box").val()}
var fname=$('#first-name').val();var surname=$('#sur-name').val();var emailaddress=$("#email-addr").val();var institution=$("#institution-field").length>0?$("#institution-field").val():"";var occupation=$("#occupation-select").length>0?$("#occupation-select").selectpicker('val'):"";var country=$("#country").length>0?$("#country").selectpicker('val'):"";var nature=$("#enquiry").length>0?$("#enquiry").selectpicker('val'):"";var msg=$("#msg-text-area").val();var keepintouch=!1;if($('#contactus-checkbox1').length>0){keepintouch=$('#contactus-checkbox1').prop('checked')}
var params={title:title,firstname:fname,surname:surname,email:emailaddress,institution:institution,occupation:occupation,countryid:country,message:msg,nature:nature,keepintouch:keepintouch,};dataLayer.push({'event':'form_submit','form name':'contact_us'});showProgress();$.ajax({type:'POST',url:"/app/contactus",data:params,success:function(resultData){hideProgress();if(resultData==!0){$("#success_modal").modal('show')}},error:function(e){hideProgress()}})}}
$(document).on('click',".share-success",function(){var toFlag=!1;var yourFlag=!1;var yourEmail=$("#your-email").val();if(!ValidateEmail(yourEmail)){$("#your-email").css("border","solid red 1px").siblings("span").removeClass("hide");$("#your-email").focus()}else{$("#your-email").css("border","solid #ccc 1px").siblings("span").addClass("hide");yourFlag=!0}
var toEmail=$("#to-email").val();if(!ValidateEmail(toEmail)){$("#to-email").css("border","solid red 1px").siblings("span").removeClass("hide");$("#to-email").focus()}else{$("#to-email").css("border","solid #ccc 1px").siblings("span").addClass("hide");toFlag=!0}
if(toFlag&&yourFlag){showProgress();$('#share-mail').modal('hide');var newArr=$("#share-via-form").serializeArray();var newObj={};$.each(newArr,function(index,value){if(value.value){newObj[value.name]=value.value}});newObj.title=$("#title").text()||$("#archive-image-title").text();newObj.authors=$('#authorname').val()||$('#authorname').text();window.formObj=newObj;var newShareObj={};for(member in newObj){if(member!="mpna"){newShareObj[member]=newObj[member]}}
dataLayer.push({'event':'content_share','method':'Email'});setTimeout(function(){$.ajax({url:"/app/contentemail",data:newShareObj,type:"POST",success:function(response){hideProgress();$('#share-mail-modal').modal('hide');$('#share_success_modal').modal('show')},error:function(error){hideProgress()}})},300)}});$(document).on('click',".sn-signup-success-btn",function(){var signupEmail=$("#sn-signup-email-addr").val();var signupVerifyemail=$("#sn-signup-verify-email").val();if(!ValidateEmail(signupEmail)){$("#sn-signup-email-addr").css("border","solid red 1px").siblings("span").removeClass("hide");$("#sn-signup-verify-email").css("border","solid red 1px").siblings("span").removeClass("hide")}else{$("#sn-signup-email-addr").css("border","solid #ccc 1px").siblings("span").addClass("hide");if($("#sn-signup-email-addr").val()!=$("#sn-signup-verify-email").val()){$("#sn-signup-verify-email").css("border","solid red 1px").siblings("span").removeClass("hide")}else{$("#sn-signup-email-addr").css("border","solid #ccc 1px").siblings("span").addClass("hide");$("#signup-verify-email").css("border","solid #ccc 1px").siblings("span").addClass("hide")}}});$(document).on('click',$('.outerbox').find('input'),function(){if($('#global_searchbox').val()){$('#global_searchbtn').removeClass('disabled-btn')}else{$('#global_searchbtn').addClass('disabled-btn')}});function close_action(element){element.parentElement.parentElement.remove();var removedfilter=element.parentElement.parentElement.innerText;var listitems=$(".filter li");listitems.each(function(idx,li){var item=$(li).find(".filtered");if(item.html()===removedfilter){item.removeClass("filteredItem")}})}
var isAndroid=navigator.userAgent.toLowerCase().indexOf("android")>-1;if(isAndroid){document.write('<meta name="viewport" content="width=device-width,height='+window.innerHeight+', initial-scale=1.0">')}
function hideProgress(){$('.loading').addClass('hide')}
function showProgress(){$('.loading').removeClass('hide')}
function showContentLoader(element){$(".content-loader").clone().removeClass("hide").appendTo(element)}
function hideContentLoader(element){$(element).find(".content-loader").remove()}
function cleanArray(actual){var newArray=new Array();for(var i=0;i<actual.length;i++){if(actual[i]){newArray.push(actual[i])}}
return newArray}
function loadpreviewimage(id,imageurl,istwoView,isfullview){var viewer='';if(isDesktop){viewer=OpenSeadragon({id:id,mouseNavEnabled:!0,prefixUrl:"/bloomsbury_assets/bloomsbury/images/slider/",tileSources:{type:'image',url:imageurl},autoHideControls:!1,showNavigationControl:!0,showNavigator:!0,showHomeControl:!0,navigatorSizeRatio:0.133,navigatorMaintainSizeRatio:!0,navigatorPosition:'BOTTOM_LEFT',showRotationControl:!0});viewer.addHandler("tile-loaded",function(data){if(isfullview&&!window.ignoreFirst){window.ignoreFirst=!0;if(window.loadFailed){window.loadFailed=!1;hideProgress()}}else if(window.ignoreFirst&&isfullview){window.ignoreFirst=!1;hideProgress()}else if(!isfullview&&$('#image-fullview-modal').is(':visible')){}else{hideProgress()}
setTimeout(function(){hideProgress()},5000)});viewer.addHandler("open-failed",function(data){if(isfullview){window.loadFailed=!0}
hideProgress()})}else{if(isfullview){viewer=OpenSeadragon({id:id,mouseNavEnabled:!0,useCanvas:navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!1:!0,prefixUrl:"/bloomsbury_assets/bloomsbury/images/slider/",tileSources:{type:'image',url:imageurl},toolbar:"image-controls-fullscreen-toolbar",zoomInButton:"zoom-in-fullscreen",zoomOutButton:"zoom-out-fullscreen",homeButton:"home-fullscreen",fullPageButton:"full-page-fullscreen",rotateLeftButton:"rotate-left-fullscreen",rotateRightButton:"rotate-right-fullscreen",autoHideControls:!1,showNavigationControl:!0,showNavigator:navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?false:!0,showHomeControl:!0,navigatorSizeRatio:0.133,navigatorMaintainSizeRatio:!0,navigatorPosition:'BOTTOM_LEFT',showRotationControl:!0});viewer.addHandler("tile-loaded",function(data){if(isfullview&&!window.ignoreFirst){window.ignoreFirst=!0;if(window.loadFailed){window.loadFailed=!1;hideProgress()}}else if(window.ignoreFirst&&isfullview){window.ignoreFirst=!1;hideProgress()}else if(!isfullview&&$('#image-fullview-modal').is(':visible')){}else{hideProgress()}
setTimeout(function(){hideProgress()},5000);$('#image-controls-fullscreen-toolbar').children().each(function(){if(!$(this).hasClass('control-icon')){$(this).addClass('hide')}})});viewer.addHandler("open-failed",function(data){hideProgress()})}else{viewer=OpenSeadragon({id:id,mouseNavEnabled:!0,useCanvas:navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!1:!0,prefixUrl:"/bloomsbury_assets/bloomsbury/images/slider/",tileSources:{type:'image',url:imageurl},toolbar:"image-controls-toolbar",zoomInButton:"zoom-in",zoomOutButton:"zoom-out",homeButton:"home",fullPageButton:"full-page",rotateLeftButton:"rotate-left",rotateRightButton:"rotate-right",autoHideControls:!1,showNavigationControl:!0,showNavigator:navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?false:!0,showHomeControl:!0,navigatorSizeRatio:0.133,navigatorMaintainSizeRatio:!0,navigatorPosition:'BOTTOM_LEFT',showRotationControl:!0});viewer.addHandler("tile-loaded",function(data){if(isfullview&&!window.ignoreFirst){window.ignoreFirst=!0;if(window.loadFailed){window.loadFailed=!1;hideProgress()}}else if(window.ignoreFirst&&isfullview){window.ignoreFirst=!1;hideProgress()}else if(!isfullview&&$('#image-fullview-modal').is(':visible')){}else{hideProgress()}
setTimeout(function(){hideProgress()},5000);$('#image-controls-toolbar').children().each(function(){if(!$(this).hasClass('control-icon')){$(this).addClass('hide')}})});viewer.addHandler("open-failed",function(data){hideProgress()})}}
viewer.addHandler("tile-unloaded",function(data){hideProgress()});viewer.addHandler("tile-load-failed",function(data){hideProgress()});if(isDesktop){$('#image-controls-toolbar').addClass('hide');var $previewfirst=$('#'+id);$previewfirst.find('.openseadragon-container').find("div:eq( 2 )").addClass('image-viewer-controls').addClass('image-archive-controls').removeAttr('style');$previewfirst.find('.image-viewer-controls').find('div').removeAttr('style');var totalcontrols=$previewfirst.find('.image-viewer-controls').find('div').children().children('div').length;var controlclasses=['icon-Zoom-In','icon-Zoom-Out','icon-Home','icon-fullscreen','icon-rotate_Anti-clockwise','icon-rotate_clockwise'];for(i=0;i<totalcontrols;i++){var controls='<span class="'+controlclasses[i]+'"/>';if(i==3){$previewfirst.find('.image-viewer-controls').find('div').children().children('div:eq('+i+')').addClass('control-icon hide').attr("tabindex","0").html(controls)}else{$previewfirst.find('.image-viewer-controls').find('div').children().children('div:eq('+i+')').addClass('control-icon').attr("tabindex","0").html(controls)}}
var fullviewcontrol='';if(isfullview){fullviewcontrol='<div tabindex="0" title="Toggle full screen" class="control-icon control-small-screen"><span class="icon-Normal_screen"/></div>';$previewfirst.find('.image-viewer-controls').find('div').children('div:eq(0)').append(fullviewcontrol)}else{fullviewcontrol='<div tabindex="0" title="Toggle full screen" class="control-icon control-full-screen"><span class="icon-fullscreen"/></div>';$previewfirst.find('.image-viewer-controls').find('div').children('div:eq(0)').append(fullviewcontrol);var viewcontrol='';if(istwoView){viewcontrol='<div tabindex="0" title="Single View" class="control-icon" id="singleview-control" ><span class="icon-Singlepage_layout"/></div>'}else{viewcontrol='<div tabindex="0" title="Multi View" class="control-icon" id="multiview-control"><span  class="icon-Doublepage_layout"/></div>'}
$previewfirst.find('.image-viewer-controls').find('div').children('div:eq(0)').append(viewcontrol)}}else{$('#image-controls-toolbar').removeClass('hide');if(isfullview){$('#image-controls-fullscreen-toolbar').removeClass('hide')}
$('#singleview-control').children('span').addClass('hide');$('#multiview-control').children('span').addClass('hide');if(istwoView){$('#singleview-control').children('span').removeClass('hide')}else{$('#multiview-control').children('span').removeClass('hide')}
if(navigator.userAgent.match(/(iPad|iPhone|iPod)/g)){$('#rotate-left').addClass('hide');$('#rotate-right').addClass('hide');$('#rotate-left-fullscreen').addClass('hide');$('#rotate-right-fullscreen').addClass('hide')}}
$(document).find('.openseadragon-container').find('canvas').addClass('disable-right')}
var previmagelist=[];var thumbimagelist=[];var totalimagescount=0;var totalpagescount=0;var totalthumbimagescount=0;var itemsperpage=5;var setpagenumber=0;var content_thumbimgindex=0;var thumb_startindex=0;var thumb_endindex=4;var istwoview=!0;var previewOwl='';var isrtl=!1;var archiveimageslider='';var isfullscreen=!1;var isDesktop=!0;var thumbitemsperpagelist=[];function InitArchiveImageViewerDetails(){var $topPrev=$(".prev-images");if($topPrev.length>0){showProgress();if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){isDesktop=!1}
var viewtype=$.urlParam('viewtype');if(viewtype){if(viewtype.toLowerCase()=='single'){istwoview=!1;$('#archive-image-viewtype').text('single')}else{istwoview=!0;$('#archive-image-viewtype').text('double')}}
var screenWidth=$(window).width();if(screenWidth<=1024){isDesktop=!1}
if(screenWidth>=991){itemsperpage=5}else if(screenWidth>=767){itemsperpage=4}else{itemsperpage=3}
var viewmode="";if(istwoview){viewmode="double"}else{viewmode="single"}
var xmlPath=$('#xmlPath').val();var id=$('#id').val();var langcode=$('#archive-lang-code').val();var params={xmlPath:xmlPath,xsltPath:"content-types/digital-archive/volume-cloudinary.xsl",id:id,mode:viewmode,langcode:langcode};$.ajax({type:'POST',url:"/app/cloudinary",data:params,dataType:"text",success:function(resultData){var imagedetails=$.parseJSON(resultData);UpdateArchiveImageViewerDetails(imagedetails,$topPrev)},error:function(e){}})}}
function getThumbImages(list){var itemslist=[];var totalpages=Math.ceil(list.length/itemsperpage);for(i=0;i<totalpages;i++){itemslist.push(list.splice(0,itemsperpage))}
return itemslist}
function UpdateArchiveImageViewerDetails(imagedetails,$topPrev){content_thumbimgindex=0;previmagelist=imagedetails.preview;var imageitems=[];var list=imagedetails.thumb;for(i=0;i<list.length;i++){thumbimagelist.push(list[i]);imageitems.push(list[i])}
thumbitemsperpagelist=getThumbImages(imageitems);var langcode=previmagelist[0].lang;var orientation=previmagelist[0].orientation;if(langcode=='ar'||langcode=='fa'||orientation=='rtl'){isrtl=!0;$('.photo_gallery').addClass('arabic-gallery').removeClass('gallery-direction');$('.slider-image').addClass('arabic-gallery').removeClass('gallery-direction')}else{isrtl=!1;$('.photo_gallery').removeClass('arabic-gallery').addClass('gallery-direction');$('.slider-image').removeClass('arabic-gallery').addClass('gallery-direction')}
totalimagescount=thumbimagelist.length;totalpagescount=Math.ceil(totalimagescount/itemsperpage);totalthumbimagescount=itemsperpage*totalpagescount;var carouselimagehtml='';var thumbimagehtml='';for(i=0;i<previmagelist.length;i++){var $preview_image_item=$('#preview-image-item');$preview_image_item.find('.sub-image').attr('id','preview'+i);carouselimagehtml+=$preview_image_item.html()}
for(i=0;i<totalthumbimagescount;i++){var $thumb_image_item=$('#thumb-image-item');$thumb_image_item.find('.item').attr('id','thumb'+i);if(i>=totalimagescount){$thumb_image_item.find('.item').html('')}
thumbimagehtml+=$thumb_image_item.html()}
var $btmThumb=$(".thumb-images"),flag=!1,duration=300;setpagenumber=0;$topPrev.html(carouselimagehtml);$btmThumb.html(thumbimagehtml);var currentset=thumbitemsperpagelist[0];for(i=0;i<currentset.length;i++){$('#thumb'+i).find('img').attr('src',currentset[i].Url);content_thumbimgindex=i}
$('#startimage').html(1);var totalimages=previmagelist[previmagelist.length-1].Page;$('#endimage').html(totalimages);$(".thumb-images>div:first").find("img").css("border","solid 3px #5E5B5C");$topPrev.on('initialized.owl.carousel',function(e){$('.photo_gallery .owl-next:first').addClass('icon-right_arrow');$('.photo_gallery .owl-prev:first').addClass('icon-Left_arrow')});previewOwl=$topPrev.owlCarousel({items:1,rtl:isrtl,margin:10,nav:!0,mouseDrag:!1,touchDrag:!1,lazyLoad:!0});previewOwl.on('click','.owl-next',function(){if(!$('.prev-images .owl-next').hasClass('owl-next-inactive')){var currentindex=$('.prev-images div.active').index();var item=previmagelist[currentindex];var imageAuth=$("#imageAuthEnabled").val();var select_url="";if(imageAuth=="true"){select_url=item.Url.split('id=')[1];select_url=select_url.split('&')[0]}else{select_url=item.Url}
$('#selected-image-url').val(select_url).attr('data-index',currentindex).attr('data-selected-pgno',item.FirstPage).attr('data-url',item.Url);var evt=new Event("cueForPrintDownload");document.dispatchEvent(evt);var imageid='';if(item.DoubleView){imageid=item.FirstImageId+'~'+item.SecondImageId}else{imageid=item.Id}
showArchivePageMetaData(imageid);highlightArchieveToc(item.PartId);$('#archive-image-title').html(item.PartTitle);$("#archive-image-title").popover("hide")
$('.trunk_content').html(item.PartTitle);var currentUrl=window.location.href;currentUrl=currentUrl.split('?')[0]+'?'+changeQueryVariable('partid',item.PartId,changeQueryVariable('pgno',item.FirstPage,currentUrl.split('?')[1]));ChangeUrl('path',currentUrl);if(!$btmThumb.find('.owl-stage').children().eq(currentindex).hasClass('active')){var thumbpagenumber=Math.ceil(currentindex/itemsperpage);if(thumbpagenumber<totalpagescount){var currentset=thumbitemsperpagelist[thumbpagenumber];var startItem=(thumbpagenumber*itemsperpage);var endItem=((startItem-1)+itemsperpage);endItem=(endItem<totalimagescount)?(endItem+1):totalimagescount;thumb_startindex=startItem;thumb_endindex=endItem;var index=thumb_startindex;for(i=0;i<currentset.length;i++){var $thumb=$('#thumb'+index);var thumbimgurl=$.trim($thumb.find('img').attr('src'));if(thumbimgurl.length==0){$thumb.find('img').attr('src',currentset[i].Url)}
index+=1}
$btmThumb.trigger('to.owl.carousel',thumbpagenumber);archiveimageslider.slider('setValue',thumbpagenumber+1);setpagenumber=thumbpagenumber}}
navigatePageGA()}}).on('click','.owl-prev',function(){if(!$('.prev-images .owl-prev').hasClass('owl-prev-inactive')){var currentindex=$('.prev-images div.active').index();var item=previmagelist[currentindex];var imageAuth=$("#imageAuthEnabled").val();var select_url="";if(imageAuth=="true"){select_url=item.Url.split('id=')[1];select_url=select_url.split('&')[0]}else{select_url=item.Url}
$('#selected-image-url').val(select_url).attr('data-index',currentindex).attr('data-selected-pgno',item.FirstPage).attr('data-url',item.Url);var evt=new Event("cueForPrintDownload");document.dispatchEvent(evt);var imageid='';if(item.DoubleView){imageid=item.FirstImageId+'~'+item.SecondImageId}else{imageid=item.Id}
showArchivePageMetaData(imageid);highlightArchieveToc(item.PartId);$('#archive-image-title').html(item.PartTitle);$("#archive-image-title").popover("hide")
$('.trunk_content').html(item.PartTitle);var currentUrl=window.location.href;currentUrl=currentUrl.split('?')[0]+'?'+changeQueryVariable('partid',item.PartId,changeQueryVariable('pgno',item.FirstPage,currentUrl.split('?')[1]));ChangeUrl('path',currentUrl);if(!$btmThumb.find('.owl-stage').children().eq(currentindex).hasClass('active')){var thumbpagenumber=Math.ceil(currentindex/itemsperpage);if(thumbpagenumber>0){setpagenumber=thumbpagenumber-1;var currentset=thumbitemsperpagelist[setpagenumber];var startItem=(setpagenumber*itemsperpage);var endItem=((startItem-1)+itemsperpage);endItem=(endItem<totalimagescount)?(endItem+1):totalimagescount;thumb_startindex=startItem;thumb_endindex=endItem;var index=thumb_startindex;for(i=0;i<currentset.length;i++){var $thumb=$('#thumb'+index);var thumbimgurl=$.trim($thumb.find('img').attr('src'));if(thumbimgurl.length==0){$thumb.find('img').attr('src',currentset[i].Url)}
index+=1}
$btmThumb.trigger('to.owl.carousel',setpagenumber);archiveimageslider.slider('setValue',thumbpagenumber)}}
navigatePageGA()}}).on('changed.owl.carousel',function(e){if(!flag){flag=!0;$btmThumb.find("img").css("border","solid 3px transparent");$btmThumb.find('.owl-stage').children().removeClass('selected');$btmThumb.find('.owl-stage').children().eq(e.item.index).addClass('selected');$btmThumb.find('.owl-stage').children().eq(e.item.index).find('img').css("border","solid 3px #5E5B5C");var currentindex=e.item.index;var previewcontent=$.trim($('#preview'+currentindex).html());if(previewcontent.length==0){showProgress();var id='preview'+currentindex;loadpreviewimage(id,previmagelist[currentindex].Url,istwoview,!1)}else{hideProgress()}
flag=!1}
setTimeout(function(){if($('.prev-images .owl-item').last().hasClass('active')){$('.prev-images .owl-next').addClass('owl-next-inactive');isrtl?$('#image-fullview-modal .owl-prev').addClass('owl-prev-inactive'):$('#image-fullview-modal .owl-next').addClass('owl-next-inactive')}else{$('.prev-images .owl-next').removeClass('owl-next-inactive');isrtl?$('#image-fullview-modal .owl-prev').removeClass('owl-prev-inactive'):$('#image-fullview-modal .owl-next').removeClass('owl-next-inactive')}
if($('.prev-images .owl-item').first().hasClass('active')){$('.prev-images .owl-prev').addClass('owl-prev-inactive');isrtl?$('#image-fullview-modal .owl-next').addClass('owl-next-inactive'):$('#image-fullview-modal .owl-prev').addClass('owl-prev-inactive')}else{$('.prev-images .owl-prev').removeClass('owl-prev-inactive');isrtl?$('#image-fullview-modal .owl-next').removeClass('owl-next-inactive'):$('#image-fullview-modal .owl-prev').removeClass('owl-prev-inactive')}},500)});initThumbImageViewer();$('.owl-prev').addClass('owl-prev-inactive');if($('.prev-images .owl-item').last().hasClass('active')){$('.owl-next').addClass('owl-next-inactive')}
if($('.prev-images .owl-item').length==1){$('.owl-prev').addClass('hide');$('.owl-next').addClass('hide')}else{$('.owl-prev').removeClass('hide');$('.owl-next').removeClass('hide')}
if(isrtl){if($('.prev-images .owl-item').last().hasClass('active')){$('#image-fullview-modal .owl-prev').addClass('owl-prev-inactive')}else{$('#image-fullview-modal .owl-prev').removeClass('owl-prev-inactive')}
if($('.prev-images .owl-item').first().hasClass('active')){$('#image-fullview-modal .owl-next').addClass('owl-next-inactive')}else{$('#image-fullview-modal .owl-next').removeClass('owl-next-inactive')}}
$btmThumb.find('.owl-stage').css('height','122px');if(totalimagescount<=itemsperpage){$('.thumb-images').find('.owl-nav').addClass('hide');$('.slider-image').addClass('hide');$('#imageslider').parent().addClass('hide')}else{archiveimageslider=initArchiveImageSlider();$('#imageslider').removeClass('hide')}
var selectedindex=0;var imagepagenumber=$.urlParam('pgno');var imageAuth=$("#imageAuthEnabled").val();var select_url="";if(imagepagenumber>0){if(istwoview){selectedindex=getIndexOfSelectedImage(imagepagenumber)}else{selectedindex=imagepagenumber-1}
if(imageAuth=="true"){select_url=previmagelist[selectedindex].Url.split('id=')[1];select_url=select_url.split('&')[0]}else{select_url=previmagelist[selectedindex].Url}
$('#selected-image-url').val(select_url).attr('data-selected-pgno',imagepagenumber).attr('data-index',selectedindex).attr('data-url',previmagelist[selectedindex].Url);imagepagenumber=getPageOfSelectedImage(imagepagenumber)}
var id='preview'+selectedindex;loadpreviewimage(id,previmagelist[selectedindex].Url,istwoview,!1);$topPrev.trigger('to.owl.carousel',[selectedindex,300,!0]);thumbSlideToSelectedIndex(imagepagenumber+1);var item=previmagelist[selectedindex];if(item.DoubleView){imageid=item.FirstImageId+'~'+item.SecondImageId}else{imageid=item.Id}
showArchivePageMetaData(imageid)}
function ChangeUrl(page,url){if(typeof(history.pushState)!="undefined"){var obj={Page:page,Url:url};history.pushState(obj,obj.Page,obj.Url)}else{console.log("Browser does not support HTML5.")}}
function showArchivePageMetaData(imageid){var xmlreq=new XMLHttpRequest();$("#physicalDescription").html('');$('#accordion0').addClass('hide');$('#collapseZero').removeClass('in');var xmlPath=$('#xmlPath').val();var pdPath=$('#pdPath').val();var langCode=$('#archive-lang-code').val();xmlreq.onreadystatechange=function(){if(xmlreq.readyState==4&&xmlreq.status==200){var response=xmlreq.responseText;if(response!=''){$('#accordion0').removeClass('hide');$('#collapseZero').addClass('in');$("#physicalDescription").html(xmlreq.responseText)}}};xmlreq.open("POST","/app/physicalDesc",!0);xmlreq.setRequestHeader("Content-type","application/x-www-form-urlencoded");var param="xmlPath="+xmlPath+"&xsltPath="+pdPath+"&facId="+imageid+"&lang="+langCode;xmlreq.send(param)}
function thumbSlideToSelectedIndex(currentpagenumber){currentpagenumber=currentpagenumber-1;if(setpagenumber!=currentpagenumber&&currentpagenumber>=0){setpagenumber=currentpagenumber;if(setpagenumber>=0&&setpagenumber<totalpagescount){showProgress();var startItem=(setpagenumber*itemsperpage);var endItem=((startItem-1)+itemsperpage);endItem=(endItem<totalimagescount)?endItem:totalimagescount;thumb_startindex=startItem;thumb_endindex=endItem;var currentset=thumbitemsperpagelist[setpagenumber];var index=thumb_startindex;var url=window.location.href;for(i=0;i<currentset.length;i++){var $thumb=$('#thumb'+index);var thumbimgurl=$.trim($thumb.find('img').attr('src'));if(thumbimgurl.length==0){if(typeof currentset[i]=="string")
$thumb.find('img').attr('src',currentset[i]);else $thumb.find('img').attr('src',currentset[i].Url)}
index+=1}
$(".thumb-images").trigger('to.owl.carousel',setpagenumber);archiveimageslider.slider('setValue',setpagenumber+1);setTimeout(function(){hideProgress()},1000)}}}
function getPageOfSelectedImage(pagenumber){for(i=0;i<thumbitemsperpagelist.length;i++){var items=thumbitemsperpagelist[i];for(j=0;j<items.length;j++){if(items[j].FirstPage==pagenumber||items[j].SecondPage==pagenumber){return i}}}
return 0}
function getIndexOfSelectedImage(pagenumber){for(i=0;i<previmagelist.length;i++){if(previmagelist[i].FirstPage==pagenumber||previmagelist[i].SecondPage==pagenumber){return i}}
return 0}
$(document).on('click touchstart','#multiview-control',function(){showProgress();$('#archive-image-viewtype').text('double');var url=window.location.href;var pageno=$.urlParam('pgno');var selectedpgno=$('#selected-image-url').attr('data-selected-pgno');if(selectedpgno.length>0&&pageno.length>0&&parseInt(selectedpgno)!=parseInt(pageno)){url=changeQueryVariable('pgno',selectedpgno,url)}
var viewparam=$.urlParam('viewtype');if(viewparam){url=changeQueryVariable('viewtype','double',url)}else{url=url+'&viewtype=double'}
$.cookie("squidtrack","false");window.location.href=url});$(document).on('click touchstart','#singleview-control',function(){showProgress();$('#archive-image-viewtype').text('single');var url=window.location.href;var pageno=$.urlParam('pgno');var selectedpgno=$('#selected-image-url').attr('data-selected-pgno');if(selectedpgno.length>0&&pageno.length>0&&parseInt(selectedpgno)!=parseInt(pageno)){url=changeQueryVariable('pgno',selectedpgno,url)}
var viewparam=$.urlParam('viewtype');if(viewparam){url=changeQueryVariable('viewtype','single',url)}else{url=url+'&viewtype=single'}
$.cookie("squidtrack","false");window.location.href=url});$(document).on('click touchstart','.control-full-screen,.custom-full-screen',function(e){e.preventDefault();e.stopImmediatePropagation();isfullscreen=!0;$('#image-fullview-modal').modal('show');var selectedindex=$('#selected-image-url').attr('data-index');var height=window.innerHeight;if(navigator.userAgent.match(/(iPad|iPhone|iPod)/g)){height=$(window).height()}
if(!isDesktop){height=height-50}
$('#prev-full-view').css('height',height).html('');if($('.building_galley').length>0){loadContentImageViewer('prev-full-view',previmagelist[selectedindex],isfullscreen)}else{loadpreviewimage('prev-full-view',previmagelist[selectedindex].Url,istwoview,isfullscreen)}
if($(this).hasClass("control-full-screen")){dataLayer.push({'event':'image_interaction','interaction_type':'Toggle Full Screen'})}});$(document).on('click touchstart','.control-small-screen',function(e){$('#image-fullview-modal').modal('hide');isfullscreen=!1});$(document).on('click','.next-fullscreen',function(){if(!$(this).hasClass('owl-next-inactive')){isfullscreen=!0;if(isrtl){previewOwl.find('.owl-prev').click()}else{previewOwl.find('.owl-next').click()}
var selectedindex=$('#selected-image-url').attr('data-index');var height=window.innerHeight;if(navigator.userAgent.match(/(iPad|iPhone|iPod)/g)){height=$(window).height()}
if(!isDesktop){height=height-50}
$('#prev-full-view').css('height',height).html('');if($('.building_galley').length>0){loadContentImageViewer('prev-full-view',previmagelist[selectedindex],isfullscreen)}else{window.ignoreFirst=!1;var currentUrl=window.location.href;currentUrl=currentUrl.split('?')[0]+'?'+changeQueryVariable('pgno',previmagelist[selectedindex].FirstPage,currentUrl.split('?')[1]);ChangeUrl('path',currentUrl);showProgress();loadpreviewimage('prev-full-view',previmagelist[selectedindex].Url,istwoview,isfullscreen)}}});$(document).on('click','.prev-fullscreen',function(){if(!$(this).hasClass('owl-prev-inactive')){isfullscreen=!0;if(isrtl){previewOwl.find('.owl-next').click()}else{previewOwl.find('.owl-prev').click()}
var selectedindex=$('#selected-image-url').attr('data-index');var height=window.innerHeight;if(navigator.userAgent.match(/(iPad|iPhone|iPod)/g)){height=$(window).height()}
if(!isDesktop){height=height-50}
$('#prev-full-view').css('height',height).html('');if($('.building_galley').length>0){loadContentImageViewer('prev-full-view',previmagelist[selectedindex],isfullscreen)}else{window.ignoreFirst=!1;var currentUrl=window.location.href;currentUrl=currentUrl.split('?')[0]+'?'+changeQueryVariable('pgno',previmagelist[selectedindex].FirstPage,currentUrl.split('?')[1]);ChangeUrl('path',currentUrl);showProgress();loadpreviewimage('prev-full-view',previmagelist[selectedindex].Url,istwoview,isfullscreen)}}});function initThumbImageViewer(){var duration=300;$(".thumb-images").on('initialized.owl.carousel',function(e){$('.thumb-images .owl-next:first').addClass('icon-right_arrow');$('.thumb-images .owl-prev:first').addClass('icon-Left_arrow')})
var thumbOwl=$(".thumb-images").owlCarousel({rtl:isrtl,margin:5,nav:!0,mouseDrag:!1,touchDrag:!1,scrollPerPage:!0,lazyLoad:!0,pagination:!0,paginationNumbers:!0,responsive:{992:{items:5},768:{items:4},320:{items:3}}});thumbOwl.on('click','.owl-item',function(){var currentindex=$(this).index();$(".prev-images").trigger('to.owl.carousel',[currentindex,duration,!0]);var item=previmagelist[currentindex];var imageAuth=$("#imageAuthEnabled").val();var select_url="";if(imageAuth=="true"){select_url=item.Url.split('id=')[1];select_url=select_url.split('&')[0]}else{select_url=item.Url}
$('#selected-image-url').val(select_url).attr('data-index',currentindex).attr('data-selected-pgno',item.FirstPage).attr('data-url',item.Url);var evt=new Event("cueForPrintDownload");document.dispatchEvent(evt);var imageid='';if(item.DoubleView){imageid=item.FirstImageId+'~'+item.SecondImageId}else{imageid=item.Id}
showArchivePageMetaData(imageid);highlightArchieveToc(item.PartId);$('#archive-image-title').html(item.PartTitle);$("#archive-image-title").popover("hide")
$('.trunk_content').html(item.PartTitle);var currentUrl=window.location.href;currentUrl=currentUrl.split('?')[0]+'?'+changeQueryVariable('partid',item.PartId,changeQueryVariable('pgno',item.FirstPage,currentUrl.split('?')[1]));ChangeUrl('path',currentUrl)}).on('click','.owl-next',function(){if(!$('.thumb-images .owl-next').hasClass('owl-next-inactive')){if(setpagenumber<totalpagescount){setpagenumber+=1;var currentset=thumbitemsperpagelist[setpagenumber];var startItem=(setpagenumber*itemsperpage);var endItem=((startItem-1)+itemsperpage);endItem=(endItem<totalimagescount)?(endItem+1):totalimagescount;thumb_startindex=startItem;thumb_endindex=endItem;var index=thumb_startindex;for(i=0;i<currentset.length;i++){var $thumb=$('#thumb'+index);var thumbimgurl=$.trim($thumb.find('img').attr('src'));if(thumbimgurl.length==0){$thumb.find('img').attr('src',currentset[i].Url)}
index+=1}
$(".thumb-images").trigger('to.owl.carousel',setpagenumber);archiveimageslider.slider('setValue',setpagenumber+1)}}}).on('click','.owl-prev',function(){if(!$('.thumb-images .owl-prev').hasClass('owl-next-inactive')){if(setpagenumber>0){setpagenumber-=1;var currentset=thumbitemsperpagelist[setpagenumber];var startItem=(setpagenumber*itemsperpage);var endItem=((startItem-1)+itemsperpage);endItem=(endItem<totalimagescount)?(endItem+1):totalimagescount;thumb_startindex=startItem;thumb_endindex=endItem;var index=thumb_startindex;var currentset=thumbitemsperpagelist[setpagenumber];for(i=0;i<currentset.length;i++){var $thumb=$('#thumb'+index);var thumbimgurl=$.trim($thumb.find('img').attr('src'));if(thumbimgurl.length==0){$thumb.find('img').attr('src',currentset[i].Url)}
index+=1}
$(".thumb-images").trigger('to.owl.carousel',setpagenumber);archiveimageslider.slider('setValue',setpagenumber+1)}}}).on('changed.owl.carousel',function(e){setTimeout(function(){if($('.thumb-images .owl-item').last().hasClass('active')){$('.thumb-images .owl-next').addClass('owl-next-inactive')}else{$('.thumb-images .owl-next').removeClass('owl-next-inactive')}
if($('.thumb-images .owl-item').first().hasClass('active')){$('.thumb-images .owl-prev').addClass('owl-prev-inactive')}else{$('.thumb-images .owl-prev').removeClass('owl-prev-inactive')}},500)});return thumbOwl}
function initArchiveImageSlider(){var slider=$('#imageslider').slider({tooltip:'always',min:1,max:totalpagescount,step:1,value:1,reversed:isrtl,formatter:function(value){var tooltippagenumber=value-1;var currentset=thumbitemsperpagelist[tooltippagenumber];var pagesindicator='';if(istwoview){pagesindicator=(currentset[0].FirstPage==currentset[0].SecondPage)?currentset[0].Page:currentset[0].Page-1;if(currentset.length<itemsperpage){pagesindicator=pagesindicator+'-'+currentset[currentset.length-1].Page}else{pagesindicator=pagesindicator+'-'+currentset[itemsperpage-1].Page}}else{pagesindicator=currentset[0].Page;if(pagesindicator===undefined){pagesindicator=((value-1)*itemsperpage+1);if(currentset.length<itemsperpage){pagesindicator=pagesindicator+'-'+(pagesindicator+currentset.length-1)}else{pagesindicator=pagesindicator+'-'+(pagesindicator+itemsperpage-1)}}else{if(currentset.length<itemsperpage){pagesindicator=pagesindicator+'-'+currentset[currentset.length-1].Page}else{pagesindicator=pagesindicator+'-'+currentset[itemsperpage-1].Page}}}
return pagesindicator}});slider.on('slideStop',function(e){thumbSlideToSelectedIndex(e.value)});return slider}
$(document).on('click','#archive-go-to-page',function(){if(!$(this).hasClass('disabled-btn')){if(!$('#archive-go-to-page').hasClass('goto_pageguest')){}else{$('#subscription-modal').modal('show')}
var $pno=$('#archive-pno');var archivepagenumber=$.trim($pno.val());$pno.css('border','solid #ccc 1px');if(parseInt(archivepagenumber)<=getTotalPages()){var param='';var viewparam=$.urlParam('viewtype');if(viewparam){param='&viewtype='+viewparam}else{var viewtype=$('#archive-image-viewtype').val();if(viewtype){param='&viewtype='+$('#archive-image-viewtype').val()}else{param='&viewtype=double'}}
var oldPageNumber=archivepagenumber;var volumeIndex=getVolumeNumber(archivepagenumber);var hrefLink=$('.toc-new-volume').length>1?$("a[newid='"+archivepagenumber+"']").attr('data-href'):$("a[id='"+archivepagenumber+"']").attr('data-href');if(hrefLink){hrefLink=hrefLink.split('pgno='+oldPageNumber).join('pgno='+archivepagenumber);showProgress();window.location.href=hrefLink+param}else{hrefLink=getTocItem(volumeIndex,oldPageNumber).attr('data-href');if(!hrefLink){$('.toc-new-volume').find('a:first').attr('data-href')}
hrefLink=hrefLink.split('?')[0]+"?"+changeQueryVariable('pgno',archivepagenumber,hrefLink.split('?')[1])}
if($(this).attr('data-redirect')=='false'){$('#commontool-Subscriptiondescr').find('a').attr('data-oldhref',$('#commontool-Subscriptiondescr').find('a').attr('href'));$('#commontool-Subscriptiondescr').find('a').attr('href','login?recentUrl=/'+hrefLink+param)}else{showProgress();window.location.href=hrefLink+param}}else{if($(this).attr('data-redirect')=='false'){}else{$pno.css("border","solid red 1px");$pno.val(getTotalPages())}}}});$(document).on('click','.archive-toc-link',function(){var target=$(this).attr('data-logged');var currentToc=$(this);var hrefLink=$(this).attr('data-href');if(target=='true'&&!$(this).parent().parent().hasClass('active')){showProgress();var param='';var viewparam=$.urlParam('viewtype');if(viewparam){param='&viewtype='+viewparam}else{var viewtype=$('#archive-image-viewtype').val();if(viewtype){param='&viewtype='+$('#archive-image-viewtype').val()}else{param='&viewtype=double'}}
window.location.href=hrefLink+param}else{var param='';var viewparam=$.urlParam('viewtype');if(viewparam.length>0){param='&viewtype='+viewparam}else{var viewtype=$('#archive-image-viewtype').val();if(viewtype.length>0){param='&viewtype='+$('#archive-image-viewtype').val()}else{param='&viewtype=double'}}
$('#commontool-Subscriptiondescr').find('a').attr('data-oldhref',$('#commontool-Subscriptiondescr').find('a').attr('href'));$('#commontool-Subscriptiondescr').find('a').attr('href','login?recentUrl=/'+hrefLink+param)}});function gotoPageNo(){var pagenumber=$('#goto_pageno').val().trim();var pageExists=!1;var url='';$('#goto_pageno').css('border','solid #ccc 1px');$("#go-to-error-msg").remove();$('.dots_div').each(function(index){var temp=$(this).parent().find('>span').text();var v_numbers=temp.replace(/\u2013|\u2014|-/g,"~").split('~');if(parseInt(pagenumber)==parseInt(temp)){url=$(this).find('a').attr('href');if(url&&url!='javascript:;'&&!url.includes("javascript")){pageExists=!0}}else{if(v_numbers.length>1){if((parseInt(pagenumber)>=parseInt(v_numbers[0]))&&(parseInt(pagenumber)<=parseInt(v_numbers[1]))){url=$(this).find('a').attr('href');if(url&&url!='javascript:;'&&!url.includes("javascript")){pageExists=!0}}}else{var temp2=$(this).parent().parent().next().find('>>span').text();if(!temp2){temp2=$('.dots_div').eq(index+1).parent().find('>span').text()}
var v_numbers2=temp2.replace(/\u2013|\u2014/g,"~").split('~');if((parseInt(pagenumber)>=parseInt(v_numbers[0]))&&(parseInt(pagenumber)<parseInt(v_numbers2[0]))){url=$(this).find('a').attr('data-href');if(url&&url!='javascript:;'&&!url.includes("javascript")){pageExists=!0}}else if((parseInt(pagenumber)>=parseInt(v_numbers[0]))&&(parseInt(pagenumber)==parseInt(v_numbers2[0]))){url=$('.dots_div').eq(index+1).find('a').attr('data-href');if(url&&url!='javascript:;'&&!url.includes("javascript")){pageExists=!0}}}}});if(!pageExists){$('.panel-title a').each(function(){var temp=$(this).find('>span').text();var v_numbers=temp.replace(/\u2013|\u2014/g,"~").split('~');if((parseInt(pagenumber)>=parseInt(v_numbers[0]))&&(parseInt(pagenumber)<=parseInt(v_numbers[1]))){url=$(this).attr('href');if(url&&url!='javascript:;'&&!url.includes("javascript")){pageExists=!0}}})}else{if(window.location.href==("https://"+window.location.host+"/"+url)&&window.location.href!=("https://"+window.location.host+"/"+url+"#page-"+pagenumber)){window.location.href=url+"#page-"+pagenumber}else if(window.location.href!=("https://"+window.location.host+"/"+url+"#page-"+pagenumber)){window.location.href=url+"#page-"+pagenumber}else{location.reload()}
return!1}
if(!pageExists){$('#goto_pageno').css("border","solid red 1px");$('<div id="go-to-error-msg" class="go-to-error-msg"><span class="go-to-error">Invalid Page No.</span></div>').insertAfter($('#goto_pageno').parent()[0])}else{if(window.location.href==("https://"+window.location.host+"/"+url)&&window.location.href!=("https://"+window.location.host+"/"+url+"#page-"+pagenumber)){window.location.href=url+"#page-"+pagenumber}else if(window.location.href!=("https://"+window.location.host+"/"+url+"#page-"+pagenumber)){window.location.href=url+"#page-"+pagenumber}else{location.reload()}
return!1}}
$(document).on('shown.bs.dropdown',function(e){var dropdown=$(e.target);dropdown.find('.dropdown-menu').attr('aria-expanded',!1)});$(document).on('hidden.bs.dropdown',function(e){var dropdown=$(e.target);dropdown.find('.dropdown-menu').attr('aria-expanded',!0)});$(document).on('hidden.bs.modal','#signup-social-media',function(){$('#signup-social-media').find('.err-msg').addClass('hide')
$('#signup-social-media').find('input').removeAttr('style')});$(document).on('keyup','#archive-pno',function(event){$(this).css('border','solid #ccc 1px');var $pno=$(this);var archivepagenumber=$.trim($(this).val());if(archivepagenumber.length>0){$("#archive-go-to-page").removeClass("disabled-btn")}else{$("#archive-go-to-page").addClass("disabled-btn")}
if(!$("#archive-go-to-page").hasClass('disabled-btn')){var charCode=(event.which)?event.which:event.keyCode;if(charCode=='13'){if(!$('#archive-go-to-page').hasClass('goto_pageguest')){}else{$('#subscription-modal').modal('show')}
if(parseInt(archivepagenumber)<=getTotalPages()){var param='';var viewparam=$.urlParam('viewtype');if(viewparam){param='&viewtype='+viewparam}else{var viewtype=$('#archive-image-viewtype').val();if(viewtype){param='&viewtype='+$('#archive-image-viewtype').val()}else{param='&viewtype=double'}}
var oldPageNumber=archivepagenumber;var volumeIndex=getVolumeNumber(archivepagenumber);var hrefLink=$('.toc-new-volume').length>1?$("a[newid='"+archivepagenumber+"']").attr('data-href'):$("a[id='"+archivepagenumber+"']").attr('data-href');if(hrefLink){hrefLink=hrefLink.split('pgno='+oldPageNumber).join('pgno='+archivepagenumber);showProgress();window.location.href=hrefLink+param}else{hrefLink=getTocItem(volumeIndex,oldPageNumber).attr('data-href');if(!hrefLink){$('.toc-new-volume').find('a:first').attr('data-href')}
hrefLink=hrefLink.split('?')[0]+"?"+changeQueryVariable('pgno',archivepagenumber,hrefLink.split('?')[1])}
if($(this).attr('data-redirect')=='false'){$('#commontool-Subscriptiondescr').find('a').attr('data-oldhref',$('#commontool-Subscriptiondescr').find('a').attr('href'));$('#commontool-Subscriptiondescr').find('a').attr('href','login?recentUrl=/'+hrefLink+param)}else{showProgress();window.location.href=hrefLink+param}}else{if($(this).attr('data-redirect')=='false'){}else{$pno.css("border","solid red 1px");$pno.val(getTotalPages())}}}else{return!(charCode>31&&(charCode<48||charCode>57))}}});function highlightArchieveToc(partid){var pageNum=$.urlParam('pgno');if(partid.length>0){var baseIds=[];if($('.toc_box').length>0){$('.toc_box').find('.archive-toc-link').each(function(){$(this).parent().parent().removeClass('active')});$('.toc_box').find('.archive-toc-link').each(function(){var target=$(this).attr('data-logged');if(target=='true'){var volumeNumber=getVolumeNumber(pageNum);var volumeContainer=$('.toc-new-volume')[volumeNumber];var condition2=volumeContainer?$.contains(volumeContainer,this):!0;if($(this).attr('data-partid')==partid&&condition2){$(this).parent().parent().addClass('active');$(this).addClass('archive-selected')}}})}}}
function getNewPageNumber(toc){var volumeIndex=0;var volumeCount=[];var pageOffset=0;var newPageNumber=parseInt($(toc).attr('id'))
if($('.toc-new-volume').length>1){$('.toc-new-volume').each(function(index){if($.contains($(this)[0],toc)){volumeIndex=index}
var volumePage=$(this).find('a.hide:last').attr('id');volumeCount.push(parseInt(volumePage))});if(volumeIndex>0&&volumeIndex<volumeCount.length&&volumeCount.length==$('.toc-new-volume').length){for(var x=0;x<volumeIndex;x++){pageOffset+=volumeCount[x]}}
newPageNumber=pageOffset+parseInt($(toc).attr('id'))}
return newPageNumber}
function getOldPageNumber(page){var volumeIndex=0;var volumeCount=[];var pageOffset=0;var currentCount=0;var prevCount=0;var newPageNumber=parseInt(page);if($('.toc-new-volume').length>1){$('.toc-new-volume').each(function(index){var volumePage=$(this).find('a.hide:last').attr('id');currentCount+=parseInt(volumePage);if(parseInt(page)<=currentCount&&parseInt(page)>prevCount){volumeIndex=index}
prevCount+=parseInt(volumePage);volumeCount.push(parseInt(volumePage))});if(volumeIndex>0&&volumeIndex<volumeCount.length&&volumeCount.length==$('.toc-new-volume').length){for(var x=0;x<volumeIndex;x++){pageOffset-=volumeCount[x]}}
newPageNumber=pageOffset+newPageNumber;if(newPageNumber<0){newPageNumber=parseInt(page)}}
return newPageNumber}
function getTocItem(volume,page){var prevId=1;var currentId;var returnId=page;if($($('.toc-new-volume')[volume]).find('#'+page).length>0){return $($('.toc-new-volume')[volume]).find('#'+page)}else{$($('.toc-new-volume')[volume]).find('a').each(function(index){var newId=$('.toc-new-volume').length>1?$(this).attr('newid'):$(this).attr('id');if($(this).attr('data-partid')&&newId){currentId=parseInt(newId);if(page<=currentId&&page>prevId){returnId=prevId}
prevId=parseInt(newId)}});return $('.toc-new-volume').length>1?$($('.toc-new-volume')[volume]).find("a[newid='"+returnId+"']"):$($('.toc-new-volume')[volume]).find("a[id='"+returnId+"']")}}
function getVolumeNumber(page){var volumeIndex=0;var currentCount=0;var prevCount=0;if($('.toc-new-volume').length>1){$('.toc-new-volume').each(function(index){var volumePage=$(this).find('a.hide:last').attr('newid');currentCount=parseInt(volumePage);if(parseInt(page)<=currentCount&&parseInt(page)>prevCount){volumeIndex=index}
prevCount=parseInt(volumePage)})}
return volumeIndex}
function getTotalPages(){var totalPages=0;var pageNum=$('.toc-new-volume').length>1?$('.toc-new-volume:last').find('a.hide:last').attr('newid'):$('.toc-new-volume:last').find('a.hide:last').attr('id');if(pageNum&&!isNaN(parseInt(pageNum))){totalPages=parseInt(pageNum)}
return totalPages}
function highlightBpmToc(){var currentitem;if($("#disable-toc-highlight").length==0){var linkparam="tocid";if($("#useactid").length>0){linkparam="actid"}
if($('.taxonomy_accordian .dots_div').length>0){$('.taxonomy_accordian .dots_div').each(function(){$(this).parent().removeClass('active');if($(this).find('>a').length>0){$(this).find('>a').each(function(){if(!$(this).hasClass('accordion-toggle')){var link=$(this).attr('href');if(link){if(link.length>0){var tocid=$.linkParam(linkparam,link);if(tocid.length>0){var currenturl=window.location.href;var currenttocid=$.linkParam(linkparam,currenturl);if(tocid==currenttocid){$(this).parent().parent().addClass('active').find('a').attr("tabindex","-1");currentitem=this;return!1}}}}}})}})}
if($('.taxonomy_accordian .accordian_toc').length>0){$('.taxonomy_accordian .accordian_toc').each(function(){$(this).find('h4>a').each(function(){if(!$(this).hasClass('accordion-toggle')){var link=$(this).attr('href');if(link){if(link.length>0){var tocid=$.linkParam(linkparam,link);if(tocid.length>0){var currenturl=window.location.href;var currenttocid=$.linkParam(linkparam,currenturl);if(tocid==currenttocid){$(this).parent().addClass('active').find('a').attr("tabindex","-1");return!1}}}}}})})}
if(linkparam=="actid"&&currentitem){$("#table_content").find('.collapse').each(function(){if($.contains(this,currentitem)){$(this).collapse('show')}else{$(this).collapse('hide')}})}}}
$(document).on('click','.taxonomy_accordian .mono-toc>span',function(e){if($(e.target).parents('li').hasClass('active')){e.preventDefault()}});$(document).on('click','.taxonomy_accordian .accordian_toc h4>a',function(e){if($(e.target).parents('.panel-title').hasClass('active')){e.preventDefault()}});$(document).on('click','.dots_div>a,.dots_div a>span',function(e){if($(this).parents('li').hasClass('active')){e.preventDefault()}
e.stopPropagation()});$(document).on('click','.author-view-more',function(e){$(this).parent().find('.text-trunc-auth-outer').addClass('hide');$(this).parent().parent().find('.altauthor_content').removeClass('hide');$(this).addClass('hide')});$(document).on('click','.author-view-less',function(e){$(this).parent().addClass('hide');$(this).parent().parent().find('.text-trunc-auth-outer').removeClass('hide');$(this).parent().parent().find('.author-view-more').removeClass('hide')});function getArchivePageNumberToHighlight(number,ranges){for(var i=0;i<ranges.length;++i){if(parseInt(number)<parseInt(ranges[i])){return ranges[i-1]}}
return''}
function initArcadianLibraryImageSlider(){var screenWidth=$(window).width();var currentIndex=5;if(screenWidth>=992){currentIndex=5}else if(screenWidth>=768){currentIndex=4}else if(screenWidth>=600){currentIndex=3}else{currentIndex=2}
var nextseconditem=!1;var prevseconditem=!1;var autoplay=!1;if($("#slider-transition-value").val()=="true"){autoplay=!0}
var arcadianslider=$('.image-slider-layout');if(!arcadianslider.hasClass('playtext-image-slider')){if(arcadianslider.hasClass('osprey-slider')){var isCenter=arcadianslider.find('.right').length>0?!0:!1;arcadianslider.find('.owl-carousel').owlCarousel({lazyLoad:!1,loop:!0,center:isCenter,nav:!0,margin:20,mouseDrag:!1,touchDrag:!1,items:3,responsive:{1200:{items:3},992:{items:2},768:{items:1},600:{items:1},320:{items:1}},autoplay:autoplay,autoplayTimeout:3000,autoplayHoverPause:!1,dots:!0})}else{arcadianslider.find('.owl-carousel').owlCarousel({lazyLoad:!1,loop:!0,center:!0,nav:!0,margin:20,mouseDrag:!1,touchDrag:!1,items:3,responsive:{1200:{items:5},992:{items:4},768:{items:3},600:{items:2},320:{items:2}},autoplay:autoplay,autoplayTimeout:3000,autoplayHoverPause:!1,dots:!0})}
arcadianslider.off('click').on('click','.owl-item',function(e){var current=$(this).index();var flag=currentIndex-current;if(current<currentIndex){arcadianslider.find('.owl-prev').click();if(flag==2){prevseconditem=!0}}else if(current>currentIndex){arcadianslider.find('.owl-next').click();if(flag==(-2)){nextseconditem=!0}}}).off('changed.owl.carousel').on('changed.owl.carousel',function(e){currentIndex=e.item.index;if(nextseconditem){arcadianslider.find('.owl-next').click();nextseconditem=!1}
if(prevseconditem){arcadianslider.find('.owl-prev').click();prevseconditem=!1}
arcadianslider.find(".owl-item a").attr("tabindex",-1)});arcadianslider.find(".owl-item a").attr("tabindex",-1);$(".image-slider-layout .owl-controls .owl-nav div").attr("tabindex","0").on("keyup",function(e){if(e.keyCode==13){$(this).click()}}).on("click",function(e){playPause.find(".fa-play").addClass("hide");playPause.find(".fa-pause").removeClass("hide")}).each(function(){if($(this).hasClass("owl-prev")){$(this).attr("title","Previous Item")}
if($(this).hasClass("owl-next")){$(this).attr("title","Next Item")}});$(".image-slider-layout .owl-controls .owl-dots .owl-dot span").attr("tabindex","0").on("keyup",function(e){if(e.keyCode==13){$(this).click()}}).on("click",function(e){playPause.find(".fa-play").addClass("hide");playPause.find(".fa-pause").removeClass("hide")}).each(function(index){$(this).attr("title","Select Item "+(index+1))});var playPause=$(".play-pause-indicator").clone();playPause.appendTo(".image-slider-layout .owl-controls");playPause.removeClass("hide");playPause.find('div').off().on("keyup click",function(e){e.stopImmediatePropagation();e.stopPropagation();if(e.type=="click"||e.keyCode==13){if($(this).hasClass("fa-pause")){arcadianslider.find('.owl-carousel').trigger("stop.owl.autoplay")}else{arcadianslider.find('.owl-carousel').trigger("play.owl.autoplay",[3000])}
var cms_element_type="";const navObj={};cms_element_type="Image Slider";navObj.event='cms_element_click';navObj.cms_element_type=cms_element_type;console.log(navObj);dataLayer.push(navObj);$(this).addClass("hide");$(this).siblings().removeClass("hide");$(this).siblings().focus();arcadianslider.find(".owl-item .link-active").attr("tabindex","-1")}});arcadianslider.on("focusin",function(e){if(!$(e.target).hasClass("fa-pause")&&!$(e.target).hasClass("fa-play")){arcadianslider.find('.owl-carousel').trigger("stop.owl.autoplay");arcadianslider.find(".owl-item.active.center .link-active").attr("tabindex",0)}});arcadianslider.find(".owl-item").on("focusout",function(e){arcadianslider.find(".owl-item .link-active").attr("tabindex","-1")}).on("keyup",function(e){if(e.keyCode==13){$(this).click()}});arcadianslider.find(".owl-carousel").on("stop.owl.autoplay",function(e){playPause.find(".fa-pause").addClass("hide");playPause.find(".fa-play").removeClass("hide")});arcadianslider.find(".owl-carousel").on("play.owl.autoplay",function(e){playPause.find(".fa-play").addClass("hide");playPause.find(".fa-pause").removeClass("hide")})}}
function InitBuildingImageViewerDetails(){var $buildgallery=$(".building_galley");if($buildgallery.length>0){if($.trim($('#buildprevimagelist').val()).length>0){var userLoggedIn=$.cookie('LoggedInFlag');if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){isDesktop=!1}
var screenWidth=$(window).width();if(screenWidth<=1024){isDesktop=!1}
if(screenWidth>=991){itemsperpage=4}else if(screenWidth>=767){itemsperpage=3}else{itemsperpage=2}
var $topPrev=$(".prev-images");content_thumbimgindex=0;previmagelist=$('#buildprevimagelist').val().split('~');var imageitems=[];var list=$('#buildthumbimagelist').val().split('~');for(i=0;i<list.length;i++){thumbimagelist.push(list[i]);imageitems.push(list[i])}
$('#startimage').html(1);$('#endimage').html(list.length);var itemIds=[];if($('#itemIds').val()){var items=$('#itemIds').val().split('~');for(i=0;i<items.length;i++){itemIds.push(items[i])}}
if($("#item-info-"+itemIds[0]).length==0){$(".item-info-div").addClass("hide")}
var imageIds=[];if($('#imageIds').val()){var images=$('#imageIds').val().split('~');for(i=0;i<images.length;i++){imageIds.push(images[i])}}
var imageParentIds=[];if($('#imageParentIds').val()){var images=$('#imageParentIds').val().split('~');for(i=0;i<images.length;i++){imageParentIds.push(images[i])}}
thumbitemsperpagelist=getThumbImages(imageitems);totalimagescount=thumbimagelist.length;totalpagescount=Math.ceil(totalimagescount/itemsperpage);totalthumbimagescount=itemsperpage*totalpagescount;var carouselimagehtml='';var thumbimagehtml='';for(i=0;i<previmagelist.length;i++){var $preview_image_item=$('#preview-image-item');$preview_image_item.find('.sub-image').attr('id','preview'+i);carouselimagehtml+=$preview_image_item.html()}
var currentItem='',prevItem='';for(i=0;i<totalthumbimagescount;i++){var $thumb_image_item=$('#thumb-image-item');$thumb_image_item.find('.item').attr('id','thumb'+i);if(imageIds.length>i){$thumb_image_item.find('.item').attr('img',"Image "+(i+1));$thumb_image_item.find('.item').attr('title',imageIds[i]);$thumb_image_item.find('.item').attr('alt',imageIds[i])}
if(itemIds.length>i){currentItem=itemIds[i];if(i==0){prevItem=itemIds[i]}
if(currentItem!=prevItem){$thumb_image_item.find('#thumb'+i).css('border-left',"double")}else{$thumb_image_item.find('#thumb'+i).css('border-left',"")}
prevItem=itemIds[i]}
if(i>=totalimagescount){$thumb_image_item.find('.item').html('')}
thumbimagehtml+=$thumb_image_item.html()}
var $btmThumb=$(".thumb-images"),flag=!1,duration=300;setpagenumber=0;$topPrev.html(carouselimagehtml);$btmThumb.html(thumbimagehtml);var currentset=thumbitemsperpagelist[0];for(i=0;i<currentset.length;i++){$('#thumb'+i).find('img').attr('src',currentset[i]);content_thumbimgindex=i}
$(".thumb-images>div:first").find("img").css("border","solid 3px #5E5B5C");$topPrev.on('initialized.owl.carousel',function(e){$('.photo_gallery .owl-next:first').addClass('icon-right_arrow');$('.photo_gallery .owl-prev:first').addClass('icon-Left_arrow')});previewOwl=$topPrev.owlCarousel({items:1,margin:10,nav:!0,mouseDrag:!1,touchDrag:!1,lazyLoad:!0});previewOwl.on('click','.owl-next',function(){if(!$('.prev-images .owl-next').hasClass('owl-next-inactive')){var currentindex=$('.prev-images div.active').index();var item=previmagelist[currentindex];var select_url=""
if(previmagelist[selectedindex].indexOf('id=')>-1){select_url=item.split('id=')[1];select_url=select_url.split('&')[0]}else{select_url=previmagelist[currentindex].split('/').slice('4').join('/')}
$('#selected-image-url').attr('data-index',currentindex).val(select_url);if(!$btmThumb.find('.owl-stage').children().eq(currentindex).hasClass('active')){var thumbpagenumber=Math.ceil(currentindex/itemsperpage);if(thumbpagenumber<totalpagescount){var currentset=thumbitemsperpagelist[thumbpagenumber];var startItem=(thumbpagenumber*itemsperpage);var endItem=((startItem-1)+itemsperpage);endItem=(endItem<totalimagescount)?(endItem+1):totalimagescount;thumb_startindex=startItem;thumb_endindex=endItem;var index=thumb_startindex;for(i=0;i<currentset.length;i++){var $thumb=$('#thumb'+index);var thumbimgurl=$.trim($thumb.find('img').attr('src'));if(thumbimgurl.length==0){$thumb.find('img').attr('src',currentset[i])}
index+=1}
$btmThumb.trigger('to.owl.carousel',thumbpagenumber);if(archiveimageslider){archiveimageslider.slider('setValue',thumbpagenumber+1)}
setpagenumber=thumbpagenumber}}
navigatePageGA()}}).on('click','.owl-prev',function(){if(!$('.prev-images .owl-prev').hasClass('owl-prev-inactive')){var currentindex=$('.prev-images div.active').index();var item=previmagelist[currentindex];var select_url="";var imageAuth=$("#imageAuthEnabled").val();if(imageAuth=="true"){select_url=item.split('id=')[1];select_url=select_url.split('&')[0]}else{select_url=item}
$('#selected-image-url').attr('data-index',currentindex).val(select_url);if(!$btmThumb.find('.owl-stage').children().eq(currentindex).hasClass('active')){var thumbpagenumber=Math.ceil(currentindex/itemsperpage);if(thumbpagenumber>0){setpagenumber=thumbpagenumber-1;var currentset=thumbitemsperpagelist[setpagenumber];var startItem=(setpagenumber*itemsperpage);var endItem=((startItem-1)+itemsperpage);endItem=(endItem<totalimagescount)?(endItem+1):totalimagescount;thumb_startindex=startItem;thumb_endindex=endItem;var index=thumb_startindex;for(i=0;i<currentset.length;i++){var $thumb=$('#thumb'+index);var thumbimgurl=$.trim($thumb.find('img').attr('src'));if(thumbimgurl.length==0){$thumb.find('img').attr('src',currentset[i])}
index+=1}
$btmThumb.trigger('to.owl.carousel',setpagenumber);if(archiveimageslider){archiveimageslider.slider('setValue',setpagenumber)}}}
navigatePageGA()}}).on('changed.owl.carousel',function(e){if(!flag){flag=!0;var url=window.location.href;var ct=Object.create(contenttype);$btmThumb.find("img").css("border","solid 3px transparent");$btmThumb.find('.owl-stage').children().removeClass('selected');$btmThumb.find('.owl-stage').children().eq(e.item.index).addClass('selected');$btmThumb.find('.owl-stage').children().eq(e.item.index).find('img').css("border","solid 3px #5E5B5C");var currentindex=e.item.index;if(url.indexOf('catalogue-item')>-1||url.indexOf('catalogue-viewer-file')>-1||url.indexOf('catalogue-bookmark-viewer')>-1){$('#selected-image-url').attr('data-index',currentindex).val(previmagelist[currentindex]);ct.createFrame();ct.createPdf();if(url.indexOf("#image")>-1){var currenturl=url.split('#image')[0]+'#image='+currentindex;ChangeUrl('path',currenturl)}else{url=url+='#image='+currentindex;ChangeUrl('path',url)}}
$(".item-info").addClass("hide");if(itemIds.length>currentindex)
$("#item-info-"+itemIds[currentindex]).removeClass("hide");if($("#item-info-"+itemIds[currentindex]).length==0){$(".item-info-div").addClass("hide")}else{$(".item-info-div").removeClass("hide")}
$(".current-item").css("font-weight","");if(imageParentIds.length>currentindex)
$("#current-item-"+imageParentIds[currentindex]).css("font-weight","bold");var previewcontent=$.trim($('#preview'+currentindex).html());if(previewcontent.length==0){showProgress();var id='preview'+currentindex;loadContentImageViewer(id,previmagelist[currentindex],!1)}else{hideProgress()}
flag=!1}
setTimeout(function(){if($('.prev-images .owl-item').last().hasClass('active')){$('.prev-images .owl-next').addClass('owl-next-inactive');isrtl?$('#image-fullview-modal .owl-prev').addClass('owl-prev-inactive'):$('#image-fullview-modal .owl-next').addClass('owl-next-inactive')}else{$('.prev-images .owl-next').removeClass('owl-next-inactive');isrtl?$('#image-fullview-modal .owl-prev').removeClass('owl-prev-inactive'):$('#image-fullview-modal .owl-next').removeClass('owl-next-inactive')}
if($('.prev-images .owl-item').first().hasClass('active')){$('.prev-images .owl-prev').addClass('owl-prev-inactive');isrtl?$('#image-fullview-modal .owl-next').addClass('owl-next-inactive'):$('#image-fullview-modal .owl-prev').addClass('owl-prev-inactive')}else{$('.prev-images .owl-prev').removeClass('owl-prev-inactive');isrtl?$('#image-fullview-modal .owl-next').removeClass('owl-next-inactive'):$('#image-fullview-modal .owl-prev').removeClass('owl-prev-inactive')}},500)});$(".image-copy-right[content='building']").addClass('hide');$(".image-copy-right[content='building']").eq(0).removeClass('hide');$(".image-caption[content='building']").addClass('hide');$(".image-caption[content='building']").eq(0).removeClass('hide');var duration=300;$(".thumb-images").on('initialized.owl.carousel',function(e){$('.thumb-images .owl-next:first').addClass('icon-right_arrow');$('.thumb-images .owl-prev:first').addClass('icon-Left_arrow')});var thumbOwl=$(".thumb-images").owlCarousel({margin:5,nav:!0,mouseDrag:!1,touchDrag:!1,scrollPerPage:!0,lazyLoad:!0,pagination:!0,paginationNumbers:!0,responsive:{992:{items:4},768:{items:3},320:{items:2}}});thumbOwl.on('click','.owl-item',function(){var currentindex=$(this).index();$(".prev-images").trigger('to.owl.carousel',[currentindex,duration,!0]);var item=previmagelist[currentindex];var select_url="";if(previmagelist[currentindex].indexOf('id=')>-1){select_url=item.split('id=')[1];select_url=select_url.split('&')[0]}else{select_url=previmagelist[currentindex].split('/').slice('4').join('/')}
$('#selected-image-url').attr('data-index',currentindex).val(select_url)}).on('click','.owl-next',function(){if(!$('.thumb-images .owl-next').hasClass('owl-next-inactive')){if(setpagenumber<totalpagescount){setpagenumber+=1;var currentset=thumbitemsperpagelist[setpagenumber];var startItem=(setpagenumber*itemsperpage);var endItem=((startItem-1)+itemsperpage);endItem=(endItem<totalimagescount)?(endItem+1):totalimagescount;thumb_startindex=startItem;thumb_endindex=endItem;var index=thumb_startindex;for(i=0;i<currentset.length;i++){var $thumb=$('#thumb'+index);var thumbimgurl=$.trim($thumb.find('img').attr('src'));if(thumbimgurl.length==0){$thumb.find('img').attr('src',currentset[i])}
index+=1}
$(".thumb-images").trigger('to.owl.carousel',setpagenumber);if(archiveimageslider){archiveimageslider.slider('setValue',setpagenumber+1)}}}}).on('click','.owl-prev',function(){if(!$('.thumb-images .owl-prev').hasClass('owl-next-inactive')){if(setpagenumber>0){setpagenumber-=1;var currentset=thumbitemsperpagelist[setpagenumber];var startItem=(setpagenumber*itemsperpage);var endItem=((startItem-1)+itemsperpage);endItem=(endItem<totalimagescount)?(endItem+1):totalimagescount;thumb_startindex=startItem;thumb_endindex=endItem;var index=thumb_startindex;var currentset=thumbitemsperpagelist[setpagenumber];for(i=0;i<currentset.length;i++){var $thumb=$('#thumb'+index);var thumbimgurl=$.trim($thumb.find('img').attr('src'));if(thumbimgurl.length==0){$thumb.find('img').attr('src',currentset[i])}
index+=1}
$(".thumb-images").trigger('to.owl.carousel',setpagenumber);if(archiveimageslider){archiveimageslider.slider('setValue',setpagenumber)}}}}).on('changed.owl.carousel',function(e){setTimeout(function(){if($('.thumb-images .owl-item').last().hasClass('active')){$('.thumb-images .owl-next').addClass('owl-next-inactive')}else{$('.thumb-images .owl-next').removeClass('owl-next-inactive')}
if($('.thumb-images .owl-item').first().hasClass('active')){$('.thumb-images .owl-prev').addClass('owl-prev-inactive')}else{$('.thumb-images .owl-prev').removeClass('owl-prev-inactive')}},500)});$('.owl-prev').addClass('owl-prev-inactive');if($('.prev-images .owl-item').last().hasClass('active')){$('.owl-next').addClass('owl-next-inactive')}
if($('.prev-images .owl-item').length==1){$('.owl-prev').addClass('hide');$('.owl-next').addClass('hide')}else{$('.owl-prev').removeClass('hide');$('.owl-next').removeClass('hide')}
$btmThumb.find('.owl-stage').css('height','122px');if(totalimagescount<=itemsperpage){$('.thumb-images').find('.owl-nav').addClass('hide');if($(".slider-image").length>0){$('.slider-image').addClass('hide');$('#imageslider').parent().addClass('hide')}}else{if($(".slider-image").length>0){istwoview=!1;archiveimageslider=initArchiveImageSlider();$('#imageslider').removeClass('hide')}}
var selectedindex=0;if(window.location.href.indexOf('#image=')>-1){selectedindex=parseInt(window.location.href.split('#image=')[1])}
if(selectedindex>totalimagescount-1||selectedindex<0){selectedindex=0}
var select_url="";var imageAuth=$("#imageAuthEnabled").val();if(imageAuth=="true"){select_url=previmagelist[selectedindex].split('id=')[1];select_url=select_url.split('&')[0]}else{select_url=previmagelist[selectedindex]}
$('#selected-image-url').attr('data-index',selectedindex).val(select_url);var id='preview'+selectedindex;loadContentImageViewer(id,previmagelist[selectedindex],!1);$topPrev.trigger('to.owl.carousel',[selectedindex,300,!0]);if($(".slider-image").length>0){if(selectedindex==0){thumbSlideToSelectedIndex(selectedindex+1)}else{thumbSlideToSelectedIndex(Math.floor(selectedindex/4)+1)}}
if(isrtl){if($('.prev-images .owl-item').last().hasClass('active')){$('#image-fullview-modal .owl-prev').addClass('owl-prev-inactive')}else{$('#image-fullview-modal .owl-prev').removeClass('owl-prev-inactive')}
if($('.prev-images .owl-item').first().hasClass('active')){$('#image-fullview-modal .owl-next').addClass('owl-next-inactive')}else{$('#image-fullview-modal .owl-next').removeClass('owl-next-inactive')}}}
var url=window.location.href;if(url.indexOf('catalogue-item')>-1||url.indexOf('catalogue-viewer-file')>-1||url.indexOf('catalogue-bookmark-viewer')>-1){$(window).off("hashchange.owl.navigation");window.addEventListener("hashchange",function(e){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation();var currentUrlIndex=window.location.hash.split("=")[1];if(currentUrlIndex>totalimagescount-1||currentUrlIndex<0){currentUrlIndex=0}
$(".prev-images").trigger('to.owl.carousel',[currentUrlIndex,300,!0]);var currenturl=url.split('#image')[0]+'#image='+currentUrlIndex;ChangeUrl('path',currenturl);if(currentUrlIndex==0){thumbSlideToSelectedIndex(currentUrlIndex+1)}else{thumbSlideToSelectedIndex(Math.floor(currentUrlIndex/4)+1)}},!1,)}}}
function loadContentImageViewer(id,imageurl,isfullview){var viewer='';var tileSources={};if(~imageurl.indexOf("*dheight")&&~imageurl.indexOf("*dwidth")){var image_actual_height=imageurl.split("*dheight")[1].split("**")[0];var image_actual_width=imageurl.split("*dwidth")[1].split("*/")[0];var image_width=parseInt(image_actual_width),image_height=parseInt(image_actual_height),max_image_size=Math.max(image_width,image_height);var tile_width=Math.ceil(256*image_width/max_image_size),tile_height=Math.ceil(256*image_height/max_image_size);var maxZoomLevel=Math.ceil(Math.log(max_image_size)/Math.log(256));var imagePrefix=imageurl.split("*dheight")[0];var publicId=imageurl.split("*/")[1];var getTileUrl=function(level,x,y){var Z=level-8,X=x,Y=y;var subdivisions=Math.pow(2,Z);if(X<0||X>=subdivisions||Y<0||Y>=subdivisions){return""}
var w=image_width/subdivisions,h=image_height/subdivisions,x=X*w,y=Y*h;return imagePrefix+'c_crop,x_'+Math.ceil(x)+',y_'+Math.ceil(y)+',w_'+Math.ceil(w)+',h_'+Math.ceil(h)+"/w_"+tile_width+",h_"+tile_height+"/f_jpg"+"/"+publicId};tileSources={defaultZoomLevel:0,maxZoomLevel:maxZoomLevel,width:Math.pow(2,(Math.ceil(Math.log(image_width/tile_width)/Math.log(2))))*tile_width,height:Math.pow(2,(Math.ceil(Math.log(image_height/tile_height)/Math.log(2))))*tile_height,tileWidth:tile_width,tileHeight:tile_height,minLevel:0,getTileUrl:getTileUrl}}else{tileSources={type:'image',url:imageurl,}}
if(~imageurl.indexOf(".svg")){tileSources.width=550}
var viewerInitObject={};if(isDesktop){viewerInitObject={id:id,mouseNavEnabled:!0,prefixUrl:"/bloomsbury_assets/bloomsbury/images/slider/",tileSources:tileSources,autoHideControls:!1,showNavigationControl:!0,showNavigator:!0,showHomeControl:!0,navigatorSizeRatio:0.133,navigatorMaintainSizeRatio:!0,navigatorPosition:'BOTTOM_LEFT',showRotationControl:!0};if(~imageurl.indexOf(".svg")){viewerInitObject.maxZoomPixelRatio=Infinity;viewerInitObject.minZoomImageRatio=1}
viewer=OpenSeadragon(viewerInitObject);viewer.addHandler("tile-loaded",function(data){hideProgress()});viewer.addHandler("open-failed",function(data){hideProgress()})}else{if(isfullview){viewerInitObject={id:id,mouseNavEnabled:!0,useCanvas:navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!1:!0,prefixUrl:"/bloomsbury_assets/bloomsbury/images/slider/",tileSources:tileSources,toolbar:"image-controls-fullscreen-toolbar",zoomInButton:"zoom-in-fullscreen",zoomOutButton:"zoom-out-fullscreen",homeButton:"home-fullscreen",fullPageButton:"full-page-fullscreen",rotateLeftButton:"rotate-left-fullscreen",rotateRightButton:"rotate-right-fullscreen",autoHideControls:!1,showNavigationControl:!0,showNavigator:navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?false:!0,showHomeControl:!0,navigatorSizeRatio:0.133,navigatorMaintainSizeRatio:!0,navigatorPosition:'BOTTOM_LEFT',showRotationControl:!0};if(~imageurl.indexOf(".svg")){viewerInitObject.maxZoomPixelRatio=Infinity;viewerInitObject.minZoomImageRatio=1}
viewer=OpenSeadragon(viewerInitObject);viewer.addHandler("tile-loaded",function(data){hideProgress();$('#image-controls-fullscreen-toolbar').children().each(function(){if(!$(this).hasClass('control-icon')){$(this).addClass('hide')}})});viewer.addHandler("open-failed",function(data){hideProgress()})}else{viewerInitObject={id:id,mouseNavEnabled:!0,useCanvas:navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!1:!0,prefixUrl:"/bloomsbury_assets/bloomsbury/images/slider/",tileSources:tileSources,toolbar:"image-controls-toolbar",zoomInButton:"zoom-in",zoomOutButton:"zoom-out",homeButton:"home",fullPageButton:"full-page",rotateLeftButton:"rotate-left",rotateRightButton:"rotate-right",autoHideControls:!1,showNavigationControl:!0,showNavigator:navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?false:!0,showHomeControl:!0,navigatorSizeRatio:0.133,navigatorMaintainSizeRatio:!0,navigatorPosition:'BOTTOM_LEFT',showRotationControl:!0};if(~imageurl.indexOf(".svg")){viewerInitObject.maxZoomPixelRatio=Infinity;viewerInitObject.minZoomImageRatio=1}
viewer=OpenSeadragon(viewerInitObject);viewer.addHandler("tile-loaded",function(data){hideProgress();$('#image-controls-toolbar').children().each(function(){if(!$(this).hasClass('control-icon')){$(this).addClass('hide')}})});viewer.addHandler("open-failed",function(data){hideProgress()})}}
if(~imageurl.indexOf(".svg")){var svg_overlay=viewer.svgOverlay();var snap=Snap(svg_overlay.node());Snap.load(imageurl,function(f){var g=f.select("*");if(f.select("svg").node.getAttribute("viewBox")){snap.node.parentElement.setAttribute("viewBox",f.select("svg").node.getAttribute("viewBox"))}
snap.append(g)});$(viewer.canvas).find('canvas').remove()}
viewer.addHandler("tile-unloaded",function(data){hideProgress()});viewer.addHandler("tile-load-failed",function(data){hideProgress()});if(isDesktop){$('#image-controls-toolbar').addClass('hide');var $previewfirst=$('#'+id);$previewfirst.find('.openseadragon-container').find("div:eq( 2 )").addClass('image-viewer-controls').removeAttr('style');$previewfirst.find('.image-viewer-controls').find('div').removeAttr('style');var totalcontrols=$previewfirst.find('.image-viewer-controls').find('div').children().children('div').length;var controlclasses=['icon-Zoom-In','icon-Zoom-Out','icon-Home','icon-fullscreen','icon-rotate_Anti-clockwise','icon-rotate_clockwise'];for(i=0;i<totalcontrols;i++){var controls='<span class="'+controlclasses[i]+'"/>';if(i==3){$previewfirst.find('.image-viewer-controls').find('div').children().children('div:eq('+i+')').addClass('control-icon hide').attr("tabindex","0").html(controls)}else{$previewfirst.find('.image-viewer-controls').find('div').children().children('div:eq('+i+')').addClass('control-icon').attr("tabindex","0").html(controls)}}
var fullviewcontrol='';if(isfullview){fullviewcontrol='<div tabindex="0" title="Toggle full screen" class="control-icon control-small-screen"><span class="icon-Normal_screen" /></div>';$previewfirst.find('.image-viewer-controls').find('div').children('div:eq(0)').append(fullviewcontrol)}else{fullviewcontrol='<div tabindex="0" title="Toggle full screen" class="control-icon control-full-screen"><span class="icon-fullscreen" /></div>';$previewfirst.find('.image-viewer-controls').find('div').children('div:eq(0)').append(fullviewcontrol)}}else{$('#image-controls-toolbar').removeClass('hide');if(isfullview){$('#image-controls-fullscreen-toolbar').removeClass('hide')}
if(navigator.userAgent.match(/(iPad|iPhone|iPod)/g)){$('#rotate-left').addClass('hide');$('#rotate-right').addClass('hide');$('#rotate-left-fullscreen').addClass('hide');$('#rotate-right-fullscreen').addClass('hide')}}
$(document).find('.openseadragon-container').find('canvas').addClass('disable-right')}
function bindInputEvents(){}
window.addEventListener('orientationchange',function(e){$('#image_modal').modal('hide')});$.cloudinary.responsive();$.fn.andSelf=function(){return this.addBack.apply(this,arguments)}
window.addEventListener("message",function(event){if(event.data){if(event.data.event&&event.data.event=="pdf_viewer"){dataLayer.push(event.data)}}},!1)